"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[5646],{28453(e,n,i){i.d(n,{R:()=>a,x:()=>o});var r=i(96540);const t={},c=r.createContext(t);function a(e){const n=r.useContext(c);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(c.Provider,{value:n},e.children)}},30430(e,n,i){i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>u,frontMatter:()=>o,metadata:()=>r,toc:()=>s});const r=JSON.parse('{"id":"laravel-reaction/deep-diving/exceptions/invalid-reaction-source-exception","title":"InvalidReactionSourceException","description":"The InvalidReactionSourceException is thrown when attempting to create a reaction without a valid reactor or device identifier.","source":"@site/packages/laravel-reaction/deep-diving/exceptions/invalid-reaction-source-exception.md","sourceDirName":"laravel-reaction/deep-diving/exceptions","slug":"/laravel-reaction/deep-diving/exceptions/invalid-reaction-source-exception","permalink":"/packages/laravel-reaction/deep-diving/exceptions/invalid-reaction-source-exception","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-reaction/deep-diving/exceptions/invalid-reaction-source-exception.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"sidebar_label":"InvalidReactionSourceException"},"sidebar":"packagesSidebar","previous":{"title":"Events","permalink":"/packages/laravel-reaction/deep-diving/events"},"next":{"title":"Laravel Star","permalink":"/packages/laravel-star/"}}');var t=i(74848),c=i(28453),a=i(28774);const o={sidebar_position:1,sidebar_label:"InvalidReactionSourceException"},d="InvalidReactionSourceException",l={},s=[{value:"Namespace",id:"namespace",level:2},{value:"Overview",id:"overview",level:2},{value:"When It&#39;s Thrown",id:"when-its-thrown",level:2},{value:"Exception Details",id:"exception-details",level:2},{value:"Message",id:"message",level:3},{value:"HTTP Status Code",id:"http-status-code",level:3},{value:"How to Avoid",id:"how-to-avoid",level:2},{value:"Provide a Reactor",id:"provide-a-reactor",level:3},{value:"Provide a Device ID",id:"provide-a-device-id",level:3},{value:"Invalid Usage",id:"invalid-usage",level:3},{value:"Handling the Exception",id:"handling-the-exception",level:2},{value:"Try-Catch Block",id:"try-catch-block",level:3},{value:"In Controllers",id:"in-controllers",level:3},{value:"Global Exception Handler",id:"global-exception-handler",level:3},{value:"Complete Examples",id:"complete-examples",level:2},{value:"Safe Reaction Addition",id:"safe-reaction-addition",level:3},{value:"Middleware for Device ID",id:"middleware-for-device-id",level:3},{value:"When to Use",id:"when-to-use",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function h(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"invalidreactionsourceexception",children:"InvalidReactionSourceException"})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"InvalidReactionSourceException"})," is thrown when attempting to create a reaction without a valid reactor or device identifier."]}),"\n",(0,t.jsx)(n.h2,{id:"namespace",children:"Namespace"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"JobMetric\\Reaction\\Exceptions\\InvalidReactionSourceException\n"})}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"This exception is thrown during reaction creation when neither a reactor (user) nor a device_id is provided. Reactions must have at least one identifier to track who or what made the reaction."}),"\n",(0,t.jsx)(n.h2,{id:"when-its-thrown",children:"When It's Thrown"}),"\n",(0,t.jsxs)(n.p,{children:["The exception is thrown in the ",(0,t.jsx)(n.code,{children:"Reaction"})," model's ",(0,t.jsx)(n.code,{children:"creating"})," event when:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["No reactor (user) is provided (",(0,t.jsx)(n.code,{children:"reactor_type"})," and ",(0,t.jsx)(n.code,{children:"reactor_id"})," are both null/empty)"]}),"\n",(0,t.jsxs)(n.li,{children:["No device identifier is provided (",(0,t.jsx)(n.code,{children:"device_id"})," is null/empty)"]}),"\n",(0,t.jsx)(n.li,{children:"Both conditions are true (no way to identify the source of the reaction)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"exception-details",children:"Exception Details"}),"\n",(0,t.jsx)(n.h3,{id:"message",children:"Message"}),"\n",(0,t.jsx)(n.p,{children:"The exception message is retrieved from the translation file:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"trans('reaction::base.exceptions.invalid_reaction_source')\n"})}),"\n",(0,t.jsx)(n.h3,{id:"http-status-code",children:"HTTP Status Code"}),"\n",(0,t.jsxs)(n.p,{children:["Default HTTP status code: ",(0,t.jsx)(n.code,{children:"400"})," (Bad Request)"]}),"\n",(0,t.jsx)(n.h2,{id:"how-to-avoid",children:"How to Avoid"}),"\n",(0,t.jsx)(n.h3,{id:"provide-a-reactor",children:"Provide a Reactor"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$article->addReaction('like', $user); // \u2705 Valid - user provided\n"})}),"\n",(0,t.jsx)(n.h3,{id:"provide-a-device-id",children:"Provide a Device ID"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$article->addReaction('like', null, ['device_id' => 'device-123']); // \u2705 Valid - device_id provided\n"})}),"\n",(0,t.jsx)(n.h3,{id:"invalid-usage",children:"Invalid Usage"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"// \u274c This will throw InvalidReactionSourceException\n$article->addReaction('like'); // No reactor, no device_id\n$article->addReaction('like', null); // No reactor, no device_id\n$article->addReaction('like', null, []); // No reactor, no device_id\n"})}),"\n",(0,t.jsx)(n.h2,{id:"handling-the-exception",children:"Handling the Exception"}),"\n",(0,t.jsx)(n.h3,{id:"try-catch-block",children:"Try-Catch Block"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"use JobMetric\\Reaction\\Exceptions\\InvalidReactionSourceException;\n\ntry {\n    $article->addReaction('like');\n} catch (InvalidReactionSourceException $e) {\n    // Handle the exception\n    return response()->json([\n        'error' => 'A reactor or device identifier is required',\n    ], 400);\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"in-controllers",children:"In Controllers"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"use JobMetric\\Reaction\\Exceptions\\InvalidReactionSourceException;\n\npublic function like(Article $article)\n{\n    try {\n        $user = auth()->user();\n        $deviceId = request()->header('X-Device-ID');\n        \n        if ($user) {\n            $article->addReaction('like', $user);\n        } elseif ($deviceId) {\n            $article->addReaction('like', null, ['device_id' => $deviceId]);\n        } else {\n            throw new InvalidReactionSourceException();\n        }\n        \n        return response()->json(['success' => true]);\n    } catch (InvalidReactionSourceException $e) {\n        return response()->json([\n            'error' => $e->getMessage(),\n        ], 400);\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"global-exception-handler",children:"Global Exception Handler"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"use JobMetric\\Reaction\\Exceptions\\InvalidReactionSourceException;\n\npublic function register(): void\n{\n    $this->renderable(function (InvalidReactionSourceException $e, $request) {\n        if ($request->expectsJson()) {\n            return response()->json([\n                'error' => 'A reactor or device identifier is required to add a reaction',\n            ], 400);\n        }\n        \n        return redirect()->back()->with('error', $e->getMessage());\n    });\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"complete-examples",children:"Complete Examples"}),"\n",(0,t.jsx)(n.h3,{id:"safe-reaction-addition",children:"Safe Reaction Addition"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"public function react(Article $article, string $reaction)\n{\n    $user = auth()->user();\n    $deviceId = request()->header('X-Device-ID');\n    \n    try {\n        if ($user) {\n            $article->addReaction($reaction, $user);\n        } elseif ($deviceId) {\n            $article->addReaction($reaction, null, ['device_id' => $deviceId]);\n        } else {\n            throw new InvalidReactionSourceException();\n        }\n        \n        return response()->json(['success' => true]);\n    } catch (InvalidReactionSourceException $e) {\n        return response()->json([\n            'error' => 'Please log in or provide a device identifier',\n        ], 400);\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"middleware-for-device-id",children:"Middleware for Device ID"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"class EnsureDeviceId\n{\n    public function handle($request, Closure $next)\n    {\n        if (!auth()->check() && !$request->header('X-Device-ID')) {\n            return response()->json([\n                'error' => 'Device identifier required for anonymous reactions',\n            ], 400);\n        }\n        \n        return $next($request);\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"when-to-use",children:"When to Use"}),"\n",(0,t.jsx)(n.p,{children:"This exception helps ensure data integrity by requiring that every reaction has a source identifier. Use it to:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Validate Input"}),": Ensure reactions always have a source"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Data Integrity"}),": Prevent orphaned reactions without identifiers"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Security"}),": Ensure proper tracking of reaction sources"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Analytics"}),": Ensure all reactions can be tracked and analyzed"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(a.A,{to:"/packages/laravel-reaction/deep-diving/has-reaction",children:"HasReaction"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(a.A,{to:"/packages/laravel-reaction/deep-diving/models/reaction",children:"Reaction Model"}),"\n"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}}}]);