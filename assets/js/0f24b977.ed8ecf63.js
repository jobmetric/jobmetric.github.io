"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[4054],{28024(e,t,n){n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>p,frontMatter:()=>l,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"laravel-metadata/deep-diving/exceptions/metadata-key-not-found-exception","title":"MetadataKeyNotFoundException","description":"The MetadataKeyNotFoundException exception is thrown when attempting to store metadata with keys that are not in the model\'s allowed metadata list.","source":"@site/packages/laravel-metadata/deep-diving/exceptions/metadata-key-not-found-exception.md","sourceDirName":"laravel-metadata/deep-diving/exceptions","slug":"/laravel-metadata/deep-diving/exceptions/metadata-key-not-found-exception","permalink":"/packages/laravel-metadata/deep-diving/exceptions/metadata-key-not-found-exception","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-metadata/deep-diving/exceptions/metadata-key-not-found-exception.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"sidebar_label":"MetadataKeyNotFoundException"},"sidebar":"packagesSidebar","previous":{"title":"MetadataResource","permalink":"/packages/laravel-metadata/deep-diving/resources/metadata-resource"},"next":{"title":"ModelMetaableKeyNotAllowedFieldException","permalink":"/packages/laravel-metadata/deep-diving/exceptions/model-metaable-key-not-allowed-field-exception"}}');var i=n(74848),o=n(28453),d=n(28774);const l={sidebar_position:1,sidebar_label:"MetadataKeyNotFoundException"},r="MetadataKeyNotFoundException",s={},c=[{value:"Namespace",id:"namespace",level:2},{value:"Overview",id:"overview",level:2},{value:"Exception Details",id:"exception-details",level:2},{value:"Constructor",id:"constructor",level:3},{value:"When It&#39;s Thrown",id:"when-its-thrown",level:2},{value:"Storing via Model Attributes",id:"storing-via-model-attributes",level:3},{value:"Handling the Exception",id:"handling-the-exception",level:2},{value:"Check Keys Before Storing",id:"check-keys-before-storing",level:3},{value:"Validate Before Assignment",id:"validate-before-assignment",level:3},{value:"Related Documentation",id:"related-documentation",level:2}];function h(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"metadatakeynotfoundexception",children:"MetadataKeyNotFoundException"})}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"MetadataKeyNotFoundException"})," exception is thrown when attempting to store metadata with keys that are not in the model's allowed metadata list."]}),"\n",(0,i.jsx)(t.h2,{id:"namespace",children:"Namespace"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-php",children:"JobMetric\\Metadata\\Exceptions\\MetadataKeyNotFoundException\n"})}),"\n",(0,i.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(t.p,{children:"This exception is thrown when:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Storing metadata via model attributes with keys not in the ",(0,i.jsx)(t.code,{children:"$metadata"})," array"]}),"\n",(0,i.jsxs)(t.li,{children:["The model has a restricted ",(0,i.jsx)(t.code,{children:"$metadata"})," list (not ",(0,i.jsx)(t.code,{children:"['*']"}),")"]}),"\n",(0,i.jsx)(t.li,{children:"One or more keys in the metadata array are not allowed"}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"exception-details",children:"Exception Details"}),"\n",(0,i.jsx)(t.h3,{id:"constructor",children:"Constructor"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-php",children:"public function __construct(string|array $key, int $code = 400, ?Throwable $previous = null)\n"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"string|array $key"})," - The key(s) that were not found/allowed"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"int $code"})," - Exception code (default: ",(0,i.jsx)(t.code,{children:"400"}),")"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"Throwable|null $previous"})," - Previous exception for chaining"]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"when-its-thrown",children:"When It's Thrown"}),"\n",(0,i.jsx)(t.h3,{id:"storing-via-model-attributes",children:"Storing via Model Attributes"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-php",children:"class Product extends Model\n{\n    use HasMeta;\n\n    protected array $metadata = ['color', 'size'];\n}\n\n// This will throw MetadataKeyNotFoundException\n$product = Product::create([\n    'name' => 'Test',\n    'metadata' => [\n        'color' => 'red',    // OK\n        'weight' => 500,     // Not allowed!\n    ],\n]);\n"})}),"\n",(0,i.jsx)(t.h2,{id:"handling-the-exception",children:"Handling the Exception"}),"\n",(0,i.jsx)(t.h3,{id:"check-keys-before-storing",children:"Check Keys Before Storing"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-php",children:"try {\n    $product = Product::create([\n        'name' => 'Test',\n        'metadata' => $metadata,\n    ]);\n} catch (MetadataKeyNotFoundException $e) {\n    // Handle: Invalid metadata keys\n    return response()->json([\n        'error' => 'Invalid metadata keys',\n        'keys' => $e->getMessage(),\n    ], 400);\n}\n"})}),"\n",(0,i.jsx)(t.h3,{id:"validate-before-assignment",children:"Validate Before Assignment"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-php",children:"$allowedKeys = $product->getMetaKeys();\n$metadata = request()->input('metadata', []);\n\n$invalidKeys = array_diff(array_keys($metadata), $allowedKeys);\nif (!empty($invalidKeys) && !in_array('*', $allowedKeys)) {\n    throw new MetadataKeyNotFoundException($invalidKeys);\n}\n"})}),"\n",(0,i.jsx)(t.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(d.A,{to:"/packages/laravel-metadata/deep-diving/has-meta",children:"HasMeta Trait"}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(d.A,{to:"/packages/laravel-metadata/deep-diving/exceptions/model-metaable-key-not-allowed-field-exception",children:"ModelMetaableKeyNotAllowedFieldException"}),"\n"]}),"\n"]})]})}function p(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},28453(e,t,n){n.d(t,{R:()=>d,x:()=>l});var a=n(96540);const i={},o=a.createContext(i);function d(e){const t=a.useContext(o);return a.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),a.createElement(o.Provider,{value:t},e.children)}}}]);