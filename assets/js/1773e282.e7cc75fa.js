"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[490],{6942(e,n,i){i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"laravel-flow/deep-diving/requests/store-flow-transition-request","title":"StoreFlowTransitionRequest","description":"Form request class for validating FlowTransition creation data. This request handles complex validation including state relationships, transition types, and uniqueness constraints.","source":"@site/packages/laravel-flow/deep-diving/requests/store-flow-transition-request.md","sourceDirName":"laravel-flow/deep-diving/requests","slug":"/laravel-flow/deep-diving/requests/store-flow-transition-request","permalink":"/packages/laravel-flow/deep-diving/requests/store-flow-transition-request","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-flow/deep-diving/requests/store-flow-transition-request.md","tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"sidebar_position":10,"sidebar_label":"StoreFlowTransitionRequest"},"sidebar":"packagesSidebar","previous":{"title":"UpdateFlowTaskRequest","permalink":"/packages/laravel-flow/deep-diving/requests/update-flow-task-request"},"next":{"title":"UpdateFlowTransitionRequest","permalink":"/packages/laravel-flow/deep-diving/requests/update-flow-transition-request"}}');var t=i(4848),r=i(8453);const l={sidebar_position:10,sidebar_label:"StoreFlowTransitionRequest"},a="StoreFlowTransitionRequest",o={},d=[{value:"Namespace",id:"namespace",level:2},{value:"Overview",id:"overview",level:2},{value:"Validation Rules",id:"validation-rules",level:2},{value:"Required Fields",id:"required-fields",level:3},{value:"Optional Fields",id:"optional-fields",level:3},{value:"Transition Types",id:"transition-types",level:2},{value:"1. Specific Transition (from \u2192 to)",id:"1-specific-transition-from--to",level:3},{value:"2. Self-Loop Transition (from \u2192 from)",id:"2-self-loop-transition-from--from",level:3},{value:"3. Generic Input Transition (null \u2192 to)",id:"3-generic-input-transition-null--to",level:3},{value:"4. Generic Output Transition (from \u2192 null)",id:"4-generic-output-transition-from--null",level:3},{value:"Cross-Field Validation",id:"cross-field-validation",level:2},{value:"At Least One Required",id:"at-least-one-required",level:3},{value:"START State Rules",id:"start-state-rules",level:3},{value:"Terminal State Rules",id:"terminal-state-rules",level:3},{value:"Uniqueness Rules",id:"uniqueness-rules",level:3},{value:"Translation Validation",id:"translation-validation",level:2},{value:"Name Uniqueness",id:"name-uniqueness",level:3},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Specific Transition",id:"specific-transition",level:3},{value:"Generic Input Transition",id:"generic-input-transition",level:3},{value:"Generic Output Transition",id:"generic-output-transition",level:3},{value:"Self-Loop Transition",id:"self-loop-transition",level:3},{value:"With Slug",id:"with-slug",level:3},{value:"Context Management",id:"context-management",level:2},{value:"Static Rules Method",id:"static-rules-method",level:2},{value:"rulesFor()",id:"rulesfor",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Validation Errors",id:"validation-errors",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"storeflowtransitionrequest",children:"StoreFlowTransitionRequest"})}),"\n",(0,t.jsx)(n.p,{children:"Form request class for validating FlowTransition creation data. This request handles complex validation including state relationships, transition types, and uniqueness constraints."}),"\n",(0,t.jsx)(n.h2,{id:"namespace",children:"Namespace"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"JobMetric\\Flow\\Http\\Requests\\FlowTransition\\StoreFlowTransitionRequest"})}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"StoreFlowTransitionRequest"})," validates incoming data when creating a new FlowTransition entity. It ensures:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Required fields are present"}),"\n",(0,t.jsx)(n.li,{children:"Flow ID exists and is valid"}),"\n",(0,t.jsx)(n.li,{children:"Multi-language translations are valid"}),"\n",(0,t.jsx)(n.li,{children:"State relationships are valid (from/to states)"}),"\n",(0,t.jsx)(n.li,{children:"Transition uniqueness within flow"}),"\n",(0,t.jsx)(n.li,{children:"Business rules are enforced (START state rules, terminal state rules, etc.)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"validation-rules",children:"Validation Rules"}),"\n",(0,t.jsx)(n.h3,{id:"required-fields",children:"Required Fields"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Field"}),(0,t.jsx)(n.th,{children:"Rule"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"flow_id"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"required|integer|exists:flows,id"})}),(0,t.jsx)(n.td,{children:"ID of the parent flow"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"translation"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"required|array"})}),(0,t.jsx)(n.td,{children:"Multi-language translation data"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"translation.{locale}"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"required|array"})}),(0,t.jsx)(n.td,{children:"Translation data for each active locale"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"translation.{locale}.name"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"required|string"})}),(0,t.jsx)(n.td,{children:"Transition name in each locale (must be unique within flow)"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"optional-fields",children:"Optional Fields"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Field"}),(0,t.jsx)(n.th,{children:"Rule"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"from"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"nullable|integer|exists:flow_states,id"})}),(0,t.jsx)(n.td,{children:"Source state ID (nullable for generic input)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"to"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"nullable|integer|exists:flow_states,id"})}),(0,t.jsx)(n.td,{children:"Target state ID (nullable for generic output)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"slug"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"nullable|string|max:255|regex:/^[a-z0-9-]+$/|unique:flow_transitions,slug"})}),(0,t.jsx)(n.td,{children:"URL-friendly identifier"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"transition-types",children:"Transition Types"}),"\n",(0,t.jsx)(n.p,{children:"The request supports four transition types:"}),"\n",(0,t.jsx)(n.h3,{id:"1-specific-transition-from--to",children:"1. Specific Transition (from \u2192 to)"}),"\n",(0,t.jsxs)(n.p,{children:["Both ",(0,t.jsx)(n.code,{children:"from"})," and ",(0,t.jsx)(n.code,{children:"to"})," are specified:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"'from' => 1, // State ID\n'to' => 2,   // State ID\n"})}),"\n",(0,t.jsx)(n.h3,{id:"2-self-loop-transition-from--from",children:"2. Self-Loop Transition (from \u2192 from)"}),"\n",(0,t.jsxs)(n.p,{children:["Same state for both ",(0,t.jsx)(n.code,{children:"from"})," and ",(0,t.jsx)(n.code,{children:"to"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"'from' => 1,\n'to' => 1, // Same state\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Note:"})," Not allowed for START states."]}),"\n",(0,t.jsx)(n.h3,{id:"3-generic-input-transition-null--to",children:"3. Generic Input Transition (null \u2192 to)"}),"\n",(0,t.jsx)(n.p,{children:"No source state, can enter from any state:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"'from' => null,\n'to' => 2,\n"})}),"\n",(0,t.jsx)(n.h3,{id:"4-generic-output-transition-from--null",children:"4. Generic Output Transition (from \u2192 null)"}),"\n",(0,t.jsx)(n.p,{children:"No target state, can exit to any state:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"'from' => 1,\n'to' => null,\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Note:"})," Not allowed from terminal states."]}),"\n",(0,t.jsx)(n.h2,{id:"cross-field-validation",children:"Cross-Field Validation"}),"\n",(0,t.jsxs)(n.p,{children:["The request includes extensive custom validation in ",(0,t.jsx)(n.code,{children:"withValidator()"}),":"]}),"\n",(0,t.jsx)(n.h3,{id:"at-least-one-required",children:"At Least One Required"}),"\n",(0,t.jsxs)(n.p,{children:["At least one of ",(0,t.jsx)(n.code,{children:"from"})," or ",(0,t.jsx)(n.code,{children:"to"})," must be set:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"// \u2705 Valid\n'from' => 1, 'to' => 2,\n'from' => null, 'to' => 2,\n'from' => 1, 'to' => null,\n\n// \u274c Invalid\n'from' => null, 'to' => null,\n"})}),"\n",(0,t.jsx)(n.h3,{id:"start-state-rules",children:"START State Rules"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Cannot Self-Loop"}),": START state cannot have self-loop transitions"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"// \u274c Invalid if from is START state\n'from' => $startId,\n'to' => $startId,\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Cannot Point To"}),": No transition can point to START state"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"// \u274c Invalid\n'to' => $startId,\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Only One Exit"}),": Only one transition can exit from START state"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"// If START already has a transition, cannot create another\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"First Transition"}),": First transition in flow must start from START"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"// If this is the first transition, from must be START\n"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"terminal-state-rules",children:"Terminal State Rules"}),"\n",(0,t.jsx)(n.p,{children:"Terminal states cannot have generic output transitions:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"// \u274c Invalid if from is terminal state\n'from' => $terminalStateId,\n'to' => null,\n"})}),"\n",(0,t.jsx)(n.h3,{id:"uniqueness-rules",children:"Uniqueness Rules"}),"\n",(0,t.jsxs)(n.p,{children:["The combination ",(0,t.jsx)(n.code,{children:"(flow_id, from, to)"})," must be unique:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"// \u274c Invalid - Duplicate transition\n// If flow 1 already has: from=1, to=2\n// Cannot create another: from=1, to=2\n"})}),"\n",(0,t.jsx)(n.h2,{id:"translation-validation",children:"Translation Validation"}),"\n",(0,t.jsx)(n.h3,{id:"name-uniqueness",children:"Name Uniqueness"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"translation.{locale}.name"})," field is validated for uniqueness within the same flow:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Checks if a transition with the same name already exists in the same flow and locale"}),"\n",(0,t.jsx)(n.li,{children:"Prevents duplicate transition names within a flow"}),"\n",(0,t.jsx)(n.li,{children:"Trims whitespace before validation"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,t.jsx)(n.h3,{id:"specific-transition",children:"Specific Transition"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$requestData = [\n    'flow_id' => 1,\n    'translation' => [\n        'en' => ['name' => 'Approve Order'],\n    ],\n    'from' => 1, // Pending state\n    'to' => 2,   // Approved state\n];\n"})}),"\n",(0,t.jsx)(n.h3,{id:"generic-input-transition",children:"Generic Input Transition"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$requestData = [\n    'flow_id' => 1,\n    'translation' => [\n        'en' => ['name' => 'Enter Processing'],\n    ],\n    'from' => null, // Can enter from any state\n    'to' => 3,      // Processing state\n];\n"})}),"\n",(0,t.jsx)(n.h3,{id:"generic-output-transition",children:"Generic Output Transition"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$requestData = [\n    'flow_id' => 1,\n    'translation' => [\n        'en' => ['name' => 'Cancel Order'],\n    ],\n    'from' => 1,     // Pending state\n    'to' => null,    // Can exit to any state\n];\n"})}),"\n",(0,t.jsx)(n.h3,{id:"self-loop-transition",children:"Self-Loop Transition"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$requestData = [\n    'flow_id' => 1,\n    'translation' => [\n        'en' => ['name' => 'Refresh Status'],\n    ],\n    'from' => 2, // Processing state\n    'to' => 2,   // Same state (self-loop)\n];\n"})}),"\n",(0,t.jsx)(n.h3,{id:"with-slug",children:"With Slug"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$requestData = [\n    'flow_id' => 1,\n    'translation' => [\n        'en' => ['name' => 'Approve Order'],\n    ],\n    'from' => 1,\n    'to' => 2,\n    'slug' => 'approve-order', // URL-friendly identifier\n];\n"})}),"\n",(0,t.jsx)(n.h2,{id:"context-management",children:"Context Management"}),"\n",(0,t.jsx)(n.p,{children:"The request supports external context injection:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$request = new StoreFlowTransitionRequest();\n$request->setContext(['flow_id' => 123]);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"static-rules-method",children:"Static Rules Method"}),"\n",(0,t.jsx)(n.h3,{id:"rulesfor",children:"rulesFor()"}),"\n",(0,t.jsx)(n.p,{children:"Provides programmatic validation:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$input = [\n    'flow_id' => 1,\n    'translation' => [\n        'en' => ['name' => 'Transition'],\n    ],\n    'from' => 1,\n    'to' => 2,\n];\n\n$context = ['flow_id' => 1];\n\n$rules = StoreFlowTransitionRequest::rulesFor($input, $context);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,t.jsx)(n.h3,{id:"validation-errors",children:"Validation Errors"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n    "message": "The given data was invalid.",\n    "errors": {\n        "flow_id": [\n            "The selected flow id is invalid."\n        ],\n        "from": [\n            "The first transition must start from START state."\n        ],\n        "to": [\n            "Terminal states cannot have generic output transitions."\n        ]\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Understand Transition Types"}),": Choose the right type for your use case"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"// Specific: Most common, explicit state changes\n'from' => 1, 'to' => 2,\n\n// Generic Input: Flexible entry point\n'from' => null, 'to' => 2,\n\n// Generic Output: Flexible exit point\n'from' => 1, 'to' => null,\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Follow START State Rules"}),": Always start from START state for first transition"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"// \u2705 Good - First transition\n'from' => $startStateId, 'to' => 2,\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Use Meaningful Slugs"}),": Create URL-friendly slugs for API access"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"// \u2705 Good\n'slug' => 'approve-order'\n\n// \u274c Bad\n'slug' => 'transition_1'\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Respect Terminal States"}),": Don't create generic outputs from terminal states"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"// \u274c Invalid\n'from' => $terminalStateId, 'to' => null,\n"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/packages/laravel-flow/deep-diving/services/flow-transition",children:"FlowTransition Service"})," - Transition management"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/packages/laravel-flow/deep-diving/requests/update-flow-transition-request",children:"UpdateFlowTransitionRequest"})," - Transition update validation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/packages/laravel-flow/deep-diving/resources/flow-transition-resource",children:"FlowTransitionResource"})," - Transition JSON resource"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/packages/laravel-flow/deep-diving/services/flow-state",children:"FlowState Service"})," - State management"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/packages/laravel-flow/deep-diving/events",children:"Events"})," - Transition lifecycle events"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453(e,n,i){i.d(n,{R:()=>l,x:()=>a});var s=i(6540);const t={},r=s.createContext(t);function l(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);