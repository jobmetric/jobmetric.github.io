"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[5981],{12651(n,e,t){t.r(e),t.d(e,{assets:()=>d,contentTitle:()=>o,default:()=>v,frontMatter:()=>r,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"laravel-translation/deep-diving/events","title":"Events","description":"Laravel Translation provides a comprehensive event system that fires domain events for all translation operations. These events allow you to hook into the translation lifecycle and perform additional actions when translations are stored or forgotten.","source":"@site/packages/laravel-translation/deep-diving/events.md","sourceDirName":"laravel-translation/deep-diving","slug":"/laravel-translation/deep-diving/events","permalink":"/packages/laravel-translation/deep-diving/events","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-translation/deep-diving/events.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"sidebar_label":"Events"},"sidebar":"packagesSidebar","previous":{"title":"HasServiceTranslation","permalink":"/packages/laravel-translation/deep-diving/has-service-translation"},"next":{"title":"TranslationArrayRequest","permalink":"/packages/laravel-translation/deep-diving/requests/translation-array-request"}}');var s=t(74848),i=t(28453),l=t(28774);const r={sidebar_position:5,sidebar_label:"Events"},o="Events",d={},c=[{value:"Overview",id:"overview",level:2},{value:"Event Structure",id:"event-structure",level:2},{value:"Base Event Structure",id:"base-event-structure",level:3},{value:"Available Events",id:"available-events",level:2},{value:"Translation Events",id:"translation-events",level:3},{value:"Listening to Events",id:"listening-to-events",level:2},{value:"Method 1: Event Listeners in Service Provider",id:"method-1-event-listeners-in-service-provider",level:3},{value:"Method 2: Using Event Facade",id:"method-2-using-event-facade",level:3},{value:"Method 3: Using Event Subscribers",id:"method-3-using-event-subscribers",level:3},{value:"Complete Examples",id:"complete-examples",level:2},{value:"Example 1: Cache Invalidation on Translation Changes",id:"example-1-cache-invalidation-on-translation-changes",level:3},{value:"Example 2: Audit Logging",id:"example-2-audit-logging",level:3},{value:"Example 3: Search Index Updates",id:"example-3-search-index-updates",level:3},{value:"Example 4: Notification System",id:"example-4-notification-system",level:3},{value:"Example 5: Analytics Tracking",id:"example-5-analytics-tracking",level:3},{value:"Example 6: Translation Synchronization",id:"example-6-translation-synchronization",level:3},{value:"Example 7: Real-time Updates",id:"example-7-real-time-updates",level:3},{value:"Example 8: Complete Event Listener Setup",id:"example-8-complete-event-listener-setup",level:3},{value:"Event Timing",id:"event-timing",level:2},{value:"TranslationStoredEvent",id:"translationstoredevent",level:3},{value:"TranslationForgetEvent",id:"translationforgetevent",level:3},{value:"Queued Events",id:"queued-events",level:2},{value:"Event Payload Details",id:"event-payload-details",level:2},{value:"TranslationStoredEvent",id:"translationstoredevent-1",level:3},{value:"TranslationForgetEvent",id:"translationforgetevent-1",level:3},{value:"When to Use Events",id:"when-to-use-events",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function h(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"events",children:"Events"})}),"\n",(0,s.jsx)(e.p,{children:"Laravel Translation provides a comprehensive event system that fires domain events for all translation operations. These events allow you to hook into the translation lifecycle and perform additional actions when translations are stored or forgotten."}),"\n",(0,s.jsx)(e.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(e.p,{children:"The event system in Laravel Translation:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Fires automatically"})," during translation operations"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Provides model and translation data"})," in event payloads"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Uses DomainEvent interface"})," for consistency"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Supports event listeners"})," for custom logic"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Enables event-driven architecture"})," for translation management"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"event-structure",children:"Event Structure"}),"\n",(0,s.jsx)(e.p,{children:"All events in Laravel Translation:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["Implement ",(0,s.jsx)(e.code,{children:"JobMetric\\EventSystem\\Contracts\\DomainEvent"})]}),"\n",(0,s.jsxs)(e.li,{children:["Are ",(0,s.jsx)(e.code,{children:"readonly"})," classes for immutability"]}),"\n",(0,s.jsx)(e.li,{children:"Contain model and translation information"}),"\n",(0,s.jsxs)(e.li,{children:["Provide a stable ",(0,s.jsx)(e.code,{children:"key()"})," method"]}),"\n",(0,s.jsxs)(e.li,{children:["Include metadata via ",(0,s.jsx)(e.code,{children:"definition()"})," method"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"base-event-structure",children:"Base Event Structure"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"readonly class TranslationStoredEvent implements DomainEvent\n{\n    public function __construct(\n        public Model $model,\n        public string $locale,\n        public array $data\n    ) {}\n\n    public static function key(): string\n    {\n        return 'translation.stored';\n    }\n\n    public static function definition(): DomainEventDefinition\n    {\n        return new DomainEventDefinition(\n            self::key(),\n            'translation::base.entity_names.translation',\n            'translation::base.events.translation_stored.title',\n            'translation::base.events.translation_stored.description',\n            'fas fa-save',\n            ['translation', 'storage', 'localization']\n        );\n    }\n}\n"})}),"\n",(0,s.jsx)(e.h2,{id:"available-events",children:"Available Events"}),"\n",(0,s.jsx)(e.h3,{id:"translation-events",children:"Translation Events"}),"\n",(0,s.jsx)(e.p,{children:"Events fired for translation operations."}),"\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"Event Class"}),(0,s.jsx)(e.th,{children:"Event Key"}),(0,s.jsx)(e.th,{children:"Description"}),(0,s.jsx)(e.th,{children:"Payload"}),(0,s.jsx)(e.th,{children:"Triggered When"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"TranslationStoredEvent"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"translation.stored"})}),(0,s.jsx)(e.td,{children:"Fired after storing or updating a translation"}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"Model $model, string $locale, array $data"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"HasTranslation::setTranslation()"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"TranslationForgetEvent"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"translation.forgotten"})}),(0,s.jsx)(e.td,{children:"Fired after forgetting a translation"}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"Translation $translation"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"HasTranslation::forgetTranslation()"})})]})]})]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Namespace:"})," ",(0,s.jsx)(e.code,{children:"JobMetric\\Translation\\Events\\*"})]}),"\n",(0,s.jsx)(e.h2,{id:"listening-to-events",children:"Listening to Events"}),"\n",(0,s.jsx)(e.h3,{id:"method-1-event-listeners-in-service-provider",children:"Method 1: Event Listeners in Service Provider"}),"\n",(0,s.jsx)(e.p,{children:"Register event listeners in a service provider:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"namespace App\\Providers;\n\nuse Illuminate\\Foundation\\Support\\Providers\\EventServiceProvider as ServiceProvider;\nuse JobMetric\\Translation\\Events\\TranslationStoredEvent;\nuse JobMetric\\Translation\\Events\\TranslationForgetEvent;\n\nclass EventServiceProvider extends ServiceProvider\n{\n    protected $listen = [\n        TranslationStoredEvent::class => [\n            \\App\\Listeners\\Translation\\LogTranslationStored::class,\n            \\App\\Listeners\\Translation\\InvalidateTranslationCache::class,\n            \\App\\Listeners\\Translation\\UpdateSearchIndex::class,\n            \\App\\Listeners\\Translation\\NotifyTranslationChange::class,\n        ],\n        TranslationForgetEvent::class => [\n            \\App\\Listeners\\Translation\\LogTranslationForgotten::class,\n            \\App\\Listeners\\Translation\\InvalidateTranslationCache::class,\n        ],\n    ];\n\n    public function boot(): void\n    {\n        parent::boot();\n    }\n}\n"})}),"\n",(0,s.jsx)(e.h3,{id:"method-2-using-event-facade",children:"Method 2: Using Event Facade"}),"\n",(0,s.jsx)(e.p,{children:"Listen to events using the Event facade:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"use Illuminate\\Support\\Facades\\Event;\nuse JobMetric\\Translation\\Events\\TranslationStoredEvent;\n\nEvent::listen(TranslationStoredEvent::class, function (TranslationStoredEvent $event) {\n    $model = $event->model;\n    $locale = $event->locale;\n    $data = $event->data;\n    \n    // Perform actions\n    Log::info('Translation stored', [\n        'model' => get_class($model),\n        'model_id' => $model->id,\n        'locale' => $locale,\n        'field' => $data['field'] ?? null,\n        'value' => $data['value'] ?? null,\n    ]);\n    \n    Cache::tags([get_class($model)])->flush();\n});\n"})}),"\n",(0,s.jsx)(e.h3,{id:"method-3-using-event-subscribers",children:"Method 3: Using Event Subscribers"}),"\n",(0,s.jsx)(e.p,{children:"Create event subscribers for multiple events:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"namespace App\\Listeners;\n\nuse Illuminate\\Events\\Dispatcher;\nuse JobMetric\\Translation\\Events\\TranslationStoredEvent;\nuse JobMetric\\Translation\\Events\\TranslationForgetEvent;\n\nclass TranslationEventSubscriber\n{\n    public function handleTranslationStored(TranslationStoredEvent $event): void\n    {\n        $model = $event->model;\n        $locale = $event->locale;\n        \n        Log::info('Translation stored', [\n            'model' => get_class($model),\n            'model_id' => $model->id,\n            'locale' => $locale,\n        ]);\n    }\n\n    public function handleTranslationForgotten(TranslationForgetEvent $event): void\n    {\n        $translation = $event->translation;\n        \n        Log::warning('Translation forgotten', [\n            'translation_id' => $translation->id,\n            'locale' => $translation->locale,\n            'field' => $translation->field,\n        ]);\n    }\n\n    public function subscribe(Dispatcher $events): void\n    {\n        $events->listen(\n            TranslationStoredEvent::class,\n            [TranslationEventSubscriber::class, 'handleTranslationStored']\n        );\n\n        $events->listen(\n            TranslationForgetEvent::class,\n            [TranslationEventSubscriber::class, 'handleTranslationForgotten']\n        );\n    }\n}\n"})}),"\n",(0,s.jsx)(e.p,{children:"Register the subscriber:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"namespace App\\Providers;\n\nuse App\\Listeners\\TranslationEventSubscriber;\nuse Illuminate\\Foundation\\Support\\Providers\\EventServiceProvider as ServiceProvider;\n\nclass EventServiceProvider extends ServiceProvider\n{\n    protected $subscribe = [\n        TranslationEventSubscriber::class,\n    ];\n}\n"})}),"\n",(0,s.jsx)(e.h2,{id:"complete-examples",children:"Complete Examples"}),"\n",(0,s.jsx)(e.h3,{id:"example-1-cache-invalidation-on-translation-changes",children:"Example 1: Cache Invalidation on Translation Changes"}),"\n",(0,s.jsx)(e.p,{children:"Invalidate cache when translations are modified:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:'namespace App\\Listeners\\Translation;\n\nuse Illuminate\\Support\\Facades\\Cache;\nuse JobMetric\\Translation\\Events\\TranslationStoredEvent;\nuse JobMetric\\Translation\\Events\\TranslationForgetEvent;\n\nclass InvalidateTranslationCache\n{\n    public function handle(TranslationStoredEvent|TranslationForgetEvent $event): void\n    {\n        $model = $event->model ?? $event->translation->translatable;\n        $locale = $event->locale ?? $event->translation->locale;\n\n        // Invalidate specific model cache\n        Cache::forget("translation.{$model->getMorphClass()}.{$model->id}");\n        Cache::forget("translation.{$model->getMorphClass()}.{$model->id}.{$locale}");\n        \n        // Invalidate all translations cache for this model\n        Cache::forget("translations.{$model->getMorphClass()}.{$model->id}");\n\n        // Clear tagged cache\n        Cache::tags([get_class($model)])->flush();\n        Cache::tags(["translation_{$model->getMorphClass()}_{$model->id}"])->flush();\n    }\n}\n'})}),"\n",(0,s.jsx)(e.h3,{id:"example-2-audit-logging",children:"Example 2: Audit Logging"}),"\n",(0,s.jsx)(e.p,{children:"Log all translation operations for audit trail:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"namespace App\\Listeners\\Translation;\n\nuse App\\Models\\AuditLog;\nuse Illuminate\\Support\\Facades\\Auth;\nuse JobMetric\\Translation\\Events\\TranslationStoredEvent;\nuse JobMetric\\Translation\\Events\\TranslationForgetEvent;\n\nclass AuditTranslationOperations\n{\n    public function handleTranslationStored(TranslationStoredEvent $event): void\n    {\n        $this->logAudit('stored', $event->model, $event->locale, $event->data);\n    }\n\n    public function handleTranslationForgotten(TranslationForgetEvent $event): void\n    {\n        $translation = $event->translation;\n        \n        $this->logAudit('forgotten', $translation->translatable, $translation->locale, [\n            'field' => $translation->field,\n            'value' => $translation->value,\n        ]);\n    }\n\n    protected function logAudit(string $action, $model, string $locale, array $data): void\n    {\n        AuditLog::create([\n            'user_id' => Auth::id(),\n            'action' => \"translation.{$action}\",\n            'model_type' => get_class($model),\n            'model_id' => $model->id,\n            'locale' => $locale,\n            'data' => $data,\n            'ip_address' => request()->ip(),\n        ]);\n    }\n}\n"})}),"\n",(0,s.jsx)(e.h3,{id:"example-3-search-index-updates",children:"Example 3: Search Index Updates"}),"\n",(0,s.jsx)(e.p,{children:"Update search index when important translations change:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"namespace App\\Listeners\\Translation;\n\nuse App\\Services\\SearchService;\nuse JobMetric\\Translation\\Events\\TranslationStoredEvent;\nuse JobMetric\\Translation\\Events\\TranslationForgetEvent;\n\nclass UpdateSearchIndex\n{\n    protected array $searchableFields = ['title', 'description', 'content', 'body'];\n\n    public function handleTranslationStored(TranslationStoredEvent $event): void\n    {\n        $field = $event->data['field'] ?? null;\n        \n        // Only update index for searchable fields\n        if (in_array($field, $this->searchableFields)) {\n            SearchService::index($event->model, $event->locale);\n        }\n    }\n\n    public function handleTranslationForgotten(TranslationForgetEvent $event): void\n    {\n        $translation = $event->translation;\n        \n        // Re-index if searchable field was forgotten\n        if (in_array($translation->field, $this->searchableFields)) {\n            SearchService::index($translation->translatable, $translation->locale);\n        }\n    }\n}\n"})}),"\n",(0,s.jsx)(e.h3,{id:"example-4-notification-system",children:"Example 4: Notification System"}),"\n",(0,s.jsx)(e.p,{children:"Send notifications when critical translations change:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"namespace App\\Listeners\\Translation;\n\nuse App\\Notifications\\TranslationChanged;\nuse Illuminate\\Support\\Facades\\Notification;\nuse JobMetric\\Translation\\Events\\TranslationStoredEvent;\n\nclass NotifyTranslationChanges\n{\n    protected array $notifiableFields = ['title', 'status', 'published', 'featured'];\n\n    public function handle(TranslationStoredEvent $event): void\n    {\n        $field = $event->data['field'] ?? null;\n        $model = $event->model;\n\n        // Only notify for specific fields\n        if (!in_array($field, $this->notifiableFields)) {\n            return;\n        }\n\n        // Get model owner\n        $owner = null;\n        if (method_exists($model, 'user')) {\n            $owner = $model->user;\n        } elseif (method_exists($model, 'author')) {\n            $owner = $model->author;\n        }\n\n        if ($owner) {\n            $owner->notify(new TranslationChanged($model, $event->locale, $field));\n        }\n\n        // Notify administrators for critical fields\n        if (in_array($field, ['status', 'published'])) {\n            $admins = User::whereHas('roles', function ($query) {\n                $query->where('name', 'admin');\n            })->get();\n\n            Notification::send($admins, new TranslationChanged($model, $event->locale, $field));\n        }\n    }\n}\n"})}),"\n",(0,s.jsx)(e.h3,{id:"example-5-analytics-tracking",children:"Example 5: Analytics Tracking"}),"\n",(0,s.jsx)(e.p,{children:"Track translation changes for analytics:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"namespace App\\Listeners\\Translation;\n\nuse App\\Services\\AnalyticsService;\nuse JobMetric\\Translation\\Events\\TranslationStoredEvent;\nuse JobMetric\\Translation\\Events\\TranslationForgetEvent;\n\nclass TrackTranslationAnalytics\n{\n    public function __construct(\n        protected AnalyticsService $analytics\n    ) {}\n\n    public function handleTranslationStored(TranslationStoredEvent $event): void\n    {\n        $model = $event->model;\n        $locale = $event->locale;\n        $data = $event->data;\n        \n        $this->analytics->track('translation.stored', [\n            'model_type' => get_class($model),\n            'model_id' => $model->id,\n            'locale' => $locale,\n            'field' => $data['field'] ?? null,\n            'version' => $data['version'] ?? null,\n        ]);\n    }\n\n    public function handleTranslationForgotten(TranslationForgetEvent $event): void\n    {\n        $translation = $event->translation;\n        \n        $this->analytics->track('translation.forgotten', [\n            'translation_id' => $translation->id,\n            'locale' => $translation->locale,\n            'field' => $translation->field,\n            'model_type' => $translation->translatable_type,\n            'model_id' => $translation->translatable_id,\n        ]);\n    }\n}\n"})}),"\n",(0,s.jsx)(e.h3,{id:"example-6-translation-synchronization",children:"Example 6: Translation Synchronization"}),"\n",(0,s.jsx)(e.p,{children:"Synchronize translations with external systems:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"namespace App\\Listeners\\Translation;\n\nuse App\\Services\\ExternalApiService;\nuse JobMetric\\Translation\\Events\\TranslationStoredEvent;\nuse JobMetric\\Translation\\Events\\TranslationForgetEvent;\n\nclass SynchronizeTranslations\n{\n    protected array $syncableFields = ['title', 'description', 'content'];\n\n    public function __construct(\n        protected ExternalApiService $externalApi\n    ) {}\n\n    public function handleTranslationStored(TranslationStoredEvent $event): void\n    {\n        $field = $event->data['field'] ?? null;\n        \n        // Only sync specific fields\n        if (!in_array($field, $this->syncableFields)) {\n            return;\n        }\n\n        $this->externalApi->syncTranslation(\n            $event->model,\n            $event->locale,\n            $field,\n            $event->data['value'] ?? null\n        );\n    }\n\n    public function handleTranslationForgotten(TranslationForgetEvent $event): void\n    {\n        $translation = $event->translation;\n        \n        if (in_array($translation->field, $this->syncableFields)) {\n            $this->externalApi->deleteTranslation(\n                $translation->translatable,\n                $translation->locale,\n                $translation->field\n            );\n        }\n    }\n}\n"})}),"\n",(0,s.jsx)(e.h3,{id:"example-7-real-time-updates",children:"Example 7: Real-time Updates"}),"\n",(0,s.jsx)(e.p,{children:"Send real-time updates via WebSockets or broadcasting:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"namespace App\\Listeners\\Translation;\n\nuse Illuminate\\Support\\Facades\\Broadcast;\nuse JobMetric\\Translation\\Events\\TranslationStoredEvent;\nuse JobMetric\\Translation\\Events\\TranslationForgetEvent;\n\nclass BroadcastTranslationChanges\n{\n    public function handleTranslationStored(TranslationStoredEvent $event): void\n    {\n        $model = $event->model;\n        \n        Broadcast::channel(\"translation.{$model->getMorphClass()}.{$model->id}\", function () {\n            return true;\n        })->toOthers();\n        \n        event(new TranslationChanged([\n            'type' => 'stored',\n            'model' => $model,\n            'locale' => $event->locale,\n            'field' => $event->data['field'] ?? null,\n        ]));\n    }\n\n    public function handleTranslationForgotten(TranslationForgetEvent $event): void\n    {\n        $translation = $event->translation;\n        $model = $translation->translatable;\n        \n        event(new TranslationChanged([\n            'type' => 'forgotten',\n            'model' => $model,\n            'locale' => $translation->locale,\n            'field' => $translation->field,\n        ]));\n    }\n}\n"})}),"\n",(0,s.jsx)(e.h3,{id:"example-8-complete-event-listener-setup",children:"Example 8: Complete Event Listener Setup"}),"\n",(0,s.jsx)(e.p,{children:"Complete setup for all translation events:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"namespace App\\Providers;\n\nuse App\\Listeners\\Translation\\AuditTranslationOperations;\nuse App\\Listeners\\Translation\\BroadcastTranslationChanges;\nuse App\\Listeners\\Translation\\InvalidateTranslationCache;\nuse App\\Listeners\\Translation\\NotifyTranslationChanges;\nuse App\\Listeners\\Translation\\TrackTranslationAnalytics;\nuse App\\Listeners\\Translation\\UpdateSearchIndex;\nuse App\\Listeners\\Translation\\SynchronizeTranslations;\nuse Illuminate\\Foundation\\Support\\Providers\\EventServiceProvider as ServiceProvider;\nuse JobMetric\\Translation\\Events\\TranslationStoredEvent;\nuse JobMetric\\Translation\\Events\\TranslationForgetEvent;\n\nclass EventServiceProvider extends ServiceProvider\n{\n    protected $listen = [\n        // After storing\n        TranslationStoredEvent::class => [\n            AuditTranslationOperations::class,\n            InvalidateTranslationCache::class,\n            UpdateSearchIndex::class,\n            NotifyTranslationChanges::class,\n            TrackTranslationAnalytics::class,\n            BroadcastTranslationChanges::class,\n            SynchronizeTranslations::class,\n        ],\n\n        // After forgetting\n        TranslationForgetEvent::class => [\n            AuditTranslationOperations::class,\n            InvalidateTranslationCache::class,\n            UpdateSearchIndex::class,\n            TrackTranslationAnalytics::class,\n            BroadcastTranslationChanges::class,\n            SynchronizeTranslations::class,\n        ],\n    ];\n\n    public function boot(): void\n    {\n        parent::boot();\n    }\n}\n"})}),"\n",(0,s.jsx)(e.h2,{id:"event-timing",children:"Event Timing"}),"\n",(0,s.jsx)(e.h3,{id:"translationstoredevent",children:"TranslationStoredEvent"}),"\n",(0,s.jsxs)(e.p,{children:["Fired ",(0,s.jsx)(e.strong,{children:"after"})," the translation is saved to database:"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"// Execution order:\n// 1. Validate input data\n// 2. Create or update translation record\n// 3. Save to database\n// 4. Fire TranslationStoredEvent \u2190 Event fired here\n// 5. Return model instance\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Note"}),": This event fires for both new translations and updates to existing translations."]}),"\n",(0,s.jsx)(e.h3,{id:"translationforgetevent",children:"TranslationForgetEvent"}),"\n",(0,s.jsxs)(e.p,{children:["Fired ",(0,s.jsx)(e.strong,{children:"after"})," the translation is deleted from database:"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"// Execution order:\n// 1. Find translation record(s)\n// 2. Delete translation record(s)\n// 3. Fire TranslationForgetEvent \u2190 Event fired here\n// 4. Return model instance\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Important Notes"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["The translation is ",(0,s.jsx)(e.strong,{children:"saved"})," to database before ",(0,s.jsx)(e.code,{children:"TranslationStoredEvent"})," fires"]}),"\n",(0,s.jsxs)(e.li,{children:["You can access ",(0,s.jsx)(e.strong,{children:"fresh translation data"})," in listeners"]}),"\n",(0,s.jsxs)(e.li,{children:["Database transaction is ",(0,s.jsx)(e.strong,{children:"committed"})," before events fire"]}),"\n",(0,s.jsxs)(e.li,{children:["Events are ",(0,s.jsx)(e.strong,{children:"synchronous"})," by default (can be queued)"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"TranslationStoredEvent"})," fires for ",(0,s.jsx)(e.strong,{children:"both"})," create and update operations"]}),"\n",(0,s.jsxs)(e.li,{children:["Multiple ",(0,s.jsx)(e.code,{children:"TranslationStoredEvent"})," events may fire when storing multiple fields"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"queued-events",children:"Queued Events"}),"\n",(0,s.jsx)(e.p,{children:"You can queue events for asynchronous processing:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"namespace App\\Listeners\\Translation;\n\nuse Illuminate\\Contracts\\Queue\\ShouldQueue;\nuse JobMetric\\Translation\\Events\\TranslationStoredEvent;\n\nclass ProcessTranslationAsync implements ShouldQueue\n{\n    public function handle(TranslationStoredEvent $event): void\n    {\n        $model = $event->model;\n        $locale = $event->locale;\n        \n        // Heavy processing that doesn't block the request\n        $this->updateSearchIndex($model, $locale);\n        $this->syncWithExternalService($model, $locale);\n        $this->generateAnalyticsReport($model, $locale);\n    }\n\n    protected function updateSearchIndex($model, $locale): void\n    {\n        // Update search index\n    }\n\n    protected function syncWithExternalService($model, $locale): void\n    {\n        // Sync with external API\n    }\n\n    protected function generateAnalyticsReport($model, $locale): void\n    {\n        // Generate analytics\n    }\n}\n"})}),"\n",(0,s.jsx)(e.h2,{id:"event-payload-details",children:"Event Payload Details"}),"\n",(0,s.jsx)(e.h3,{id:"translationstoredevent-1",children:"TranslationStoredEvent"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"readonly class TranslationStoredEvent implements DomainEvent\n{\n    public function __construct(\n        public Model $model,      // Model instance\n        public string $locale,     // Locale code (e.g., 'en', 'fa')\n        public array $data         // Translation data\n    ) {}\n}\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Available Properties"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"$model"}),": The model instance that received the translation"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"$locale"}),": The locale code (e.g., ",(0,s.jsx)(e.code,{children:"'en'"}),", ",(0,s.jsx)(e.code,{children:"'fa'"}),", ",(0,s.jsx)(e.code,{children:"'de'"}),")"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"$data"}),": Array containing:","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"field"}),": The translated field name"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"value"}),": The translation value"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"version"}),": The translation version (if versioning is enabled)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Example Payload"}),":"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"$event->model;        // Product instance\n$event->locale;       // 'en'\n$event->data;         // ['field' => 'title', 'value' => 'Product Name', 'version' => 1]\n"})}),"\n",(0,s.jsx)(e.h3,{id:"translationforgetevent-1",children:"TranslationForgetEvent"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"readonly class TranslationForgetEvent implements DomainEvent\n{\n    public function __construct(\n        public Translation $translation  // Translation model instance (deleted)\n    ) {}\n}\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Available Properties"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"$translation"}),": The ",(0,s.jsx)(e.code,{children:"Translation"})," model instance with:","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"id"}),": Translation ID"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"translatable_type"}),": Type of parent model"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"translatable_id"}),": ID of parent model"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"locale"}),": Locale code"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"field"}),": Field name"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"value"}),": Translation value"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"version"}),": Translation version"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"created_at"}),": Creation timestamp"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"updated_at"}),": Update timestamp"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Example Payload"}),":"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"$event->translation->translatable;  // Product instance\n$event->translation->locale;       // 'en'\n$event->translation->field;        // 'title'\n$event->translation->value;        // 'Product Name'\n"})}),"\n",(0,s.jsx)(e.h2,{id:"when-to-use-events",children:"When to Use Events"}),"\n",(0,s.jsx)(e.p,{children:"Use events when you need to:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Cache Management"}),": Invalidate or update cached translations"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Search Indexing"}),": Update search index when translations change"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Notifications"}),": Send notifications when critical translations change"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Analytics"}),": Track translation operations for analytics"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Audit Logging"}),": Log translation changes for compliance"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Synchronization"}),": Sync translations with external systems"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Real-time Updates"}),": Broadcast translation changes to clients"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Business Rules"}),": Enforce business rules on translation operations"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Integration"}),": Integrate with external services"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Side Effects"}),": Perform side effects without coupling"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(l.A,{to:"/packages/laravel-translation/deep-diving/has-translation",children:"HasTranslation"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(l.A,{to:"/packages/laravel-translation/deep-diving/resources/translation-resource",children:"TranslationResource"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(l.A,{to:"/packages/laravel-translation/deep-diving/resources/translation-collection-resource",children:"TranslationCollectionResource"}),"\n"]}),"\n"]})]})}function v(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(h,{...n})}):h(n)}},28453(n,e,t){t.d(e,{R:()=>l,x:()=>r});var a=t(96540);const s={},i=a.createContext(s);function l(n){const e=a.useContext(i);return a.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:l(n.components),a.createElement(i.Provider,{value:e},n.children)}}}]);