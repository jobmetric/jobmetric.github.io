"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[7337],{8453(e,n,l){l.d(n,{R:()=>a,x:()=>i});var s=l(6540);const r={},t=s.createContext(r);function a(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(t.Provider,{value:n},e.children)}},9570(e,n,l){l.r(n),l.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"laravel-translation/deep-diving/requests/translation-array-request","title":"TranslationArrayRequest Trait","description":"The TranslationArrayRequest trait composes validation rules and human\u2011friendly attribute labels for a translation payload. If multiple locales are present under translation, rules are generated for each locale; otherwise, it falls back to app()->getLocale().","source":"@site/packages/laravel-translation/deep-diving/requests/translation-array-request.md","sourceDirName":"laravel-translation/deep-diving/requests","slug":"/laravel-translation/deep-diving/requests/translation-array-request","permalink":"/packages/laravel-translation/deep-diving/requests/translation-array-request","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-translation/deep-diving/requests/translation-array-request.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"sidebar_label":"TranslationArrayRequest"},"sidebar":"packagesSidebar","previous":{"title":"HasTranslation","permalink":"/packages/laravel-translation/deep-diving/has-translation"},"next":{"title":"MultiTranslationArrayRequest","permalink":"/packages/laravel-translation/deep-diving/requests/multi-translation-array-request"}}');var r=l(4848),t=l(8453);const a={sidebar_position:1,sidebar_label:"TranslationArrayRequest"},i="TranslationArrayRequest Trait",o={},d=[{value:"When to Use TranslationArrayRequest",id:"when-to-use-translationarrayrequest",level:2},{value:"What It Does",id:"what-it-does",level:2},{value:"Quick Start (Typical FormRequest)",id:"quick-start-typical-formrequest",level:2},{value:"Example: Resulting <code>rules()</code> Output (Multiple Locales)",id:"example-resulting-rules-output-multiple-locales",level:2},{value:"Example: Resulting <code>rules()</code> Output (No Locales Provided)",id:"example-resulting-rules-output-no-locales-provided",level:2},{value:"Example: Resulting <code>attributes()</code> Output (Multiple Locales)",id:"example-resulting-attributes-output-multiple-locales",level:2},{value:"Primary Field and Uniqueness",id:"primary-field-and-uniqueness",level:2},{value:"End-to-End Minimal Flow",id:"end-to-end-minimal-flow",level:2},{value:"Summary",id:"summary",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function c(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"translationarrayrequest-trait",children:"TranslationArrayRequest Trait"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"TranslationArrayRequest"})," trait composes ",(0,r.jsx)(n.strong,{children:"validation rules"})," and ",(0,r.jsx)(n.strong,{children:"human\u2011friendly attribute labels"})," for a ",(0,r.jsx)(n.code,{children:"translation"})," payload. If multiple locales are present under ",(0,r.jsx)(n.code,{children:"translation"}),", rules are generated for ",(0,r.jsx)(n.strong,{children:"each"})," locale; otherwise, it falls back to ",(0,r.jsx)(n.code,{children:"app()->getLocale()"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"when-to-use-translationarrayrequest",children:"When to Use TranslationArrayRequest"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.strong,{children:["Use ",(0,r.jsx)(n.code,{children:"TranslationArrayRequest"})," when you need:"]})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Array-based translation validation"}),": Your translation payload uses a simple array structure"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Single or multiple locales"}),": Works with one locale (app locale) or multiple locales in the payload"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Automatic rule generation"}),": Automatically generates validation rules for each locale and field"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Primary field uniqueness"}),": Enforces uniqueness for a primary field (default: ",(0,r.jsx)(n.code,{children:"name"}),") using ",(0,r.jsx)(n.code,{children:"TranslationFieldExistRule"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Human-friendly labels"}),": Automatically generates attribute labels for translation fields"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Simple form requests"}),": Perfect for straightforward translation validation scenarios"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example scenarios:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Creating or updating products with translations in a simple array format"}),"\n",(0,r.jsx)(n.li,{children:"Blog post forms with title and content translations"}),"\n",(0,r.jsx)(n.li,{children:"Category management with name and description translations"}),"\n",(0,r.jsx)(n.li,{children:"Simple content management forms with basic translation fields"}),"\n",(0,r.jsx)(n.li,{children:"Forms where translation structure is straightforward and doesn't require complex validation"}),"\n"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["This document focuses only on request-side validation and attribute labels. No database or tests here. All examples include ",(0,r.jsx)(n.strong,{children:"expected output"})," blocks you can compare against during development."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"what-it-does",children:"What It Does"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Detects locales from the incoming payload:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["If ",(0,r.jsx)(n.code,{children:"translation"})," is an array: uses its keys as locales (e.g., ",(0,r.jsx)(n.code,{children:"en"}),", ",(0,r.jsx)(n.code,{children:"fa"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Otherwise: uses ",(0,r.jsx)(n.code,{children:"app()->getLocale()"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["For every locale:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Adds a container rule: ",(0,r.jsx)(n.code,{children:"translation.{locale} => array"})]}),"\n",(0,r.jsxs)(n.li,{children:["Enforces a ",(0,r.jsx)(n.strong,{children:"primary"})," translated field (default ",(0,r.jsx)(n.code,{children:"name"}),") as:",(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:"required|string + TranslationFieldExistRule"})," (per-locale uniqueness)"]}),"\n",(0,r.jsxs)(n.li,{children:["Adds optional string rules for all other fields returned by ",(0,r.jsx)(n.code,{children:"translationAllowFields()"})," on the target model."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Builds attribute labels for each ",(0,r.jsx)(n.code,{children:"translation.{locale}.{field}"})," key using:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Special labels for meta fields (",(0,r.jsx)(n.code,{children:"meta_title"}),", ",(0,r.jsx)(n.code,{children:"meta_description"}),", ",(0,r.jsx)(n.code,{children:"meta_keywords"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["A custom translation scope containing ",(0,r.jsx)(n.code,{children:"{field}"})," (if provided)."]}),"\n",(0,r.jsx)(n.li,{children:"A sensible fallback: a title\u2011cased field name."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"quick-start-typical-formrequest",children:"Quick Start (Typical FormRequest)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"<?php\n\nnamespace App\\Http\\Requests;\n\nuse Illuminate\\Foundation\\Http\\FormRequest;\nuse JobMetric\\Translation\\Http\\Requests\\TranslationArrayRequest;\n\nclass StorePostRequest extends FormRequest\n{\n    use TranslationArrayRequest;\n\n    public function authorize(): bool\n    {\n        return true;\n    }\n\n    public function rules(): array\n    {\n        $rules = [\n            'slug' => 'required|string',\n        ];\n\n        // Build translation rules based on payload and model contract\n        $this->renderTranslationFiled(\n            $rules,\n            $this->all(),               // request data\n            \\App\\Models\\Post::class, // model exposing translationAllowFields()\n            'title',                    // primary field\n            null,                       // object_id (null on create)\n            null,                       // parent_id (optional scope)\n            []                          // parent_where (optional constraints)\n        );\n\n        return $rules;\n    }\n\n    public function attributes(): array\n    {\n        $attributes = [\n            'slug' => 'Slug',\n        ];\n\n        // Produce readable labels. Pass a scope containing \"{field}\" if you want templated labels.\n        $this->renderTranslationAttribute(\n            $attributes,\n            $this->all(),\n            \\App\\Models\\Post::class,\n            null // or e.g. 'validation.attributes.translation_field' with \"{field}\" placeholder\n        );\n\n        return $attributes;\n    }\n}\n"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Note:"})," Method names are ",(0,r.jsx)(n.code,{children:"renderTranslationFiled"})," and ",(0,r.jsx)(n.code,{children:"renderTranslationAttribute"})," (keep them exactly as implemented). The target model must implement ",(0,r.jsx)(n.code,{children:"translationAllowFields()"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"example-resulting-rules-output-multiple-locales",children:["Example: Resulting ",(0,r.jsx)(n.code,{children:"rules()"})," Output (Multiple Locales)"]}),"\n",(0,r.jsx)(n.p,{children:"Assumptions:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Incoming payload contains:","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "slug": "hello-world",\n  "translation": {\n    "en": { "title": "Hello", "summary": "First post" },\n    "fa": { "title": "\u0633\u0644\u0627\u0645",   "summary": "\u0627\u0648\u0644\u06cc\u0646 \u067e\u0633\u062a" }\n  }\n}\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"App\\Models\\Post::translationAllowFields()"})," returns: ",(0,r.jsx)(n.code,{children:"['title', 'summary', 'meta_title', 'meta_description']"})]}),"\n",(0,r.jsxs)(n.li,{children:["Primary field is ",(0,r.jsx)(n.code,{children:"title"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code (excerpt):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$rules = ['slug' => 'required|string'];\n\n$this->renderTranslationFiled(\n    $rules,\n    $payload,\n    \\App\\Models\\Post::class,\n    'title',\n    null,\n    null,\n    []\n);\n\nreturn $rules;\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.strong,{children:["Expected Output (",(0,r.jsx)(n.code,{children:"print_r($rules)"}),"):"]})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Array\n(\n    [slug] => required|string\n    [translation] => array\n    [translation.en] => array\n    [translation.en.title] => Array\n        (\n            [0] => required\n            [1] => string\n            [2] => JobMetric\\Translation\\Rules\\TranslationFieldExistRule Object (...)\n        )\n\n    [translation.en.summary] => string|nullable|sometimes\n    [translation.en.meta_title] => string|nullable|sometimes\n    [translation.en.meta_description] => string|nullable|sometimes\n\n    [translation.fa] => array\n    [translation.fa.title] => Array\n        (\n            [0] => required\n            [1] => string\n            [2] => JobMetric\\Translation\\Rules\\TranslationFieldExistRule Object (...)\n        )\n\n    [translation.fa.summary] => string|nullable|sometimes\n    [translation.fa.meta_title] => string|nullable|sometimes\n    [translation.fa.meta_description] => string|nullable|sometimes\n)\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"example-resulting-rules-output-no-locales-provided",children:["Example: Resulting ",(0,r.jsx)(n.code,{children:"rules()"})," Output (No Locales Provided)"]}),"\n",(0,r.jsx)(n.p,{children:"Assumptions:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Incoming payload does ",(0,r.jsx)(n.strong,{children:"not"})," have ",(0,r.jsx)(n.code,{children:"translation"})," key, or it is not an array."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"app()->getLocale()"})," returns ",(0,r.jsx)(n.code,{children:"en"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"translationAllowFields()"})," returns ",(0,r.jsx)(n.code,{children:"['name', 'description']"})]}),"\n",(0,r.jsxs)(n.li,{children:["Primary field is ",(0,r.jsx)(n.code,{children:"name"})," (default)."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Expected Output (excerpt):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Array\n(\n    [translation] => array\n    [translation.en] => array\n    [translation.en.name] => Array\n        (\n            [0] => required\n            [1] => string\n            [2] => JobMetric\\Translation\\Rules\\TranslationFieldExistRule Object (...)\n        )\n\n    [translation.en.description] => string|nullable|sometimes\n)\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"example-resulting-attributes-output-multiple-locales",children:["Example: Resulting ",(0,r.jsx)(n.code,{children:"attributes()"})," Output (Multiple Locales)"]}),"\n",(0,r.jsxs)(n.p,{children:["Using the first example payload and fields, with ",(0,r.jsx)(n.strong,{children:"no"})," ",(0,r.jsx)(n.code,{children:"$trans_scope"})," provided (so it falls back to title\u2011cased names)."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code (excerpt):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$attributes = ['slug' => 'Slug'];\n\n$this->renderTranslationAttribute(\n    $attributes,\n    $payload,\n    \\App\\Models\\Post::class,\n    null\n);\n\nreturn $attributes;\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.strong,{children:["Expected Output (",(0,r.jsx)(n.code,{children:"print_r($attributes)"}),"):"]})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Array\n(\n    [slug] => Slug\n    [translation.en.title] => Title\n    [translation.en.summary] => Summary\n    [translation.en.meta_title] => Meta title\n    [translation.en.meta_description] => Meta description\n    [translation.fa.title] => Title\n    [translation.fa.summary] => Summary\n    [translation.fa.meta_title] => Meta title\n    [translation.fa.meta_description] => Meta description\n)\n"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["When ",(0,r.jsx)(n.code,{children:"$trans_scope"})," is provided (e.g., ",(0,r.jsx)(n.code,{children:"'validation.attributes.translation_field'"})," with ",(0,r.jsx)(n.code,{children:"{field}"})," inside), the ",(0,r.jsx)(n.code,{children:"{field}"})," placeholder is replaced per field and the resulting translation string is used."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"primary-field-and-uniqueness",children:"Primary Field and Uniqueness"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.strong,{children:"primary"})," field (default ",(0,r.jsx)(n.code,{children:"name"}),", or your override like ",(0,r.jsx)(n.code,{children:"title"}),") is enforced per locale with:",(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:"required|string + TranslationFieldExistRule"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["All other fields from ",(0,r.jsx)(n.code,{children:"translationAllowFields()"})," are attached as:",(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:"string|nullable|sometimes"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["You control the list of fields by implementing ",(0,r.jsx)(n.code,{children:"translationAllowFields()"})," on your model."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"end-to-end-minimal-flow",children:"End-to-End Minimal Flow"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Implement ",(0,r.jsx)(n.code,{children:"translationAllowFields()"})," on the target model (e.g., return ",(0,r.jsx)(n.code,{children:"['title','summary', ...]"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["In your ",(0,r.jsx)(n.code,{children:"FormRequest::rules()"}),", call ",(0,r.jsx)(n.code,{children:"renderTranslationFiled($rules, $this->all(), Model::class, 'title', ...)"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["In ",(0,r.jsx)(n.code,{children:"FormRequest::attributes()"}),", call ",(0,r.jsx)(n.code,{children:"renderTranslationAttribute($attributes, $this->all(), Model::class, $scopeOrNull)"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Done \u2014 your validator now understands ",(0,r.jsx)(n.code,{children:"translation.{locale}.{field}"})," for each locale present in the payload (or the app locale)."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"TranslationArrayRequest"})," makes multi-locale translation validation straightforward when your payload looks like:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "translation": {\n    "en": { "title": "...", "summary": "..." },\n    "fa": { "title": "...", "summary": "..." }\n  }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"It automatically:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Detects locales from the payload (or uses the app locale)"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/packages/laravel-translation/deep-diving/has-translation",children:"HasTranslation"})," - Core trait for multilingual models"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/packages/laravel-translation/deep-diving/rules/translation-field-exist-rule",children:"TranslationFieldExistRule"})," - Validation rule for unique translations"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/packages/laravel-translation/deep-diving/requests/multi-translation-array-request",children:"MultiTranslationArrayRequest"})," - Enhanced version for multi-locale scenarios"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/packages/laravel-translation/deep-diving/requests/translation-type-object-request",children:"TranslationTypeObjectRequest"})," - Typeify-based validation for complex schemas"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/packages/laravel-translation/deep-diving/resources/translation-resource",children:"TranslationResource"})," - JSON resource for API responses"]}),"\n",(0,r.jsx)(n.li,{children:"Enforces a primary translated field with per-locale uniqueness"}),"\n",(0,r.jsx)(n.li,{children:"Adds optional string rules for other allowed fields"}),"\n",(0,r.jsx)(n.li,{children:"Generates readable attribute labels for clean error messages"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://github.com/jobmetric/laravel-translation/blob/master/docs/TranslationTypeObjectRequest.md",children:"Next To Request - TranslationTypeObject"})})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);