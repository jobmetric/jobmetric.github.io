"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[9174],{28453(e,n,s){s.d(n,{R:()=>l,x:()=>a});var t=s(96540);const i={},r=t.createContext(i);function l(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(r.Provider,{value:n},e.children)}},37134(e,n,s){s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"laravel-event-system/deep-diving/store-event-system-request","title":"StoreEventSystemRequest","description":"The StoreEventSystemRequest is a form request class that validates and normalizes input data when creating or storing event-listener bindings in the Event System. It ensures data integrity by validating event and listener class names, priority values, and other required fields before storing them in the database.","source":"@site/packages/laravel-event-system/deep-diving/store-event-system-request.md","sourceDirName":"laravel-event-system/deep-diving","slug":"/laravel-event-system/deep-diving/store-event-system-request","permalink":"/packages/laravel-event-system/deep-diving/store-event-system-request","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-event-system/deep-diving/store-event-system-request.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"sidebar_label":"StoreEventSystemRequest"},"sidebar":"packagesSidebar","previous":{"title":"Events","permalink":"/packages/laravel-event-system/deep-diving/events"},"next":{"title":"EventSystemResource","permalink":"/packages/laravel-event-system/deep-diving/event-system-resource"}}');var i=s(74848),r=s(28453),l=s(28774);const a={sidebar_position:6,sidebar_label:"StoreEventSystemRequest"},d="StoreEventSystemRequest",o={},c=[{value:"Namespace",id:"namespace",level:2},{value:"Overview",id:"overview",level:2},{value:"Available Methods",id:"available-methods",level:2},{value:"<code>authorize()</code>",id:"authorize",level:3},{value:"<code>rules()</code>",id:"rules",level:3},{value:"<code>normalize()</code>",id:"normalize",level:3},{value:"<code>prepareForValidation()</code>",id:"prepareforvalidation",level:3},{value:"<code>attributes()</code>",id:"attributes",level:3},{value:"Validation Rules",id:"validation-rules",level:2},{value:"Field Details",id:"field-details",level:3},{value:"<code>name</code> Field",id:"name-field",level:3},{value:"<code>description</code> Field",id:"description-field",level:3},{value:"<code>event</code> Field",id:"event-field",level:3},{value:"<code>listener</code> Field",id:"listener-field",level:3},{value:"<code>priority</code> Field",id:"priority-field",level:3},{value:"<code>status</code> Field",id:"status-field",level:3},{value:"Data Normalization",id:"data-normalization",level:2},{value:"Priority Normalization",id:"priority-normalization",level:3},{value:"Description Normalization",id:"description-normalization",level:3},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Example 1: Basic Controller Usage",id:"example-1-basic-controller-usage",level:3},{value:"Example 2: API Controller",id:"example-2-api-controller",level:3},{value:"Example 3: Programmatic Usage with DTO",id:"example-3-programmatic-usage-with-dto",level:3},{value:"Example 4: Batch Creation",id:"example-4-batch-creation",level:3},{value:"Example 5: Custom Authorization",id:"example-5-custom-authorization",level:3},{value:"Example 6: Conditional Validation",id:"example-6-conditional-validation",level:3},{value:"Example 7: Custom Error Messages",id:"example-7-custom-error-messages",level:3},{value:"Example 8: Integration with Event System Service",id:"example-8-integration-with-event-system-service",level:3},{value:"Validation Flow",id:"validation-flow",level:2},{value:"HTTP Request Flow",id:"http-request-flow",level:3},{value:"Programmatic Flow",id:"programmatic-flow",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Validation Errors",id:"validation-errors",level:3},{value:"Handling in Controller",id:"handling-in-controller",level:3},{value:"Handling Validation Failures",id:"handling-validation-failures",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Always Use Type Hints",id:"1-always-use-type-hints",level:3},{value:"2. Use DTO for Programmatic Usage",id:"2-use-dto-for-programmatic-usage",level:3},{value:"3. Override Authorization",id:"3-override-authorization",level:3},{value:"4. Provide Custom Messages",id:"4-provide-custom-messages",level:3},{value:"5. Use Class Constants",id:"5-use-class-constants",level:3},{value:"Common Mistakes",id:"common-mistakes",level:2},{value:"Mistake 1: Not Using DTO for Programmatic Usage",id:"mistake-1-not-using-dto-for-programmatic-usage",level:3},{value:"Mistake 2: Forgetting Authorization",id:"mistake-2-forgetting-authorization",level:3},{value:"Mistake 3: Not Handling Normalization",id:"mistake-3-not-handling-normalization",level:3},{value:"Mistake 4: Using Wrong Class Names",id:"mistake-4-using-wrong-class-names",level:3},{value:"Related Documentation",id:"related-documentation",level:2}];function u(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"storeeventsystemrequest",children:"StoreEventSystemRequest"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"StoreEventSystemRequest"})," is a form request class that validates and normalizes input data when creating or storing event-listener bindings in the Event System. It ensures data integrity by validating event and listener class names, priority values, and other required fields before storing them in the database."]}),"\n",(0,i.jsx)(n.h2,{id:"namespace",children:"Namespace"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"JobMetric\\EventSystem\\Http\\Requests\\StoreEventSystemRequest\n"})}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"StoreEventSystemRequest"})," provides comprehensive validation and data normalization for event system bindings. It:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Validates all required fields"})," before storing event-listener bindings"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Checks class existence"})," for event and listener classes using ",(0,i.jsx)(n.code,{children:"ClassExistRule"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Normalizes input data"})," with default values and type conversions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Provides translated attributes"})," for better error messages"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Supports DTO conversion"})," for programmatic usage outside HTTP requests"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Ensures uniqueness"})," of event binding names"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"available-methods",children:"Available Methods"}),"\n",(0,i.jsx)(n.h3,{id:"authorize",children:(0,i.jsx)(n.code,{children:"authorize()"})}),"\n",(0,i.jsx)(n.p,{children:"Determines if the user is authorized to make this request."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"public function authorize(): bool\n{\n    return true; // Default: allows all requests\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Override for authorization:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"namespace App\\Http\\Requests;\n\nuse JobMetric\\EventSystem\\Http\\Requests\\StoreEventSystemRequest as BaseRequest;\n\nclass StoreEventSystemRequest extends BaseRequest\n{\n    public function authorize(): bool\n    {\n        return $this->user()->can('create', \\JobMetric\\EventSystem\\Models\\Event::class);\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"rules",children:(0,i.jsx)(n.code,{children:"rules()"})}),"\n",(0,i.jsx)(n.p,{children:"Get the validation rules that apply to the request."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"public function rules(): array\n{\n    return [\n        'name' => 'required|string|max:255|unique:events,name',\n        'description' => 'string|nullable',\n        'event' => [\n            'required',\n            'string',\n            new ClassExistRule\n        ],\n        'listener' => [\n            'required',\n            'string',\n            new ClassExistRule\n        ],\n        'priority' => 'integer|nullable',\n        'status' => 'boolean'\n    ];\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"normalize",children:(0,i.jsx)(n.code,{children:"normalize()"})}),"\n",(0,i.jsx)(n.p,{children:"Normalize raw input when validating outside Laravel's FormRequest pipeline."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"public static function normalize(array $data): array\n{\n    $data['priority'] = $data['priority'] ?? 0;\n\n    if (($data['description'] ?? null) === '') {\n        $data['description'] = null;\n    }\n\n    return $data;\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// Normalize data before validation\n$normalized = StoreEventSystemRequest::normalize($input);\n$dto = dto($normalized, StoreEventSystemRequest::class);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"prepareforvalidation",children:(0,i.jsx)(n.code,{children:"prepareForValidation()"})}),"\n",(0,i.jsx)(n.p,{children:"Laravel's native pipeline calls this when using the FormRequest normally."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"protected function prepareForValidation(): void\n{\n    $this->merge(static::normalize($this->all()));\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"This method automatically normalizes data when the request is used in controllers."}),"\n",(0,i.jsx)(n.h3,{id:"attributes",children:(0,i.jsx)(n.code,{children:"attributes()"})}),"\n",(0,i.jsx)(n.p,{children:"Get custom attributes for validator errors."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"public function attributes(): array\n{\n    return [\n        'name' => trans('event-system::base.fields.name'),\n        'description' => trans('event-system::base.fields.description'),\n        'event' => trans('event-system::base.fields.event'),\n        'listener' => trans('event-system::base.fields.listener'),\n        'priority' => trans('event-system::base.fields.priority'),\n        'status' => trans('event-system::base.fields.status'),\n    ];\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"validation-rules",children:"Validation Rules"}),"\n",(0,i.jsx)(n.h3,{id:"field-details",children:"Field Details"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Field"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Required"}),(0,i.jsx)(n.th,{children:"Rules"}),(0,i.jsx)(n.th,{children:"Default"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"name"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"required|string|max:255|unique:events,name"})}),(0,i.jsx)(n.td,{children:"-"}),(0,i.jsx)(n.td,{children:"Unique identifier for the event-listener binding"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"description"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"No"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"string|nullable"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"null"})}),(0,i.jsx)(n.td,{children:"Optional description for the binding"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"event"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"required|string|ClassExistRule"})}),(0,i.jsx)(n.td,{children:"-"}),(0,i.jsx)(n.td,{children:"Fully qualified event class name"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"listener"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"required|string|ClassExistRule"})}),(0,i.jsx)(n.td,{children:"-"}),(0,i.jsx)(n.td,{children:"Fully qualified listener class name"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"priority"})}),(0,i.jsx)(n.td,{children:"integer"}),(0,i.jsx)(n.td,{children:"No"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"integer|nullable"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"0"})}),(0,i.jsx)(n.td,{children:"Execution priority (lower = earlier)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"status"})}),(0,i.jsx)(n.td,{children:"boolean"}),(0,i.jsx)(n.td,{children:"No"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"boolean"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"true"})}),(0,i.jsx)(n.td,{children:"Active status of the binding"})]})]})]}),"\n",(0,i.jsxs)(n.h3,{id:"name-field",children:[(0,i.jsx)(n.code,{children:"name"})," Field"]}),"\n",(0,i.jsx)(n.p,{children:"Unique name identifier for the event-listener binding."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Rules:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"required"}),": Must be provided"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"string"}),": Must be a string"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"max:255"}),": Maximum 255 characters"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"unique:events,name"}),": Must be unique in the events table"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Examples:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"'name' => 'user.created'\n'name' => 'order.completed'\n'name' => 'notification.send'\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Validation Errors:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "name": [\n        "The name field is required.",\n        "The name has already been taken."\n    ]\n}\n'})}),"\n",(0,i.jsxs)(n.h3,{id:"description-field",children:[(0,i.jsx)(n.code,{children:"description"})," Field"]}),"\n",(0,i.jsx)(n.p,{children:"Optional description for the event binding."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Rules:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"string"}),": Must be a string if provided"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"nullable"}),": Can be null or omitted"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Examples:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"'description' => 'Send welcome email when user registers'\n'description' => null\n'description' => '' // Normalized to null\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"event-field",children:[(0,i.jsx)(n.code,{children:"event"})," Field"]}),"\n",(0,i.jsx)(n.p,{children:"Fully qualified class name of the event."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Rules:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"required"}),": Must be provided"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"string"}),": Must be a string"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ClassExistRule"}),": Class must exist and be loadable"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Examples:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"'event' => 'App\\Events\\UserCreated'\n'event' => App\\Events\\OrderCompleted::class\n'event' => 'JobMetric\\EventSystem\\Events\\EventSystemStoredEvent'\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Validation Errors:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "event": [\n        "The event field is required.",\n        "The event class does not exist."\n    ]\n}\n'})}),"\n",(0,i.jsxs)(n.h3,{id:"listener-field",children:[(0,i.jsx)(n.code,{children:"listener"})," Field"]}),"\n",(0,i.jsx)(n.p,{children:"Fully qualified class name of the listener."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Rules:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"required"}),": Must be provided"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"string"}),": Must be a string"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ClassExistRule"}),": Class must exist and be loadable"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Examples:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"'listener' => 'App\\Listeners\\SendWelcomeEmail'\n'listener' => App\\Listeners\\ProcessOrder::class\n'listener' => 'App\\Listeners\\NotifyAdmin'\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Validation Errors:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "listener": [\n        "The listener field is required.",\n        "The listener class does not exist."\n    ]\n}\n'})}),"\n",(0,i.jsxs)(n.h3,{id:"priority-field",children:[(0,i.jsx)(n.code,{children:"priority"})," Field"]}),"\n",(0,i.jsx)(n.p,{children:"Execution priority of the listener. Lower values execute earlier."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Rules:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"integer"}),": Must be an integer if provided"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"nullable"}),": Can be null or omitted"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Default:"})," ",(0,i.jsx)(n.code,{children:"0"})," (set by ",(0,i.jsx)(n.code,{children:"normalize()"}),")"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Examples:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"'priority' => 10  // Executes after priority 0-9\n'priority' => 0   // Executes first\n'priority' => null // Normalized to 0\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Priority Behavior:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Lower priority values execute ",(0,i.jsx)(n.strong,{children:"earlier"})]}),"\n",(0,i.jsxs)(n.li,{children:["Higher priority values execute ",(0,i.jsx)(n.strong,{children:"later"})]}),"\n",(0,i.jsxs)(n.li,{children:["Default priority is ",(0,i.jsx)(n.code,{children:"0"})]}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"status-field",children:[(0,i.jsx)(n.code,{children:"status"})," Field"]}),"\n",(0,i.jsx)(n.p,{children:"Active status of the event binding."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Rules:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"boolean"}),": Must be true or false"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Default:"})," ",(0,i.jsx)(n.code,{children:"true"})," (if not provided, Laravel may set to false)"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Examples:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"'status' => true  // Active\n'status' => false // Disabled\n"})}),"\n",(0,i.jsx)(n.h2,{id:"data-normalization",children:"Data Normalization"}),"\n",(0,i.jsxs)(n.p,{children:["The request automatically normalizes data through the ",(0,i.jsx)(n.code,{children:"normalize()"})," method:"]}),"\n",(0,i.jsx)(n.h3,{id:"priority-normalization",children:"Priority Normalization"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// If priority is not provided, defaults to 0\n$data['priority'] = $data['priority'] ?? 0;\n\n// Examples:\n['priority' => null] \u2192 ['priority' => 0]\n['priority' => 10] \u2192 ['priority' => 10]\n[] \u2192 ['priority' => 0] // Added\n"})}),"\n",(0,i.jsx)(n.h3,{id:"description-normalization",children:"Description Normalization"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// Empty strings are converted to null\nif (($data['description'] ?? null) === '') {\n    $data['description'] = null;\n}\n\n// Examples:\n['description' => ''] \u2192 ['description' => null]\n['description' => 'Text'] \u2192 ['description' => 'Text']\n['description' => null] \u2192 ['description' => null]\n"})}),"\n",(0,i.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,i.jsx)(n.h3,{id:"example-1-basic-controller-usage",children:"Example 1: Basic Controller Usage"}),"\n",(0,i.jsx)(n.p,{children:"Use in a controller method:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"namespace App\\Http\\Controllers\\Admin;\n\nuse App\\Http\\Controllers\\Controller;\nuse JobMetric\\EventSystem\\Http\\Requests\\StoreEventSystemRequest;\nuse JobMetric\\EventSystem\\Facades\\EventSystem;\n\nclass EventSystemController extends Controller\n{\n    public function store(StoreEventSystemRequest $request)\n    {\n        $response = EventSystem::store($request->validated());\n\n        if ($response->isSuccess()) {\n            return redirect()\n                ->route('admin.events.index')\n                ->with('success', $response->getMessage());\n        }\n\n        return back()\n            ->withErrors($response->getErrors())\n            ->withInput();\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-2-api-controller",children:"Example 2: API Controller"}),"\n",(0,i.jsx)(n.p,{children:"Return JSON responses for API:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"namespace App\\Http\\Controllers\\Api;\n\nuse App\\Http\\Controllers\\Controller;\nuse JobMetric\\EventSystem\\Http\\Requests\\StoreEventSystemRequest;\nuse JobMetric\\EventSystem\\Facades\\EventSystem;\n\nclass EventSystemController extends Controller\n{\n    public function store(StoreEventSystemRequest $request)\n    {\n        $response = EventSystem::store($request->validated());\n\n        if ($response->isSuccess()) {\n            return response()->json([\n                'success' => true,\n                'message' => $response->getMessage(),\n                'data' => $response->getData(),\n            ], 201);\n        }\n\n        return response()->json([\n            'success' => false,\n            'message' => $response->getMessage(),\n            'errors' => $response->getErrors(),\n        ], 422);\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-3-programmatic-usage-with-dto",children:"Example 3: Programmatic Usage with DTO"}),"\n",(0,i.jsx)(n.p,{children:"Convert array to validated DTO:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"use JobMetric\\EventSystem\\Http\\Requests\\StoreEventSystemRequest;\nuse JobMetric\\EventSystem\\Facades\\EventSystem;\n\n// Prepare input data\n$input = [\n    'name' => 'user.created',\n    'description' => 'Send welcome email when user registers',\n    'event' => App\\Events\\UserCreated::class,\n    'listener' => App\\Listeners\\SendWelcomeEmail::class,\n    'priority' => 10,\n    'status' => true,\n];\n\n// Convert to validated DTO\n$dto = dto($input, StoreEventSystemRequest::class);\n\n// Use validated data\n$response = EventSystem::store($dto);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-4-batch-creation",children:"Example 4: Batch Creation"}),"\n",(0,i.jsx)(n.p,{children:"Create multiple event bindings:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"use JobMetric\\EventSystem\\Http\\Requests\\StoreEventSystemRequest;\nuse JobMetric\\EventSystem\\Facades\\EventSystem;\n\n$bindings = [\n    [\n        'name' => 'user.created',\n        'event' => App\\Events\\UserCreated::class,\n        'listener' => App\\Listeners\\SendWelcomeEmail::class,\n    ],\n    [\n        'name' => 'order.completed',\n        'event' => App\\Events\\OrderCompleted::class,\n        'listener' => App\\Listeners\\SendOrderConfirmation::class,\n        'priority' => 5,\n    ],\n];\n\nforeach ($bindings as $binding) {\n    $dto = dto($binding, StoreEventSystemRequest::class);\n    EventSystem::store($dto);\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-5-custom-authorization",children:"Example 5: Custom Authorization"}),"\n",(0,i.jsx)(n.p,{children:"Override authorization:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"namespace App\\Http\\Requests;\n\nuse JobMetric\\EventSystem\\Http\\Requests\\StoreEventSystemRequest as BaseRequest;\n\nclass StoreEventSystemRequest extends BaseRequest\n{\n    public function authorize(): bool\n    {\n        // Only admins can create event bindings\n        return $this->user()->hasRole('admin');\n    }\n\n    public function rules(): array\n    {\n        $rules = parent::rules();\n\n        // Add custom validation\n        $rules['name'] = array_merge(\n            explode('|', $rules['name']),\n            ['regex:/^[a-z0-9._-]+$/']\n        );\n\n        return $rules;\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-6-conditional-validation",children:"Example 6: Conditional Validation"}),"\n",(0,i.jsx)(n.p,{children:"Add conditional rules:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"namespace App\\Http\\Requests;\n\nuse JobMetric\\EventSystem\\Http\\Requests\\StoreEventSystemRequest as BaseRequest;\nuse Illuminate\\Validation\\Rule;\n\nclass StoreEventSystemRequest extends BaseRequest\n{\n    public function rules(): array\n    {\n        $rules = parent::rules();\n\n        // Add conditional validation based on user role\n        if ($this->user()->hasRole('admin')) {\n            $rules['priority'] = array_merge(\n                explode('|', $rules['priority']),\n                ['max:100']\n            );\n        }\n\n        return $rules;\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-7-custom-error-messages",children:"Example 7: Custom Error Messages"}),"\n",(0,i.jsx)(n.p,{children:"Override error messages:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"namespace App\\Http\\Requests;\n\nuse JobMetric\\EventSystem\\Http\\Requests\\StoreEventSystemRequest as BaseRequest;\n\nclass StoreEventSystemRequest extends BaseRequest\n{\n    public function messages(): array\n    {\n        return [\n            'name.required' => 'The event binding name is required.',\n            'name.unique' => 'This event binding name is already in use.',\n            'event.required' => 'You must specify an event class.',\n            'listener.required' => 'You must specify a listener class.',\n            'event' => 'The event class does not exist or cannot be loaded.',\n            'listener' => 'The listener class does not exist or cannot be loaded.',\n        ];\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-8-integration-with-event-system-service",children:"Example 8: Integration with Event System Service"}),"\n",(0,i.jsx)(n.p,{children:"Complete integration example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"namespace App\\Services;\n\nuse JobMetric\\EventSystem\\Facades\\EventSystem;\nuse JobMetric\\EventSystem\\Http\\Requests\\StoreEventSystemRequest;\n\nclass EventBindingService\n{\n    public function createBinding(array $data): array\n    {\n        // Validate and normalize\n        $dto = dto($data, StoreEventSystemRequest::class);\n\n        // Store binding\n        $response = EventSystem::store($dto);\n\n        if ($response->isSuccess()) {\n            return [\n                'success' => true,\n                'message' => $response->getMessage(),\n                'data' => $response->getData()->toArray(),\n            ];\n        }\n\n        return [\n            'success' => false,\n            'message' => $response->getMessage(),\n            'errors' => $response->getErrors(),\n        ];\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"validation-flow",children:"Validation Flow"}),"\n",(0,i.jsx)(n.h3,{id:"http-request-flow",children:"HTTP Request Flow"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// 1. Request arrives at controller\npublic function store(StoreEventSystemRequest $request)\n\n// 2. Laravel calls authorize()\n$request->authorize(); // Returns true by default\n\n// 3. Laravel calls prepareForValidation()\n$request->prepareForValidation(); // Normalizes data\n\n// 4. Laravel validates using rules()\n$request->rules(); // Returns validation rules\n\n// 5. If validation passes, returns validated data\n$request->validated(); // Returns normalized, validated array\n\n// 6. If validation fails, redirects back with errors\n"})}),"\n",(0,i.jsx)(n.h3,{id:"programmatic-flow",children:"Programmatic Flow"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// 1. Prepare input data\n$input = ['name' => 'user.created', ...];\n\n// 2. Normalize data (optional, but recommended)\n$normalized = StoreEventSystemRequest::normalize($input);\n\n// 3. Convert to DTO (validates automatically)\n$dto = dto($normalized, StoreEventSystemRequest::class);\n\n// 4. Use validated DTO\nEventSystem::store($dto);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,i.jsx)(n.h3,{id:"validation-errors",children:"Validation Errors"}),"\n",(0,i.jsx)(n.p,{children:"When validation fails, the request returns errors:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "errors": {\n        "name": [\n            "The name field is required."\n        ],\n        "event": [\n            "The event field is required.",\n            "The event class does not exist."\n        ],\n        "listener": [\n            "The listener class does not exist."\n        ]\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"handling-in-controller",children:"Handling in Controller"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"public function store(StoreEventSystemRequest $request)\n{\n    // If we reach here, validation passed\n    $validated = $request->validated();\n    \n    // Use validated data\n    $response = EventSystem::store($validated);\n    \n    return response()->json($response);\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"handling-validation-failures",children:"Handling Validation Failures"}),"\n",(0,i.jsx)(n.p,{children:"Laravel automatically handles validation failures:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// If validation fails, Laravel:\n// 1. Redirects back (for web requests)\n// 2. Returns 422 JSON response (for API requests)\n// 3. Includes validation errors in response\n"})}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsx)(n.h3,{id:"1-always-use-type-hints",children:"1. Always Use Type Hints"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// Good\npublic function store(StoreEventSystemRequest $request)\n\n// Avoid\npublic function store(Request $request)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"2-use-dto-for-programmatic-usage",children:"2. Use DTO for Programmatic Usage"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// Good: Normalize and validate\n$dto = dto($input, StoreEventSystemRequest::class);\n\n// Avoid: Direct array usage\nEventSystem::store($input); // May fail validation\n"})}),"\n",(0,i.jsx)(n.h3,{id:"3-override-authorization",children:"3. Override Authorization"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// Good: Check permissions\npublic function authorize(): bool\n{\n    return $this->user()->can('create', Event::class);\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"4-provide-custom-messages",children:"4. Provide Custom Messages"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// Good: User-friendly messages\npublic function messages(): array\n{\n    return [\n        'name.unique' => 'This event binding name is already in use.',\n    ];\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"5-use-class-constants",children:"5. Use Class Constants"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// Good: Use class constants\n'event' => App\\Events\\UserCreated::class\n\n// Avoid: String literals\n'event' => 'App\\Events\\UserCreated'\n"})}),"\n",(0,i.jsx)(n.h2,{id:"common-mistakes",children:"Common Mistakes"}),"\n",(0,i.jsx)(n.h3,{id:"mistake-1-not-using-dto-for-programmatic-usage",children:"Mistake 1: Not Using DTO for Programmatic Usage"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// Bad: Direct array usage\nEventSystem::store($input);\n\n// Good: Validate first\n$dto = dto($input, StoreEventSystemRequest::class);\nEventSystem::store($dto);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"mistake-2-forgetting-authorization",children:"Mistake 2: Forgetting Authorization"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// Bad: No authorization check\npublic function authorize(): bool\n{\n    return true; // Allows anyone\n}\n\n// Good: Check permissions\npublic function authorize(): bool\n{\n    return $this->user()->can('create', Event::class);\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"mistake-3-not-handling-normalization",children:"Mistake 3: Not Handling Normalization"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// Bad: May have empty strings\n$input = ['description' => ''];\n\n// Good: Normalize first\n$normalized = StoreEventSystemRequest::normalize($input);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"mistake-4-using-wrong-class-names",children:"Mistake 4: Using Wrong Class Names"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// Bad: Typo in class name\n'event' => 'App\\Events\\UserCreatd' // Missing 'e'\n\n// Good: Use class constants\n'event' => App\\Events\\UserCreated::class\n"})}),"\n",(0,i.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(l.A,{to:"/packages/laravel-event-system/deep-diving/event-system",children:"EventSystem"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(l.A,{to:"/packages/laravel-event-system/deep-diving/class-exist-rule",children:"ClassExistRule"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(l.A,{to:"/packages/laravel-event-system/deep-diving/event-system-resource",children:"EventSystemResource"}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}}}]);