"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[2810],{4517(e,t,a){a.r(t),a.d(t,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"laravel-metadata/deep-diving/events/metadata-events","title":"Metadata Events","description":"Laravel Metadata fires events during metadata operations, allowing you to hook into the metadata lifecycle for custom logic, logging, or notifications.","source":"@site/packages/laravel-metadata/deep-diving/events/metadata-events.md","sourceDirName":"laravel-metadata/deep-diving/events","slug":"/laravel-metadata/deep-diving/events/metadata-events","permalink":"/packages/laravel-metadata/deep-diving/events/metadata-events","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-metadata/deep-diving/events/metadata-events.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"sidebar_label":"Metadata Events"},"sidebar":"packagesSidebar","previous":{"title":"ModelMetaableKeyNotAllowedFieldException","permalink":"/packages/laravel-metadata/deep-diving/exceptions/model-metaable-key-not-allowed-field-exception"},"next":{"title":"MetadataValueExistRule","permalink":"/packages/laravel-metadata/deep-diving/rules/metadata-value-exist-rule"}}');var d=a(4848),s=a(8453),i=a(8774);const l={sidebar_position:1,sidebar_label:"Metadata Events"},r="Metadata Events",o={},c=[{value:"Available Events",id:"available-events",level:2},{value:"Event Classes",id:"event-classes",level:2},{value:"MetadataStoringEvent",id:"metadatastoringevent",level:3},{value:"MetadataStoredEvent",id:"metadatastoredevent",level:3},{value:"MetadataDeletingEvent",id:"metadatadeletingevent",level:3},{value:"MetadataDeletedEvent",id:"metadatadeletedevent",level:3},{value:"Registering Event Listeners",id:"registering-event-listeners",level:2},{value:"In EventServiceProvider",id:"in-eventserviceprovider",level:3},{value:"Using Event System",id:"using-event-system",level:3},{value:"Example Listeners",id:"example-listeners",level:2},{value:"Log Metadata Operations",id:"log-metadata-operations",level:3},{value:"Update Search Index",id:"update-search-index",level:3},{value:"Send Notifications",id:"send-notifications",level:3},{value:"Related Documentation",id:"related-documentation",level:2}];function v(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(t.header,{children:(0,d.jsx)(t.h1,{id:"metadata-events",children:"Metadata Events"})}),"\n",(0,d.jsx)(t.p,{children:"Laravel Metadata fires events during metadata operations, allowing you to hook into the metadata lifecycle for custom logic, logging, or notifications."}),"\n",(0,d.jsx)(t.h2,{id:"available-events",children:"Available Events"}),"\n",(0,d.jsxs)(t.table,{children:[(0,d.jsx)(t.thead,{children:(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.th,{children:"Event"}),(0,d.jsx)(t.th,{children:"Description"}),(0,d.jsx)(t.th,{children:"Fired When"})]})}),(0,d.jsxs)(t.tbody,{children:[(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"MetadataStoringEvent"})}),(0,d.jsx)(t.td,{children:"Before metadata is stored"}),(0,d.jsxs)(t.td,{children:["Before ",(0,d.jsx)(t.code,{children:"storeMetadata()"})," or ",(0,d.jsx)(t.code,{children:"storeMetadataBatch()"})," saves to database"]})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"MetadataStoredEvent"})}),(0,d.jsx)(t.td,{children:"After metadata is stored"}),(0,d.jsx)(t.td,{children:"After metadata is successfully saved"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"MetadataDeletingEvent"})}),(0,d.jsx)(t.td,{children:"Before metadata is deleted"}),(0,d.jsxs)(t.td,{children:["Before ",(0,d.jsx)(t.code,{children:"forgetMetadata()"})," deletes from database"]})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"MetadataDeletedEvent"})}),(0,d.jsx)(t.td,{children:"After metadata is deleted"}),(0,d.jsx)(t.td,{children:"After metadata is successfully deleted"})]})]})]}),"\n",(0,d.jsx)(t.h2,{id:"event-classes",children:"Event Classes"}),"\n",(0,d.jsx)(t.h3,{id:"metadatastoringevent",children:"MetadataStoringEvent"}),"\n",(0,d.jsx)(t.p,{children:"Fired before storing metadata."}),"\n",(0,d.jsx)(t.pre,{children:(0,d.jsx)(t.code,{className:"language-php",children:"use JobMetric\\Metadata\\Events\\MetadataStoringEvent;\n\n// Event properties:\n// - $model: The model instance\n// - $key: The metadata key\n// - $value: The metadata value\n"})}),"\n",(0,d.jsx)(t.h3,{id:"metadatastoredevent",children:"MetadataStoredEvent"}),"\n",(0,d.jsx)(t.p,{children:"Fired after storing metadata."}),"\n",(0,d.jsx)(t.pre,{children:(0,d.jsx)(t.code,{className:"language-php",children:"use JobMetric\\Metadata\\Events\\MetadataStoredEvent;\n\n// Event properties:\n// - $model: The model instance\n// - $meta: The Meta model instance that was created/updated\n"})}),"\n",(0,d.jsx)(t.h3,{id:"metadatadeletingevent",children:"MetadataDeletingEvent"}),"\n",(0,d.jsx)(t.p,{children:"Fired before deleting metadata."}),"\n",(0,d.jsx)(t.pre,{children:(0,d.jsx)(t.code,{className:"language-php",children:"use JobMetric\\Metadata\\Events\\MetadataDeletingEvent;\n\n// Event properties:\n// - $meta: The Meta model instance being deleted\n"})}),"\n",(0,d.jsx)(t.h3,{id:"metadatadeletedevent",children:"MetadataDeletedEvent"}),"\n",(0,d.jsx)(t.p,{children:"Fired after deleting metadata."}),"\n",(0,d.jsx)(t.pre,{children:(0,d.jsx)(t.code,{className:"language-php",children:"use JobMetric\\Metadata\\Events\\MetadataDeletedEvent;\n\n// Event properties:\n// - $meta: The Meta model instance that was deleted\n"})}),"\n",(0,d.jsx)(t.h2,{id:"registering-event-listeners",children:"Registering Event Listeners"}),"\n",(0,d.jsx)(t.h3,{id:"in-eventserviceprovider",children:"In EventServiceProvider"}),"\n",(0,d.jsx)(t.pre,{children:(0,d.jsx)(t.code,{className:"language-php",children:"namespace App\\Providers;\n\nuse Illuminate\\Foundation\\Support\\Providers\\EventServiceProvider as ServiceProvider;\nuse JobMetric\\Metadata\\Events\\MetadataStoredEvent;\nuse JobMetric\\Metadata\\Events\\MetadataDeletedEvent;\n\nclass EventServiceProvider extends ServiceProvider\n{\n    protected $listen = [\n        MetadataStoredEvent::class => [\n            \\App\\Listeners\\LogMetadataStored::class,\n        ],\n        MetadataDeletedEvent::class => [\n            \\App\\Listeners\\LogMetadataDeleted::class,\n        ],\n    ];\n}\n"})}),"\n",(0,d.jsx)(t.h3,{id:"using-event-system",children:"Using Event System"}),"\n",(0,d.jsx)(t.p,{children:"Since Laravel Metadata integrates with Laravel Event System, you can also register listeners dynamically:"}),"\n",(0,d.jsx)(t.pre,{children:(0,d.jsx)(t.code,{className:"language-php",children:"use JobMetric\\EventSystem\\Facades\\EventSystem;\n\naddEventSystem(\n    'metadata.stored',\n    \\JobMetric\\Metadata\\Events\\MetadataStoredEvent::class,\n    \\App\\Listeners\\LogMetadataStored::class\n);\n"})}),"\n",(0,d.jsx)(t.h2,{id:"example-listeners",children:"Example Listeners"}),"\n",(0,d.jsx)(t.h3,{id:"log-metadata-operations",children:"Log Metadata Operations"}),"\n",(0,d.jsx)(t.pre,{children:(0,d.jsx)(t.code,{className:"language-php",children:"namespace App\\Listeners;\n\nuse JobMetric\\Metadata\\Events\\MetadataStoredEvent;\nuse Illuminate\\Support\\Facades\\Log;\n\nclass LogMetadataStored\n{\n    public function handle(MetadataStoredEvent $event): void\n    {\n        Log::info('Metadata stored', [\n            'model' => get_class($event->model),\n            'model_id' => $event->model->id,\n            'key' => $event->meta->key,\n            'value' => $event->meta->value,\n        ]);\n    }\n}\n"})}),"\n",(0,d.jsx)(t.h3,{id:"update-search-index",children:"Update Search Index"}),"\n",(0,d.jsx)(t.pre,{children:(0,d.jsx)(t.code,{className:"language-php",children:"namespace App\\Listeners;\n\nuse JobMetric\\Metadata\\Events\\MetadataStoredEvent;\n\nclass UpdateSearchIndex\n{\n    public function handle(MetadataStoredEvent $event): void\n    {\n        // Update search index when metadata changes\n        if (in_array($event->meta->key, ['title', 'description', 'tags'])) {\n            // Re-index the model\n            SearchService::index($event->model);\n        }\n    }\n}\n"})}),"\n",(0,d.jsx)(t.h3,{id:"send-notifications",children:"Send Notifications"}),"\n",(0,d.jsx)(t.pre,{children:(0,d.jsx)(t.code,{className:"language-php",children:"namespace App\\Listeners;\n\nuse JobMetric\\Metadata\\Events\\MetadataStoredEvent;\nuse App\\Notifications\\MetadataChanged;\n\nclass NotifyMetadataChange\n{\n    public function handle(MetadataStoredEvent $event): void\n    {\n        if ($event->meta->key === 'status' && $event->meta->value === 'published') {\n            $event->model->user->notify(new MetadataChanged($event->model, $event->meta));\n        }\n    }\n}\n"})}),"\n",(0,d.jsx)(t.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,d.jsxs)(t.ul,{children:["\n",(0,d.jsxs)(t.li,{children:["\n",(0,d.jsx)(i.A,{to:"/packages/laravel-metadata/deep-diving/has-meta",children:"HasMeta Trait"}),"\n"]}),"\n",(0,d.jsxs)(t.li,{children:["\n",(0,d.jsx)(i.A,{to:"/packages/laravel-event-system/deep-diving/event-system",children:"Event System"}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,d.jsx)(t,{...e,children:(0,d.jsx)(v,{...e})}):v(e)}},8453(e,t,a){a.d(t,{R:()=>i,x:()=>l});var n=a(6540);const d={},s=n.createContext(d);function i(e){const t=n.useContext(s);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:i(e.components),n.createElement(s.Provider,{value:t},e.children)}}}]);