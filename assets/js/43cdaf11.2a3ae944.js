"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[2230],{20778(e,n,t){t.r(n),t.d(n,{assets:()=>v,contentTitle:()=>a,default:()=>m,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"laravel-event-system/deep-diving/events","title":"Events","description":"Laravel Event System provides a comprehensive event system that fires domain events for all CRUD operations on event-listener bindings. These events allow you to hook into the event system lifecycle and perform additional actions when bindings are created or deleted.","source":"@site/packages/laravel-event-system/deep-diving/events.md","sourceDirName":"laravel-event-system/deep-diving","slug":"/laravel-event-system/deep-diving/events","permalink":"/packages/laravel-event-system/deep-diving/events","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-event-system/deep-diving/events.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"sidebar_label":"Events"},"sidebar":"packagesSidebar","previous":{"title":"DomainEvent","permalink":"/packages/laravel-event-system/deep-diving/domain-event"},"next":{"title":"StoreEventSystemRequest","permalink":"/packages/laravel-event-system/deep-diving/store-event-system-request"}}');var i=t(74848),l=t(28453),d=t(28774);const r={sidebar_position:5,sidebar_label:"Events"},a="Events",v={},c=[{value:"Overview",id:"overview",level:2},{value:"Event Structure",id:"event-structure",level:2},{value:"Base Event Structure",id:"base-event-structure",level:3},{value:"Available Events",id:"available-events",level:2},{value:"Event System Events",id:"event-system-events",level:3},{value:"Listening to Events",id:"listening-to-events",level:2},{value:"Method 1: Event Listeners in Service Provider",id:"method-1-event-listeners-in-service-provider",level:3},{value:"Method 2: Using Event Facade",id:"method-2-using-event-facade",level:3},{value:"Method 3: Using Event Subscribers",id:"method-3-using-event-subscribers",level:3},{value:"Complete Examples",id:"complete-examples",level:2},{value:"Example 1: Cache Invalidation on Event System Changes",id:"example-1-cache-invalidation-on-event-system-changes",level:3},{value:"Example 2: Audit Logging",id:"example-2-audit-logging",level:3},{value:"Example 3: Notification System",id:"example-3-notification-system",level:3},{value:"Example 4: Analytics Tracking",id:"example-4-analytics-tracking",level:3},{value:"Example 5: Validation and Business Rules",id:"example-5-validation-and-business-rules",level:3},{value:"Example 6: Synchronization with External Systems",id:"example-6-synchronization-with-external-systems",level:3},{value:"Example 7: Real-time Updates",id:"example-7-real-time-updates",level:3},{value:"Example 8: Complete Event Listener Setup",id:"example-8-complete-event-listener-setup",level:3},{value:"Event Timing",id:"event-timing",level:2},{value:"EventSystemStoredEvent",id:"eventsystemstoredevent",level:3},{value:"EventSystemDeletingEvent / EventSystemDeletedEvent",id:"eventsystemdeletingevent--eventsystemdeletedevent",level:3},{value:"Queued Events",id:"queued-events",level:2},{value:"Event Payload Details",id:"event-payload-details",level:2},{value:"EventSystemStoredEvent",id:"eventsystemstoredevent-1",level:3},{value:"EventSystemDeletingEvent / EventSystemDeletedEvent",id:"eventsystemdeletingevent--eventsystemdeletedevent-1",level:3},{value:"When to Use Events",id:"when-to-use-events",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"events",children:"Events"})}),"\n",(0,i.jsx)(n.p,{children:"Laravel Event System provides a comprehensive event system that fires domain events for all CRUD operations on event-listener bindings. These events allow you to hook into the event system lifecycle and perform additional actions when bindings are created or deleted."}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"The event system in Laravel Event System:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Fires automatically"})," during CRUD operations"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Provides model instances"})," in event payloads"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Uses DomainEvent interface"})," for consistency"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Supports event listeners"})," for custom logic"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Enables event-driven architecture"})," for event binding management"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"event-structure",children:"Event Structure"}),"\n",(0,i.jsx)(n.p,{children:"All events in Laravel Event System:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Implement ",(0,i.jsx)(n.code,{children:"JobMetric\\EventSystem\\Contracts\\DomainEvent"})]}),"\n",(0,i.jsxs)(n.li,{children:["Are ",(0,i.jsx)(n.code,{children:"readonly"})," classes for immutability"]}),"\n",(0,i.jsx)(n.li,{children:"Contain the affected Event model instance"}),"\n",(0,i.jsxs)(n.li,{children:["Provide a stable ",(0,i.jsx)(n.code,{children:"key()"})," method"]}),"\n",(0,i.jsxs)(n.li,{children:["Include metadata via ",(0,i.jsx)(n.code,{children:"definition()"})," method"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"base-event-structure",children:"Base Event Structure"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"readonly class EventSystemStoredEvent implements DomainEvent\n{\n    public function __construct(\n        public Event $event,\n        public array $data\n    ) {}\n\n    public static function key(): string\n    {\n        return 'event_system.stored';\n    }\n\n    public static function definition(): DomainEventDefinition\n    {\n        return new DomainEventDefinition(\n            self::key(),\n            'event-system::base.events.event_system_stored.group',\n            'event-system::base.events.event_system_stored.title',\n            'event-system::base.events.event_system_stored.description',\n            'fas fa-save',\n            ['event system', 'storage', 'management']\n        );\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"available-events",children:"Available Events"}),"\n",(0,i.jsx)(n.h3,{id:"event-system-events",children:"Event System Events"}),"\n",(0,i.jsx)(n.p,{children:"Events fired for Event System CRUD operations."}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Event Class"}),(0,i.jsx)(n.th,{children:"Event Key"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Payload"}),(0,i.jsx)(n.th,{children:"Triggered When"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"EventSystemStoredEvent"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"event_system.stored"})}),(0,i.jsx)(n.td,{children:"Fired when a new event-listener binding is created"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Event $event, array $data"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"EventSystem::store()"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"EventSystemDeletingEvent"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"event_system.deleting"})}),(0,i.jsx)(n.td,{children:"Fired before an event-listener binding is deleted"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Event $event"})}),(0,i.jsxs)(n.td,{children:["Before ",(0,i.jsx)(n.code,{children:"EventSystem::delete()"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"EventSystemDeletedEvent"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"event_system.deleted"})}),(0,i.jsx)(n.td,{children:"Fired after an event-listener binding is deleted"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Event $event"})}),(0,i.jsxs)(n.td,{children:["After ",(0,i.jsx)(n.code,{children:"EventSystem::delete()"})]})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Namespace:"})," ",(0,i.jsx)(n.code,{children:"JobMetric\\EventSystem\\Events\\*"})]}),"\n",(0,i.jsx)(n.h2,{id:"listening-to-events",children:"Listening to Events"}),"\n",(0,i.jsx)(n.h3,{id:"method-1-event-listeners-in-service-provider",children:"Method 1: Event Listeners in Service Provider"}),"\n",(0,i.jsx)(n.p,{children:"Register event listeners in a service provider:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"namespace App\\Providers;\n\nuse Illuminate\\Foundation\\Support\\Providers\\EventServiceProvider as ServiceProvider;\nuse JobMetric\\EventSystem\\Events\\EventSystemStoredEvent;\nuse JobMetric\\EventSystem\\Events\\EventSystemDeletedEvent;\n\nclass EventServiceProvider extends ServiceProvider\n{\n    protected $listen = [\n        EventSystemStoredEvent::class => [\n            \\App\\Listeners\\EventSystem\\LogEventSystemStored::class,\n            \\App\\Listeners\\EventSystem\\InvalidateEventSystemCache::class,\n            \\App\\Listeners\\EventSystem\\NotifyEventSystemStored::class,\n        ],\n        EventSystemDeletedEvent::class => [\n            \\App\\Listeners\\EventSystem\\LogEventSystemDeleted::class,\n            \\App\\Listeners\\EventSystem\\InvalidateEventSystemCache::class,\n        ],\n    ];\n\n    public function boot(): void\n    {\n        parent::boot();\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"method-2-using-event-facade",children:"Method 2: Using Event Facade"}),"\n",(0,i.jsx)(n.p,{children:"Listen to events using the Event facade:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"use Illuminate\\Support\\Facades\\Event;\nuse JobMetric\\EventSystem\\Events\\EventSystemStoredEvent;\n\nEvent::listen(EventSystemStoredEvent::class, function (EventSystemStoredEvent $event) {\n    $eventModel = $event->event;\n    $data = $event->data;\n    \n    // Perform actions\n    Log::info('Event system entry created', [\n        'name' => $eventModel->name,\n        'event' => $eventModel->event,\n        'listener' => $eventModel->listener,\n        'priority' => $eventModel->priority,\n    ]);\n    \n    Cache::forget('events');\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"method-3-using-event-subscribers",children:"Method 3: Using Event Subscribers"}),"\n",(0,i.jsx)(n.p,{children:"Create event subscribers for multiple events:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"namespace App\\Listeners;\n\nuse Illuminate\\Events\\Dispatcher;\nuse JobMetric\\EventSystem\\Events\\EventSystemStoredEvent;\nuse JobMetric\\EventSystem\\Events\\EventSystemDeletedEvent;\n\nclass EventSystemEventSubscriber\n{\n    public function handleEventSystemStored(EventSystemStoredEvent $event): void\n    {\n        $eventModel = $event->event;\n        \n        Log::info('Event system entry created', [\n            'name' => $eventModel->name,\n            'event' => $eventModel->event,\n            'listener' => $eventModel->listener,\n        ]);\n    }\n\n    public function handleEventSystemDeleted(EventSystemDeletedEvent $event): void\n    {\n        $eventModel = $event->event;\n        \n        Log::warning('Event system entry deleted', [\n            'name' => $eventModel->name,\n            'id' => $eventModel->id,\n        ]);\n    }\n\n    public function subscribe(Dispatcher $events): void\n    {\n        $events->listen(\n            EventSystemStoredEvent::class,\n            [EventSystemEventSubscriber::class, 'handleEventSystemStored']\n        );\n\n        $events->listen(\n            EventSystemDeletedEvent::class,\n            [EventSystemEventSubscriber::class, 'handleEventSystemDeleted']\n        );\n    }\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"Register the subscriber:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"namespace App\\Providers;\n\nuse App\\Listeners\\EventSystemEventSubscriber;\nuse Illuminate\\Foundation\\Support\\Providers\\EventServiceProvider as ServiceProvider;\n\nclass EventServiceProvider extends ServiceProvider\n{\n    protected $subscribe = [\n        EventSystemEventSubscriber::class,\n    ];\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"complete-examples",children:"Complete Examples"}),"\n",(0,i.jsx)(n.h3,{id:"example-1-cache-invalidation-on-event-system-changes",children:"Example 1: Cache Invalidation on Event System Changes"}),"\n",(0,i.jsx)(n.p,{children:"Invalidate cache when event bindings are modified:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"namespace App\\Listeners\\EventSystem;\n\nuse Illuminate\\Support\\Facades\\Cache;\nuse JobMetric\\EventSystem\\Events\\EventSystemStoredEvent;\nuse JobMetric\\EventSystem\\Events\\EventSystemDeletedEvent;\n\nclass InvalidateEventSystemCache\n{\n    public function handle(EventSystemStoredEvent|EventSystemDeletedEvent $event): void\n    {\n        $eventModel = $event->event;\n\n        // Invalidate specific event cache\n        Cache::forget(\"event_system_{$eventModel->id}\");\n        Cache::forget(\"event_system_name_{$eventModel->name}\");\n        \n        // Invalidate all events cache\n        Cache::forget('events');\n        Cache::forget('event_system_all');\n\n        // Clear tagged cache\n        Cache::tags(['event_system'])->flush();\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-2-audit-logging",children:"Example 2: Audit Logging"}),"\n",(0,i.jsx)(n.p,{children:"Log all event system operations for audit trail:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"namespace App\\Listeners\\EventSystem;\n\nuse App\\Models\\AuditLog;\nuse Illuminate\\Support\\Facades\\Auth;\nuse JobMetric\\EventSystem\\Events\\EventSystemStoredEvent;\nuse JobMetric\\EventSystem\\Events\\EventSystemDeletedEvent;\n\nclass AuditEventSystemOperations\n{\n    public function handleEventSystemStored(EventSystemStoredEvent $event): void\n    {\n        $this->logAudit('stored', $event->event, $event->data);\n    }\n\n    public function handleEventSystemDeleted(EventSystemDeletedEvent $event): void\n    {\n        $this->logAudit('deleted', $event->event);\n    }\n\n    protected function logAudit(string $action, $eventModel, ?array $data = null): void\n    {\n        AuditLog::create([\n            'user_id' => Auth::id(),\n            'action' => \"event_system.{$action}\",\n            'model_type' => get_class($eventModel),\n            'model_id' => $eventModel->id,\n            'data' => [\n                'name' => $eventModel->name,\n                'event' => $eventModel->event,\n                'listener' => $eventModel->listener,\n                'priority' => $eventModel->priority,\n                'status' => $eventModel->status,\n                'input_data' => $data,\n            ],\n            'ip_address' => request()->ip(),\n        ]);\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-3-notification-system",children:"Example 3: Notification System"}),"\n",(0,i.jsx)(n.p,{children:"Send notifications when critical event bindings are registered:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"namespace App\\Listeners\\EventSystem;\n\nuse App\\Notifications\\CriticalEventBindingRegistered;\nuse Illuminate\\Support\\Facades\\Notification;\nuse JobMetric\\EventSystem\\Events\\EventSystemStoredEvent;\n\nclass NotifyEventSystemChanges\n{\n    protected array $criticalEvents = ['user.created', 'order.completed', 'payment.processed'];\n\n    public function handle(EventSystemStoredEvent $event): void\n    {\n        $eventModel = $event->event;\n\n        // Notify for critical events\n        if (in_array($eventModel->name, $this->criticalEvents)) {\n            $admins = User::whereHas('roles', function ($query) {\n                $query->where('name', 'admin');\n            })->get();\n\n            Notification::send($admins, new CriticalEventBindingRegistered($eventModel));\n        }\n\n        // Notify via Slack\n        if (config('services.slack.webhook')) {\n            Notification::route('slack', config('services.slack.webhook'))\n                ->notify(new CriticalEventBindingRegistered($eventModel));\n        }\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-4-analytics-tracking",children:"Example 4: Analytics Tracking"}),"\n",(0,i.jsx)(n.p,{children:"Track event system changes for analytics:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"namespace App\\Listeners\\EventSystem;\n\nuse App\\Services\\AnalyticsService;\nuse JobMetric\\EventSystem\\Events\\EventSystemStoredEvent;\nuse JobMetric\\EventSystem\\Events\\EventSystemDeletedEvent;\n\nclass TrackEventSystemAnalytics\n{\n    public function __construct(\n        protected AnalyticsService $analytics\n    ) {}\n\n    public function handleEventSystemStored(EventSystemStoredEvent $event): void\n    {\n        $eventModel = $event->event;\n        \n        $this->analytics->track('event_system.stored', [\n            'event_id' => $eventModel->id,\n            'name' => $eventModel->name,\n            'event_class' => $eventModel->event,\n            'listener_class' => $eventModel->listener,\n            'priority' => $eventModel->priority,\n            'status' => $eventModel->status,\n        ]);\n    }\n\n    public function handleEventSystemDeleted(EventSystemDeletedEvent $event): void\n    {\n        $eventModel = $event->event;\n        \n        $this->analytics->track('event_system.deleted', [\n            'event_id' => $eventModel->id,\n            'name' => $eventModel->name,\n            'deleted_at' => now(),\n        ]);\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-5-validation-and-business-rules",children:"Example 5: Validation and Business Rules"}),"\n",(0,i.jsx)(n.p,{children:"Validate event bindings before deletion:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"namespace App\\Listeners\\EventSystem;\n\nuse Illuminate\\Validation\\ValidationException;\nuse JobMetric\\EventSystem\\Events\\EventSystemDeletingEvent;\n\nclass ValidateEventSystemDeletion\n{\n    protected array $protectedEvents = ['critical.event.1', 'critical.event.2', 'system.event'];\n\n    public function handle(EventSystemDeletingEvent $event): void\n    {\n        $eventModel = $event->event;\n\n        // Prevent deletion of protected events\n        if (in_array($eventModel->name, $this->protectedEvents)) {\n            throw ValidationException::withMessages([\n                'event' => 'Cannot delete protected event bindings.',\n            ]);\n        }\n\n        // Check if event is in use\n        if ($this->isEventInUse($eventModel)) {\n            throw ValidationException::withMessages([\n                'event' => 'Cannot delete event binding that is currently in use.',\n            ]);\n        }\n    }\n\n    protected function isEventInUse($eventModel): bool\n    {\n        // Check if event is being used in active workflows\n        // Implement your business logic here\n        return false;\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-6-synchronization-with-external-systems",children:"Example 6: Synchronization with External Systems"}),"\n",(0,i.jsx)(n.p,{children:"Synchronize event bindings with external systems:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"namespace App\\Listeners\\EventSystem;\n\nuse App\\Services\\ExternalApiService;\nuse JobMetric\\EventSystem\\Events\\EventSystemStoredEvent;\nuse JobMetric\\EventSystem\\Events\\EventSystemDeletedEvent;\n\nclass SynchronizeEventSystem\n{\n    public function __construct(\n        protected ExternalApiService $externalApi\n    ) {}\n\n    public function handleEventSystemStored(EventSystemStoredEvent $event): void\n    {\n        $eventModel = $event->event;\n        \n        $this->externalApi->syncEventBinding([\n            'name' => $eventModel->name,\n            'event' => $eventModel->event,\n            'listener' => $eventModel->listener,\n            'priority' => $eventModel->priority,\n            'status' => $eventModel->status,\n        ]);\n    }\n\n    public function handleEventSystemDeleted(EventSystemDeletedEvent $event): void\n    {\n        $eventModel = $event->event;\n        \n        $this->externalApi->deleteEventBinding($eventModel->name);\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-7-real-time-updates",children:"Example 7: Real-time Updates"}),"\n",(0,i.jsx)(n.p,{children:"Send real-time updates via WebSockets or broadcasting:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"namespace App\\Listeners\\EventSystem;\n\nuse Illuminate\\Support\\Facades\\Broadcast;\nuse JobMetric\\EventSystem\\Events\\EventSystemStoredEvent;\nuse JobMetric\\EventSystem\\Events\\EventSystemDeletedEvent;\n\nclass BroadcastEventSystemChanges\n{\n    public function handleEventSystemStored(EventSystemStoredEvent $event): void\n    {\n        $eventModel = $event->event;\n        \n        Broadcast::channel('event-system', function () {\n            return true;\n        })->toOthers();\n        \n        event(new EventSystemChanged([\n            'type' => 'stored',\n            'event' => $eventModel,\n        ]));\n    }\n\n    public function handleEventSystemDeleted(EventSystemDeletedEvent $event): void\n    {\n        $eventModel = $event->event;\n        \n        event(new EventSystemChanged([\n            'type' => 'deleted',\n            'event' => $eventModel,\n        ]));\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-8-complete-event-listener-setup",children:"Example 8: Complete Event Listener Setup"}),"\n",(0,i.jsx)(n.p,{children:"Complete setup for all event system events:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"namespace App\\Providers;\n\nuse App\\Listeners\\EventSystem\\AuditEventSystemOperations;\nuse App\\Listeners\\EventSystem\\BroadcastEventSystemChanges;\nuse App\\Listeners\\EventSystem\\InvalidateEventSystemCache;\nuse App\\Listeners\\EventSystem\\NotifyEventSystemChanges;\nuse App\\Listeners\\EventSystem\\TrackEventSystemAnalytics;\nuse App\\Listeners\\EventSystem\\ValidateEventSystemDeletion;\nuse App\\Listeners\\EventSystem\\SynchronizeEventSystem;\nuse Illuminate\\Foundation\\Support\\Providers\\EventServiceProvider as ServiceProvider;\nuse JobMetric\\EventSystem\\Events\\EventSystemStoredEvent;\nuse JobMetric\\EventSystem\\Events\\EventSystemDeletingEvent;\nuse JobMetric\\EventSystem\\Events\\EventSystemDeletedEvent;\n\nclass EventServiceProvider extends ServiceProvider\n{\n    protected $listen = [\n        // After storing\n        EventSystemStoredEvent::class => [\n            AuditEventSystemOperations::class,\n            InvalidateEventSystemCache::class,\n            NotifyEventSystemChanges::class,\n            TrackEventSystemAnalytics::class,\n            BroadcastEventSystemChanges::class,\n            SynchronizeEventSystem::class,\n        ],\n\n        // Before deleting\n        EventSystemDeletingEvent::class => [\n            ValidateEventSystemDeletion::class,\n        ],\n\n        // After deleting\n        EventSystemDeletedEvent::class => [\n            AuditEventSystemOperations::class,\n            InvalidateEventSystemCache::class,\n            TrackEventSystemAnalytics::class,\n            BroadcastEventSystemChanges::class,\n            SynchronizeEventSystem::class,\n        ],\n    ];\n\n    public function boot(): void\n    {\n        parent::boot();\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"event-timing",children:"Event Timing"}),"\n",(0,i.jsx)(n.h3,{id:"eventsystemstoredevent",children:"EventSystemStoredEvent"}),"\n",(0,i.jsxs)(n.p,{children:["Fired ",(0,i.jsx)(n.strong,{children:"after"})," the event binding is saved to database:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// Execution order:\n// 1. Validate input data\n// 2. Create event binding record\n// 3. Save to database\n// 4. Clear cache\n// 5. Fire EventSystemStoredEvent \u2190 Event fired here\n// 6. Return response\n"})}),"\n",(0,i.jsx)(n.h3,{id:"eventsystemdeletingevent--eventsystemdeletedevent",children:"EventSystemDeletingEvent / EventSystemDeletedEvent"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"EventSystemDeletingEvent"}),": Fired ",(0,i.jsx)(n.strong,{children:"before"})," the deletion operation"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"EventSystemDeletedEvent"}),": Fired ",(0,i.jsx)(n.strong,{children:"after"})," the deletion operation completes"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// Execution order:\n// 1. Find event binding by name\n// 2. Fire EventSystemDeletingEvent \u2190 Before deletion\n// 3. Delete event binding record\n// 4. Fire EventSystemDeletedEvent \u2190 After deletion\n// 5. Clear cache\n// 6. Return response\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Important Notes"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The event binding is ",(0,i.jsx)(n.strong,{children:"saved"})," to database before ",(0,i.jsx)(n.code,{children:"EventSystemStoredEvent"})," fires"]}),"\n",(0,i.jsxs)(n.li,{children:["You can access ",(0,i.jsx)(n.strong,{children:"fresh model data"})," in listeners"]}),"\n",(0,i.jsxs)(n.li,{children:["Database transaction is ",(0,i.jsx)(n.strong,{children:"committed"})," before events fire"]}),"\n",(0,i.jsxs)(n.li,{children:["Events are ",(0,i.jsx)(n.strong,{children:"synchronous"})," by default (can be queued)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"EventSystemDeletingEvent"})," allows you to ",(0,i.jsx)(n.strong,{children:"prevent"})," deletion if needed"]}),"\n",(0,i.jsxs)(n.li,{children:["Cache is cleared ",(0,i.jsx)(n.strong,{children:"before"})," events fire"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"queued-events",children:"Queued Events"}),"\n",(0,i.jsx)(n.p,{children:"You can queue events for asynchronous processing:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"namespace App\\Listeners\\EventSystem;\n\nuse Illuminate\\Contracts\\Queue\\ShouldQueue;\nuse JobMetric\\EventSystem\\Events\\EventSystemStoredEvent;\n\nclass ProcessEventSystemAsync implements ShouldQueue\n{\n    public function handle(EventSystemStoredEvent $event): void\n    {\n        $eventModel = $event->event;\n        \n        // Heavy processing that doesn't block the request\n        $this->syncWithExternalService($eventModel);\n        $this->generateAnalyticsReport($eventModel);\n        $this->sendWelcomeNotifications($eventModel);\n    }\n\n    protected function syncWithExternalService($eventModel): void\n    {\n        // Sync with external API\n    }\n\n    protected function generateAnalyticsReport($eventModel): void\n    {\n        // Generate analytics\n    }\n\n    protected function sendWelcomeNotifications($eventModel): void\n    {\n        // Send notifications\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"event-payload-details",children:"Event Payload Details"}),"\n",(0,i.jsx)(n.h3,{id:"eventsystemstoredevent-1",children:"EventSystemStoredEvent"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"readonly class EventSystemStoredEvent implements DomainEvent\n{\n    public function __construct(\n        public Event $event,    // Event model instance (saved to database)\n        public array $data       // Validated input data\n    ) {}\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsxs)(n.strong,{children:["Available Properties on ",(0,i.jsx)(n.code,{children:"$event"})]}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"id"}),": Event binding ID"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"name"}),": Unique name identifier"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"description"}),": Optional description"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"event"}),": Fully qualified event class name"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"listener"}),": Fully qualified listener class name"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"priority"}),": Execution priority"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"status"}),": Active status (boolean)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"created_at"}),": Creation timestamp"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"updated_at"}),": Update timestamp"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsxs)(n.strong,{children:["Available Properties on ",(0,i.jsx)(n.code,{children:"$data"})]}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["All validated input fields from ",(0,i.jsx)(n.code,{children:"StoreEventSystemRequest"})]}),"\n",(0,i.jsx)(n.li,{children:"Normalized values (priority defaults, etc.)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"eventsystemdeletingevent--eventsystemdeletedevent-1",children:"EventSystemDeletingEvent / EventSystemDeletedEvent"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"readonly class EventSystemDeletedEvent implements DomainEvent\n{\n    public function __construct(\n        public Event $event  // Event model instance (deleted)\n    ) {}\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Available Properties"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"$event"}),": Event model instance with all properties (still accessible after deletion)"]}),"\n",(0,i.jsxs)(n.li,{children:["All properties from ",(0,i.jsx)(n.code,{children:"EventSystemStoredEvent"})," are available"]}),"\n",(0,i.jsx)(n.li,{children:"Model is deleted but instance remains accessible"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"when-to-use-events",children:"When to Use Events"}),"\n",(0,i.jsx)(n.p,{children:"Use events when you need to:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Cache Management"}),": Invalidate or update cached event bindings"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Notifications"}),": Send notifications when event bindings change"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Analytics"}),": Track event system operations for analytics"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Audit Logging"}),": Log event binding changes for compliance"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Validation"}),": Validate event bindings before deletion"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Synchronization"}),": Sync event bindings with external systems"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Real-time Updates"}),": Broadcast event binding changes to clients"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Business Rules"}),": Enforce business rules on event operations"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Integration"}),": Integrate with external services"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Side Effects"}),": Perform side effects without coupling"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(d.A,{to:"/packages/laravel-event-system/deep-diving/event-system",children:"EventSystem"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(d.A,{to:"/packages/laravel-event-system/deep-diving/domain-event",children:"DomainEvent"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(d.A,{to:"/packages/laravel-event-system/deep-diving/store-event-system-request",children:"StoreEventSystemRequest"}),"\n"]}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},28453(e,n,t){t.d(n,{R:()=>d,x:()=>r});var s=t(96540);const i={},l=s.createContext(i);function d(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);