"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[6440],{5986(e,t,n){n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"laravel-flow/docs/flow/index","title":"index","description":"Flow","source":"@site/packages/laravel-flow/docs/flow/index.md","sourceDirName":"laravel-flow/docs/flow","slug":"/laravel-flow/docs/flow/","permalink":"/packages/laravel-flow/docs/flow/","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-flow/docs/flow/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"packagesSidebar","previous":{"title":"Showcase","permalink":"/packages/laravel-flow/showcase"},"next":{"title":"index","permalink":"/packages/laravel-flow/docs/flow-asset/"}}');var r=n(4848),l=n(8453);const o={},i=void 0,a={},c=[{value:"Flow",id:"flow",level:2},{value:"Flow Facade",id:"flow-facade",level:2}];function d(e){const t={blockquote:"blockquote",br:"br",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"flow",children:"Flow"}),"\n",(0,r.jsxs)(t.p,{children:["to work with flows in your app you must first create a new ",(0,r.jsx)(t.code,{children:"flow driver"})," with this artisan command:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"php artisan make:flow [DriverName]\n"})}),"\n",(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"What is a Flow Driver?"}),(0,r.jsx)(t.br,{}),"\n","Flow Driver is a class that handle three actions:"]}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"check the transition between two states is possible or not"}),"\n",(0,r.jsx)(t.li,{children:"get all possible statuses for each state"}),"\n",(0,r.jsx)(t.li,{children:"accomplish transition and run tasks for that transition"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["driver name must be an unique singular name like ",(0,r.jsx)(t.code,{children:"request"})," or ",(0,r.jsx)(t.code,{children:"payroll"}),"."]}),"\n",(0,r.jsxs)(t.p,{children:["this command will create a file name ",(0,r.jsx)(t.code,{children:"[DriverName]DriverFlow.php"})," in App/Flows/Drivers/[DriverName] directory.\nfor example the command ",(0,r.jsx)(t.code,{children:"php artisan make:flow request"})," will create RequestDriverFlow.php in App/Flows/Drivers/Request"]}),"\n",(0,r.jsx)(t.p,{children:"this class contains below code:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",children:"namespace App\\Flows\\Drivers\\Request;\n\nuse JobMetric\\Flow\\Abstracts\\DriverContract;\nuse JobMetric\\Flow\\Models\\FlowState;\n\nclass RequestDriverFlow extends DriverContract\n{\n    public function allowTransition(FlowState $from, FlowState $to)\n    {\n        \n    }\n    \n    public function transition(FlowState $from, FlowState $to,int $assetId){\n        \n    }\n\n    public function getStatus(): array\n    {\n        return [\n            // write any status here\n        ];\n    }\n}\n"})}),"\n",(0,r.jsx)(t.p,{children:"this class contains the following methods:"}),"\n",(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"getStatus()"})," : Returning all possible statuses in each state as an array",(0,r.jsx)(t.br,{}),"\n",(0,r.jsx)(t.strong,{children:"allowTransition()"})," check this transition is allowed if not an exception will be thrown",(0,r.jsx)(t.br,{}),"\n",(0,r.jsx)(t.strong,{children:"transition()"})," in this method, you have to check the level of access, execute pipeline tasks, and change the current state of the asset to the ",(0,r.jsx)(t.code,{children:"to"})," state."]}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"flow-facade",children:"Flow Facade"}),"\n",(0,r.jsxs)(t.p,{children:["to work easily with crud operation of a flow you can use the ",(0,r.jsx)(t.code,{children:"Flow"})," Facade that contains following methods:"]}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"method"}),(0,r.jsx)(t.th,{children:"desc"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"store(array $data)"})}),(0,r.jsx)(t.td,{children:"store a flow"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"show(int $flow_id, array $with = [])"})}),(0,r.jsx)(t.td,{children:"return a flow with loading relations"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"update(int $flow_id, array $data)"})}),(0,r.jsx)(t.td,{children:"update a flow"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"delete(int $flow_id)"})}),(0,r.jsx)(t.td,{children:"delete a flow"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"restore(int $flow_id)"})}),(0,r.jsx)(t.td,{children:"restore a flow"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"forceDelete(int $flow_id)"})}),(0,r.jsx)(t.td,{children:"force delete a flow"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"getDriver(string $driver)"})}),(0,r.jsx)(t.td,{children:"get driver of a flow by driver name and return as DriverContract"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"getStatus(string $driver)"})}),(0,r.jsx)(t.td,{children:"get all possible statuses of flow by driver name"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"getStartState(int $flow_id)"})}),(0,r.jsx)(t.td,{children:"get start state of a flow by flow_id"})]})]})]}),"\n",(0,r.jsx)(t.p,{children:"this facade is using FlowManager Class, so you can directly use FlowManager class instead of Flow Facade"})]})}function h(e={}){const{wrapper:t}={...(0,l.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453(e,t,n){n.d(t,{R:()=>o,x:()=>i});var s=n(6540);const r={},l=s.createContext(r);function o(e){const t=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(l.Provider,{value:t},e.children)}}}]);