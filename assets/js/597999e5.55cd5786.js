"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[5065],{3531(e,s,n){n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>i,default:()=>u,frontMatter:()=>l,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"laravel-flow/deep-diving/transition-result","title":"TransitionResult DTO","description":"The TransitionResult class is a Data Transfer Object (DTO) that represents the outcome of running workflow transitions and their associated tasks. It provides a standardized way to carry both machine-readable and human-readable data through the workflow pipeline, making it ideal for API responses, logging, and error handling.","source":"@site/packages/laravel-flow/deep-diving/transition-result.md","sourceDirName":"laravel-flow/deep-diving","slug":"/laravel-flow/deep-diving/transition-result","permalink":"/packages/laravel-flow/deep-diving/transition-result","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-flow/deep-diving/transition-result.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"sidebar_label":"TransitionResult DTO"},"sidebar":"packagesSidebar","previous":{"title":"MakeTask Command","permalink":"/packages/laravel-flow/deep-diving/make-task"},"next":{"title":"FlowTaskRegistry","permalink":"/packages/laravel-flow/deep-diving/support/flow-task-registry"}}');var a=n(4848),t=n(8453);const l={sidebar_position:5,sidebar_label:"TransitionResult DTO"},i="TransitionResult DTO",d={},c=[{value:"Namespace",id:"namespace",level:2},{value:"Overview",id:"overview",level:2},{value:"Properties",id:"properties",level:2},{value:"Protected Properties",id:"protected-properties",level:3},{value:"Constructor",id:"constructor",level:2},{value:"Basic Usage",id:"basic-usage",level:3},{value:"Constructor Parameters",id:"constructor-parameters",level:3},{value:"Static Factory Methods",id:"static-factory-methods",level:2},{value:"success()",id:"success",level:3},{value:"failure()",id:"failure",level:3},{value:"State Management",id:"state-management",level:2},{value:"markSuccess()",id:"marksuccess",level:3},{value:"markFailed()",id:"markfailed",level:3},{value:"Message Management",id:"message-management",level:2},{value:"addMessage()",id:"addmessage",level:3},{value:"addError()",id:"adderror",level:3},{value:"Data Management",id:"data-management",level:2},{value:"setData()",id:"setdata",level:3},{value:"mergeData()",id:"mergedata",level:3},{value:"Metadata Management",id:"metadata-management",level:2},{value:"setMeta()",id:"setmeta",level:3},{value:"mergeMeta()",id:"mergemeta",level:3},{value:"Merging Results",id:"merging-results",level:2},{value:"merge()",id:"merge",level:3},{value:"Query Methods",id:"query-methods",level:2},{value:"isSuccess()",id:"issuccess",level:3},{value:"hasErrors()",id:"haserrors",level:3},{value:"getStatus()",id:"getstatus",level:3},{value:"getCode()",id:"getcode",level:3},{value:"getMessages()",id:"getmessages",level:3},{value:"getErrors()",id:"geterrors",level:3},{value:"getData()",id:"getdata",level:3},{value:"getMeta()",id:"getmeta",level:3},{value:"Array Conversion",id:"array-conversion",level:2},{value:"toArray()",id:"toarray",level:3},{value:"Complete Examples",id:"complete-examples",level:2},{value:"Example 1: Successful Transition",id:"example-1-successful-transition",level:3},{value:"Example 2: Failed Transition",id:"example-2-failed-transition",level:3},{value:"Example 3: Merging Multiple Results",id:"example-3-merging-multiple-results",level:3},{value:"Example 4: Conditional Error Handling",id:"example-4-conditional-error-handling",level:3},{value:"Example 5: Building Response with Warnings",id:"example-5-building-response-with-warnings",level:3},{value:"Example 6: Using in Action Tasks",id:"example-6-using-in-action-tasks",level:3},{value:"Method Chaining",id:"method-chaining",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Use Static Factory Methods",id:"1-use-static-factory-methods",level:3},{value:"2. Distinguish Between Data and Meta",id:"2-distinguish-between-data-and-meta",level:3},{value:"3. Use Appropriate Error Handling",id:"3-use-appropriate-error-handling",level:3},{value:"4. Merge Results Efficiently",id:"4-merge-results-efficiently",level:3},{value:"5. Use Codes for Machine Readability",id:"5-use-codes-for-machine-readability",level:3},{value:"6. Keep Messages User-Friendly",id:"6-keep-messages-user-friendly",level:3},{value:"Integration with FlowTransition",id:"integration-with-flowtransition",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function o(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"transitionresult-dto",children:"TransitionResult DTO"})}),"\n",(0,a.jsxs)(s.p,{children:["The ",(0,a.jsx)(s.code,{children:"TransitionResult"})," class is a Data Transfer Object (DTO) that represents the outcome of running workflow transitions and their associated tasks. It provides a standardized way to carry both machine-readable and human-readable data through the workflow pipeline, making it ideal for API responses, logging, and error handling."]}),"\n",(0,a.jsx)(s.h2,{id:"namespace",children:"Namespace"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"JobMetric\\Flow\\DTO\\TransitionResult\n"})}),"\n",(0,a.jsx)(s.h2,{id:"overview",children:"Overview"}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.code,{children:"TransitionResult"})," encapsulates:"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Success/Failure State"}),": Boolean flag indicating overall success"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Status"}),': Machine-readable status string (e.g., "ok", "failed")']}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Code"}),": Optional machine-readable code for clients or logs"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Messages"}),": Human-readable informational messages"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Errors"}),": Human-readable error messages"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Data"}),": Arbitrary data payload for consumers (controllers, API responses)"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Meta"}),": Arbitrary metadata for debugging, tracing, or internal usage"]}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"properties",children:"Properties"}),"\n",(0,a.jsx)(s.h3,{id:"protected-properties",children:"Protected Properties"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"protected bool $success = true;              // Overall success flag\nprotected string $status = 'ok';             // Machine-readable status\nprotected array $messages = [];              // Informational messages\nprotected array $errors = [];               // Error messages\nprotected array $data = [];                 // Data payload\nprotected array $meta = [];                // Metadata payload\nprotected ?string $code = null;             // Optional result code\n"})}),"\n",(0,a.jsx)(s.h2,{id:"constructor",children:"Constructor"}),"\n",(0,a.jsx)(s.h3,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"use JobMetric\\Flow\\DTO\\TransitionResult;\n\n// Default: success=true, status='ok', code=null\n$result = new TransitionResult();\n\n// Custom success state\n$result = new TransitionResult(false);\n\n// Custom status\n$result = new TransitionResult(true, 'custom_status');\n\n// With code\n$result = new TransitionResult(true, 'ok', 'CUSTOM_CODE');\n"})}),"\n",(0,a.jsx)(s.h3,{id:"constructor-parameters",children:"Constructor Parameters"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"bool $success = true"}),": Overall success flag"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"string $status = 'ok'"}),": Machine-readable status string"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"?string $code = null"}),": Optional machine-readable code"]}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"static-factory-methods",children:"Static Factory Methods"}),"\n",(0,a.jsx)(s.h3,{id:"success",children:"success()"}),"\n",(0,a.jsxs)(s.p,{children:["Create a successful ",(0,a.jsx)(s.code,{children:"TransitionResult"})," with optional initial data."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"// Simple success\n$result = TransitionResult::success();\n\n// With initial data\n$result = TransitionResult::success([\n    'order_id' => 123,\n    'status' => 'processed',\n]);\n"})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Returns:"})," ",(0,a.jsx)(s.code,{children:"TransitionResult"})," instance with ",(0,a.jsx)(s.code,{children:"success=true"}),", ",(0,a.jsx)(s.code,{children:"status='ok'"})]}),"\n",(0,a.jsx)(s.h3,{id:"failure",children:"failure()"}),"\n",(0,a.jsxs)(s.p,{children:["Create a failed ",(0,a.jsx)(s.code,{children:"TransitionResult"})," with optional error message and code."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"// Simple failure\n$result = TransitionResult::failure();\n\n// With error message\n$result = TransitionResult::failure('Payment processing failed');\n\n// With code\n$result = TransitionResult::failure(null, 'PAYMENT_ERROR');\n\n// With both message and code\n$result = TransitionResult::failure('Payment processing failed', 'PAYMENT_ERROR');\n"})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Returns:"})," ",(0,a.jsx)(s.code,{children:"TransitionResult"})," instance with ",(0,a.jsx)(s.code,{children:"success=false"}),", ",(0,a.jsx)(s.code,{children:"status='failed'"})]}),"\n",(0,a.jsx)(s.h2,{id:"state-management",children:"State Management"}),"\n",(0,a.jsx)(s.h3,{id:"marksuccess",children:"markSuccess()"}),"\n",(0,a.jsx)(s.p,{children:"Mark the result as successful and optionally update the status."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result = new TransitionResult(false);\n$result->markSuccess(); // success=true, status='ok'\n\n// With custom status\n$result->markSuccess('completed'); // success=true, status='completed'\n"})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Returns:"})," ",(0,a.jsx)(s.code,{children:"$this"})," (fluent interface)"]}),"\n",(0,a.jsx)(s.h3,{id:"markfailed",children:"markFailed()"}),"\n",(0,a.jsx)(s.p,{children:"Mark the result as failed and optionally update the status and code."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result = new TransitionResult(true);\n$result->markFailed(); // success=false, status='failed'\n\n// With custom status\n$result->markFailed('error_status');\n\n// With status and code\n$result->markFailed('error_status', 'ERROR_CODE');\n"})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Returns:"})," ",(0,a.jsx)(s.code,{children:"$this"})," (fluent interface)"]}),"\n",(0,a.jsx)(s.h2,{id:"message-management",children:"Message Management"}),"\n",(0,a.jsx)(s.h3,{id:"addmessage",children:"addMessage()"}),"\n",(0,a.jsx)(s.p,{children:"Add an informational message to the result."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result = new TransitionResult();\n$result->addMessage('Order processed successfully');\n$result->addMessage('Email notification sent');\n\n// Chaining\n$result->addMessage('Message 1')\n    ->addMessage('Message 2')\n    ->addMessage('Message 3');\n"})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Returns:"})," ",(0,a.jsx)(s.code,{children:"$this"})," (fluent interface)"]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Use Cases:"})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"Success notifications"}),"\n",(0,a.jsx)(s.li,{children:"Informational logs"}),"\n",(0,a.jsx)(s.li,{children:"User-friendly messages"}),"\n",(0,a.jsx)(s.li,{children:"Debug information"}),"\n"]}),"\n",(0,a.jsx)(s.h3,{id:"adderror",children:"addError()"}),"\n",(0,a.jsx)(s.p,{children:"Add an error message to the result. By default, this marks the result as failed."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result = new TransitionResult();\n$result->addError('Payment gateway timeout'); // Marks as failed by default\n\n// Add error without marking as failed\n$result->addError('Warning: Low balance', false); // Keeps success state\n\n// Chaining\n$result->addError('Error 1')\n    ->addError('Error 2')\n    ->addError('Error 3');\n"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Parameters:"})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"string $error"}),": Error message"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"bool $markFailed = true"}),": Whether to mark result as failed"]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Returns:"})," ",(0,a.jsx)(s.code,{children:"$this"})," (fluent interface)"]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Behavior:"})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["When ",(0,a.jsx)(s.code,{children:"$markFailed = true"})," (default): Sets ",(0,a.jsx)(s.code,{children:"success=false"})," and ",(0,a.jsx)(s.code,{children:"status='failed'"})]}),"\n",(0,a.jsxs)(s.li,{children:["When ",(0,a.jsx)(s.code,{children:"$markFailed = false"}),": Only adds error to collection, preserves success state"]}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"data-management",children:"Data Management"}),"\n",(0,a.jsx)(s.h3,{id:"setdata",children:"setData()"}),"\n",(0,a.jsx)(s.p,{children:"Set a single data key-value pair."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result = new TransitionResult();\n$result->setData('order_id', 123);\n$result->setData('total', 99.99);\n$result->setData('items', ['item1', 'item2']);\n\n// Overwrites existing key\n$result->setData('order_id', 456); // Replaces 123 with 456\n"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Parameters:"})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"string $key"}),": Data key"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"mixed $value"}),": Data value (any type)"]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Returns:"})," ",(0,a.jsx)(s.code,{children:"$this"})," (fluent interface)"]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Supported Value Types:"})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"Strings"}),"\n",(0,a.jsx)(s.li,{children:"Integers"}),"\n",(0,a.jsx)(s.li,{children:"Floats"}),"\n",(0,a.jsx)(s.li,{children:"Booleans"}),"\n",(0,a.jsx)(s.li,{children:"Arrays"}),"\n",(0,a.jsx)(s.li,{children:"Objects"}),"\n",(0,a.jsx)(s.li,{children:"Null"}),"\n"]}),"\n",(0,a.jsx)(s.h3,{id:"mergedata",children:"mergeData()"}),"\n",(0,a.jsx)(s.p,{children:"Merge an array of data into the existing data payload."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result = new TransitionResult();\n$result->setData('key1', 'value1');\n$result->mergeData([\n    'key2' => 'value2',\n    'key3' => 'value3',\n]);\n\n// Existing keys are overwritten\n$result->mergeData(['key1' => 'new_value']); // Replaces 'value1'\n"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Parameters:"})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"array<string, mixed> $data"}),": Data to merge"]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Returns:"})," ",(0,a.jsx)(s.code,{children:"$this"})," (fluent interface)"]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Use Cases:"})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"Merging task results"}),"\n",(0,a.jsx)(s.li,{children:"Combining multiple data sources"}),"\n",(0,a.jsx)(s.li,{children:"Building response payloads"}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"metadata-management",children:"Metadata Management"}),"\n",(0,a.jsx)(s.h3,{id:"setmeta",children:"setMeta()"}),"\n",(0,a.jsx)(s.p,{children:"Set a single metadata key-value pair."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result = new TransitionResult();\n$result->setMeta('execution_time', 0.5);\n$result->setMeta('task_count', 3);\n$result->setMeta('debug_info', ['step' => 1, 'action' => 'process']);\n"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Parameters:"})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"string $key"}),": Metadata key"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"mixed $value"}),": Metadata value (any type)"]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Returns:"})," ",(0,a.jsx)(s.code,{children:"$this"})," (fluent interface)"]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Use Cases:"})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"Debugging information"}),"\n",(0,a.jsx)(s.li,{children:"Performance metrics"}),"\n",(0,a.jsx)(s.li,{children:"Tracing data"}),"\n",(0,a.jsx)(s.li,{children:"Internal processing details"}),"\n"]}),"\n",(0,a.jsx)(s.h3,{id:"mergemeta",children:"mergeMeta()"}),"\n",(0,a.jsx)(s.p,{children:"Merge an array of metadata into the existing metadata payload."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result = new TransitionResult();\n$result->setMeta('meta1', 'value1');\n$result->mergeMeta([\n    'meta2' => 'value2',\n    'meta3' => 'value3',\n]);\n"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Parameters:"})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"array<string, mixed> $meta"}),": Metadata to merge"]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Returns:"})," ",(0,a.jsx)(s.code,{children:"$this"})," (fluent interface)"]}),"\n",(0,a.jsx)(s.h2,{id:"merging-results",children:"Merging Results"}),"\n",(0,a.jsx)(s.h3,{id:"merge",children:"merge()"}),"\n",(0,a.jsxs)(s.p,{children:["Merge another ",(0,a.jsx)(s.code,{children:"TransitionResult"})," into the current instance."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result1 = TransitionResult::success(['key1' => 'value1']);\n$result1->addMessage('Message 1');\n\n$result2 = TransitionResult::failure('Error occurred');\n$result2->addMessage('Message 2');\n$result2->setData('key2', 'value2');\n\n$result1->merge($result2);\n"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Merge Behavior:"})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Messages"}),": Combined into single array"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Errors"}),": Combined into single array"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Data"}),": Merged (existing keys overwritten)"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Meta"}),": Merged (existing keys overwritten)"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Success"}),": If other result is failed, current becomes failed"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Status"}),": If other result is failed, current status becomes other's status"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Code"}),": If other result is failed, current code becomes other's code"]}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Parameters:"})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"TransitionResult $other"}),": Result to merge"]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Returns:"})," ",(0,a.jsx)(s.code,{children:"$this"})," (fluent interface)"]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Use Cases:"})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"Combining multiple task results"}),"\n",(0,a.jsx)(s.li,{children:"Aggregating transition outcomes"}),"\n",(0,a.jsx)(s.li,{children:"Building comprehensive responses"}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"query-methods",children:"Query Methods"}),"\n",(0,a.jsx)(s.h3,{id:"issuccess",children:"isSuccess()"}),"\n",(0,a.jsx)(s.p,{children:"Determine whether the result is successful."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result = TransitionResult::success();\n$result->isSuccess(); // true\n\n$result = TransitionResult::failure();\n$result->isSuccess(); // false\n"})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Returns:"})," ",(0,a.jsx)(s.code,{children:"bool"})]}),"\n",(0,a.jsx)(s.h3,{id:"haserrors",children:"hasErrors()"}),"\n",(0,a.jsx)(s.p,{children:"Determine whether the result contains any error messages."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result = new TransitionResult();\n$result->hasErrors(); // false\n\n$result->addError('Error message');\n$result->hasErrors(); // true\n"})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Returns:"})," ",(0,a.jsx)(s.code,{children:"bool"})]}),"\n",(0,a.jsx)(s.h3,{id:"getstatus",children:"getStatus()"}),"\n",(0,a.jsx)(s.p,{children:"Get the current status string."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result = new TransitionResult(true, 'custom_status');\n$result->getStatus(); // 'custom_status'\n"})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Returns:"})," ",(0,a.jsx)(s.code,{children:"string"})]}),"\n",(0,a.jsx)(s.h3,{id:"getcode",children:"getCode()"}),"\n",(0,a.jsx)(s.p,{children:"Get the machine-readable result code, if any."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result = new TransitionResult(true, 'ok', 'CUSTOM_CODE');\n$result->getCode(); // 'CUSTOM_CODE'\n\n$result = new TransitionResult();\n$result->getCode(); // null\n"})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Returns:"})," ",(0,a.jsx)(s.code,{children:"?string"})]}),"\n",(0,a.jsx)(s.h3,{id:"getmessages",children:"getMessages()"}),"\n",(0,a.jsx)(s.p,{children:"Get all informational messages."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result = new TransitionResult();\n$result->addMessage('Message 1');\n$result->addMessage('Message 2');\n\n$messages = $result->getMessages(); // ['Message 1', 'Message 2']\n"})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Returns:"})," ",(0,a.jsx)(s.code,{children:"array<int, string>"})]}),"\n",(0,a.jsx)(s.h3,{id:"geterrors",children:"getErrors()"}),"\n",(0,a.jsx)(s.p,{children:"Get all error messages."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result = new TransitionResult();\n$result->addError('Error 1');\n$result->addError('Error 2');\n\n$errors = $result->getErrors(); // ['Error 1', 'Error 2']\n"})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Returns:"})," ",(0,a.jsx)(s.code,{children:"array<int, string>"})]}),"\n",(0,a.jsx)(s.h3,{id:"getdata",children:"getData()"}),"\n",(0,a.jsx)(s.p,{children:"Get the data payload."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result = TransitionResult::success(['key' => 'value']);\n$data = $result->getData(); // ['key' => 'value']\n"})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Returns:"})," ",(0,a.jsx)(s.code,{children:"array<string, mixed>"})]}),"\n",(0,a.jsx)(s.h3,{id:"getmeta",children:"getMeta()"}),"\n",(0,a.jsx)(s.p,{children:"Get the metadata payload."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result = new TransitionResult();\n$result->setMeta('key', 'value');\n$meta = $result->getMeta(); // ['key' => 'value']\n"})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Returns:"})," ",(0,a.jsx)(s.code,{children:"array<string, mixed>"})]}),"\n",(0,a.jsx)(s.h2,{id:"array-conversion",children:"Array Conversion"}),"\n",(0,a.jsx)(s.h3,{id:"toarray",children:"toArray()"}),"\n",(0,a.jsx)(s.p,{children:"Convert the result into a plain array structure suitable for responses."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result = TransitionResult::success(['order_id' => 123]);\n$result->addMessage('Order processed');\n$result->setMeta('execution_time', 0.5);\n\n$array = $result->toArray();\n"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Returns:"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"[\n    'success' => true,\n    'status' => 'ok',\n    'code' => null,\n    'messages' => ['Order processed'],\n    'errors' => [],\n    'data' => ['order_id' => 123],\n    'meta' => ['execution_time' => 0.5],\n]\n"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Use Cases:"})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"API responses"}),"\n",(0,a.jsx)(s.li,{children:"JSON serialization"}),"\n",(0,a.jsx)(s.li,{children:"Logging"}),"\n",(0,a.jsx)(s.li,{children:"Frontend consumption"}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"complete-examples",children:"Complete Examples"}),"\n",(0,a.jsx)(s.h3,{id:"example-1-successful-transition",children:"Example 1: Successful Transition"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"use JobMetric\\Flow\\DTO\\TransitionResult;\n\n$result = TransitionResult::success([\n    'order_id' => 123,\n    'new_status' => 'processing',\n]);\n\n$result->addMessage('Order transition completed successfully')\n    ->addMessage('Email notification sent')\n    ->setMeta('execution_time', 0.25)\n    ->setMeta('tasks_executed', 3);\n\n// Use in API response\nreturn response()->json($result->toArray());\n"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Output:"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-json",children:'{\n    "success": true,\n    "status": "ok",\n    "code": null,\n    "messages": [\n        "Order transition completed successfully",\n        "Email notification sent"\n    ],\n    "errors": [],\n    "data": {\n        "order_id": 123,\n        "new_status": "processing"\n    },\n    "meta": {\n        "execution_time": 0.25,\n        "tasks_executed": 3\n    }\n}\n'})}),"\n",(0,a.jsx)(s.h3,{id:"example-2-failed-transition",children:"Example 2: Failed Transition"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result = TransitionResult::failure('Payment validation failed', 'PAYMENT_ERROR');\n\n$result->addError('Invalid payment method')\n    ->addError('Insufficient funds')\n    ->setData('order_id', 123)\n    ->setMeta('validation_attempts', 3);\n\n// Check result\nif (!$result->isSuccess()) {\n    logger()->error('Transition failed', $result->toArray());\n    return response()->json($result->toArray(), 400);\n}\n"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Output:"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-json",children:'{\n    "success": false,\n    "status": "failed",\n    "code": "PAYMENT_ERROR",\n    "messages": [],\n    "errors": [\n        "Payment validation failed",\n        "Invalid payment method",\n        "Insufficient funds"\n    ],\n    "data": {\n        "order_id": 123\n    },\n    "meta": {\n        "validation_attempts": 3\n    }\n}\n'})}),"\n",(0,a.jsx)(s.h3,{id:"example-3-merging-multiple-results",children:"Example 3: Merging Multiple Results"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"// Task 1 result\n$task1Result = TransitionResult::success(['task1' => 'completed']);\n$task1Result->addMessage('Task 1 executed successfully');\n\n// Task 2 result\n$task2Result = TransitionResult::success(['task2' => 'completed']);\n$task2Result->addMessage('Task 2 executed successfully');\n\n// Task 3 result (failed)\n$task3Result = TransitionResult::failure('Task 3 failed', 'TASK_ERROR');\n$task3Result->addError('Database connection timeout');\n\n// Merge all results\n$finalResult = TransitionResult::success();\n$finalResult->merge($task1Result)\n    ->merge($task2Result)\n    ->merge($task3Result);\n\n// Final result is failed because task3 failed\n$finalResult->isSuccess(); // false\n$finalResult->getMessages(); // ['Task 1 executed successfully', 'Task 2 executed successfully']\n$finalResult->getErrors(); // ['Task 3 failed', 'Database connection timeout']\n$finalResult->getData(); // ['task1' => 'completed', 'task2' => 'completed']\n"})}),"\n",(0,a.jsx)(s.h3,{id:"example-4-conditional-error-handling",children:"Example 4: Conditional Error Handling"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result = TransitionResult::success();\n\ntry {\n    // Process payment\n    $paymentResult = processPayment($order);\n    \n    if (!$paymentResult->success) {\n        $result->addError('Payment processing failed', true); // Marks as failed\n    } else {\n        $result->addMessage('Payment processed successfully')\n            ->mergeData(['payment_id' => $paymentResult->id]);\n    }\n} catch (\\Exception $e) {\n    $result->addError($e->getMessage(), true)\n        ->setMeta('exception', get_class($e))\n        ->setMeta('trace', $e->getTraceAsString());\n}\n\nreturn $result;\n"})}),"\n",(0,a.jsx)(s.h3,{id:"example-5-building-response-with-warnings",children:"Example 5: Building Response with Warnings"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result = TransitionResult::success(['order_id' => 123]);\n\n// Add warnings without marking as failed\n$result->addError('Low inventory warning', false)\n    ->addError('Shipping delay expected', false)\n    ->addMessage('Order created successfully');\n\n// Result is still successful but has warnings\n$result->isSuccess(); // true\n$result->hasErrors(); // true (but doesn't affect success)\n"})}),"\n",(0,a.jsx)(s.h3,{id:"example-6-using-in-action-tasks",children:"Example 6: Using in Action Tasks"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"use JobMetric\\Flow\\Contracts\\AbstractActionTask;\nuse JobMetric\\Flow\\Support\\FlowTaskContext;\nuse JobMetric\\Flow\\DTO\\TransitionResult;\n\nclass SendEmailActionTask extends AbstractActionTask\n{\n    protected function handle(FlowTaskContext $context): void\n    {\n        $result = $context->result();\n        $order = $context->subject();\n        \n        try {\n            Mail::to($order->customer_email)->send(new OrderStatusChanged($order));\n            \n            $result->addMessage('Email notification sent successfully')\n                ->setMeta('email_sent_at', now()->toIso8601String());\n        } catch (\\Exception $e) {\n            $result->addError('Failed to send email: ' . $e->getMessage(), false)\n                ->setMeta('email_error', $e->getMessage());\n        }\n    }\n}\n"})}),"\n",(0,a.jsx)(s.h2,{id:"method-chaining",children:"Method Chaining"}),"\n",(0,a.jsxs)(s.p,{children:["All methods that modify the result return ",(0,a.jsx)(s.code,{children:"$this"}),", enabling fluent method chaining:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"$result = TransitionResult::success()\n    ->addMessage('Step 1 completed')\n    ->addMessage('Step 2 completed')\n    ->setData('order_id', 123)\n    ->setData('status', 'processing')\n    ->mergeData(['additional' => 'data'])\n    ->setMeta('execution_time', 0.5)\n    ->setMeta('tasks_count', 3)\n    ->mergeMeta(['debug' => true]);\n"})}),"\n",(0,a.jsx)(s.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,a.jsx)(s.h3,{id:"1-use-static-factory-methods",children:"1. Use Static Factory Methods"}),"\n",(0,a.jsx)(s.p,{children:"Prefer static factory methods for clarity:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"// \u2705 Good\n$result = TransitionResult::success(['data' => 'value']);\n$result = TransitionResult::failure('Error message', 'ERROR_CODE');\n\n// \u26a0\ufe0f Acceptable\n$result = new TransitionResult(true, 'ok');\n"})}),"\n",(0,a.jsx)(s.h3,{id:"2-distinguish-between-data-and-meta",children:"2. Distinguish Between Data and Meta"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Data"}),": Information for API consumers (frontend, external systems)"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Meta"}),": Internal information (debugging, tracing, performance)"]}),"\n"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"// \u2705 Good\n$result->setData('order_id', 123); // For API response\n$result->setMeta('execution_time', 0.5); // For debugging\n\n// \u274c Bad\n$result->setData('debug_trace', $trace); // Should be meta\n"})}),"\n",(0,a.jsx)(s.h3,{id:"3-use-appropriate-error-handling",children:"3. Use Appropriate Error Handling"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"// \u2705 Good: Critical errors mark as failed\n$result->addError('Payment failed', true);\n\n// \u2705 Good: Warnings don't mark as failed\n$result->addError('Low inventory', false);\n\n// \u274c Bad: All errors mark as failed\n$result->addError('Minor warning', true);\n"})}),"\n",(0,a.jsx)(s.h3,{id:"4-merge-results-efficiently",children:"4. Merge Results Efficiently"}),"\n",(0,a.jsx)(s.p,{children:"When combining multiple task results:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"// \u2705 Good: Merge in sequence\n$finalResult = TransitionResult::success();\nforeach ($taskResults as $taskResult) {\n    $finalResult->merge($taskResult);\n}\n\n// \u274c Bad: Create new result for each merge\n$finalResult = new TransitionResult();\n$finalResult = $finalResult->merge($task1);\n$finalResult = $finalResult->merge($task2);\n"})}),"\n",(0,a.jsx)(s.h3,{id:"5-use-codes-for-machine-readability",children:"5. Use Codes for Machine Readability"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"// \u2705 Good: Use codes for programmatic handling\n$result = TransitionResult::failure('Payment failed', 'PAYMENT_ERROR');\n\n// Frontend can check code\nif ($result->getCode() === 'PAYMENT_ERROR') {\n    // Handle payment error specifically\n}\n\n// \u274c Bad: Only use messages\n$result = TransitionResult::failure('Payment failed');\n"})}),"\n",(0,a.jsx)(s.h3,{id:"6-keep-messages-user-friendly",children:"6. Keep Messages User-Friendly"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"// \u2705 Good: User-friendly messages\n$result->addMessage('Your order has been processed successfully');\n\n// \u274c Bad: Technical messages\n$result->addMessage('HTTP 200 OK - OrderService::process() completed');\n"})}),"\n",(0,a.jsx)(s.h2,{id:"integration-with-flowtransition",children:"Integration with FlowTransition"}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.code,{children:"TransitionResult"})," is automatically created and passed to tasks during transition execution:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-php",children:"use JobMetric\\Flow\\Facades\\FlowTransition;\n\n$result = FlowTransition::runner('process_order', $order);\n\n// Result is a TransitionResult instance\nif ($result->isSuccess()) {\n    // Handle success\n    $data = $result->getData();\n    $messages = $result->getMessages();\n} else {\n    // Handle failure\n    $errors = $result->getErrors();\n    $code = $result->getCode();\n}\n"})}),"\n",(0,a.jsx)(s.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"/packages/laravel-flow/deep-diving/services/flow-transition",children:"FlowTransition Service"})," - Learn about transition execution"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"/packages/laravel-flow/deep-diving/services/flow-task",children:"FlowTask Service"})," - Learn about task management"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"/packages/laravel-flow/deep-diving/support/flow-task-context",children:"FlowTaskContext"})," - Learn about task context"]}),"\n"]})]})}function u(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},8453(e,s,n){n.d(s,{R:()=>l,x:()=>i});var r=n(6540);const a={},t=r.createContext(a);function l(e){const s=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),r.createElement(t.Provider,{value:s},e.children)}}}]);