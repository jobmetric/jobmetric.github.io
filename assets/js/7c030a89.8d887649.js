"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[5702],{28453(e,n,s){s.d(n,{R:()=>l,x:()=>a});var t=s(96540);const r={},i=t.createContext(r);function l(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(i.Provider,{value:n},e.children)}},71634(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>p,frontMatter:()=>a,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"laravel-event-system/deep-diving/event-system","title":"EventSystem Service","description":"The EventSystem service provides comprehensive CRUD operations and dynamic event management functionality for Laravel Event System. You can use it directly via the service class or through the convenient Facade.","source":"@site/packages/laravel-event-system/deep-diving/event-system.md","sourceDirName":"laravel-event-system/deep-diving","slug":"/laravel-event-system/deep-diving/event-system","permalink":"/packages/laravel-event-system/deep-diving/event-system","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-event-system/deep-diving/event-system.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"sidebar_label":"EventSystem"},"sidebar":"packagesSidebar","previous":{"title":"Showcase","permalink":"/packages/laravel-event-system/showcase"},"next":{"title":"EventBus","permalink":"/packages/laravel-event-system/deep-diving/support/event-bus"}}');var r=s(74848),i=s(28453),l=s(28774);const a={sidebar_position:1,sidebar_label:"EventSystem"},d="EventSystem Service",c={},o=[{value:"Namespace",id:"namespace",level:2},{value:"Facade",id:"facade",level:2},{value:"Basic CRUD Operations",id:"basic-crud-operations",level:2},{value:"Store",id:"store",level:3},{value:"Query",id:"query",level:3},{value:"All",id:"all",level:3},{value:"Paginate",id:"paginate",level:3},{value:"Delete",id:"delete",level:3},{value:"Toggle Status",id:"toggle-status",level:3},{value:"Response Format",id:"response-format",level:2},{value:"Events",id:"events",level:2},{value:"EventSystemStoredEvent",id:"eventsystemstoredevent",level:3},{value:"EventSystemDeletingEvent",id:"eventsystemdeletingevent",level:3},{value:"EventSystemDeletedEvent",id:"eventsystemdeletedevent",level:3},{value:"Cache Management",id:"cache-management",level:2},{value:"Complete Examples",id:"complete-examples",level:2},{value:"Register Multiple Events",id:"register-multiple-events",level:3},{value:"Admin Interface",id:"admin-interface",level:3},{value:"Plugin System",id:"plugin-system",level:3},{value:"Related Documentation",id:"related-documentation",level:2}];function v(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"eventsystem-service",children:"EventSystem Service"})}),"\n",(0,r.jsx)(n.p,{children:"The EventSystem service provides comprehensive CRUD operations and dynamic event management functionality for Laravel Event System. You can use it directly via the service class or through the convenient Facade."}),"\n",(0,r.jsx)(n.h2,{id:"namespace",children:"Namespace"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"JobMetric\\EventSystem\\EventSystem\n"})}),"\n",(0,r.jsx)(n.h2,{id:"facade",children:"Facade"}),"\n",(0,r.jsx)(n.p,{children:"For convenience, you can use the EventSystem Facade:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"use JobMetric\\EventSystem\\Facades\\EventSystem;\n"})}),"\n",(0,r.jsx)(n.h2,{id:"basic-crud-operations",children:"Basic CRUD Operations"}),"\n",(0,r.jsx)(n.h3,{id:"store",children:"Store"}),"\n",(0,r.jsx)(n.p,{children:"Create a new event-listener binding."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"use JobMetric\\EventSystem\\Facades\\EventSystem;\n\n$response = EventSystem::store([\n    'name' => 'user.created',\n    'description' => 'Send welcome email when user registers',\n    'event' => App\\Events\\UserCreated::class,\n    'listener' => App\\Listeners\\SendWelcomeEmail::class,\n    'priority' => 10,\n    'status' => true,\n]);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Available Fields:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"name"})," (string, required): Unique name identifier for the event binding"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"description"})," (string, nullable): Optional description"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"event"})," (string, required): Fully qualified event class name"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"listener"})," (string, required): Fully qualified listener class name"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"priority"})," (int, nullable): Execution priority (default: 0)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"status"})," (bool): Active status (default: true)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Minimal Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$response = EventSystem::store([\n    'name' => 'order.completed',\n    'event' => App\\Events\\OrderCompleted::class,\n    'listener' => App\\Listeners\\SendOrderConfirmation::class,\n]);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"query",children:"Query"}),"\n",(0,r.jsx)(n.p,{children:"Build a query builder instance with filtering, sorting, and selected fields."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$query = EventSystem::query(['status' => true])\n    ->where('priority', '>', 5)\n    ->orderBy('priority', 'desc');\n\n$events = $query->get();\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Available Filters:"})}),"\n",(0,r.jsxs)(n.p,{children:["All fields can be filtered: ",(0,r.jsx)(n.code,{children:"id"}),", ",(0,r.jsx)(n.code,{children:"name"}),", ",(0,r.jsx)(n.code,{children:"description"}),", ",(0,r.jsx)(n.code,{children:"event"}),", ",(0,r.jsx)(n.code,{children:"listener"}),", ",(0,r.jsx)(n.code,{children:"priority"}),", ",(0,r.jsx)(n.code,{children:"status"}),", ",(0,r.jsx)(n.code,{children:"created_at"}),", ",(0,r.jsx)(n.code,{children:"updated_at"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// Filter by status\n$activeEvents = EventSystem::query(['status' => true])->get();\n\n// Filter by event class\n$userEvents = EventSystem::query(['event' => App\\Events\\UserCreated::class])->get();\n\n// Complex filtering\n$events = EventSystem::query()\n    ->where('status', true)\n    ->where('priority', '>', 5)\n    ->orderBy('priority', 'desc')\n    ->get();\n"})}),"\n",(0,r.jsx)(n.h3,{id:"all",children:"All"}),"\n",(0,r.jsx)(n.p,{children:"Return all event system records without pagination."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$events = EventSystem::all();\n\n// With filters\n$activeEvents = EventSystem::all(['status' => true]);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"paginate",children:"Paginate"}),"\n",(0,r.jsx)(n.p,{children:"Return a paginated collection of event system records."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$events = EventSystem::paginate();\n\n// With filters and custom page limit\n$events = EventSystem::paginate(['status' => true], 20);\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Returns:"})," ",(0,r.jsx)(n.code,{children:"LengthAwarePaginator"})]}),"\n",(0,r.jsx)(n.h3,{id:"delete",children:"Delete"}),"\n",(0,r.jsx)(n.p,{children:"Delete an event system record by its unique name."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$response = EventSystem::delete('user.created');\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Events Fired:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"EventSystemDeletingEvent"})," - Before deletion"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"EventSystemDeletedEvent"})," - After deletion"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"toggle-status",children:"Toggle Status"}),"\n",(0,r.jsx)(n.p,{children:"Toggle the boolean 'status' field of a given event system record."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$response = EventSystem::toggleStatus($eventId);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// Disable an event\n$response = EventSystem::toggleStatus($eventId);\n\n// Re-enable it later\n$response = EventSystem::toggleStatus($eventId);\n"})}),"\n",(0,r.jsx)(n.h2,{id:"response-format",children:"Response Format"}),"\n",(0,r.jsxs)(n.p,{children:["All methods return a ",(0,r.jsx)(n.code,{children:"Response"})," object with the following structure:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"Response::make(\n    bool $success,\n    string $message,\n    mixed $data = null,\n    int $code = 200\n)\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"[\n    'success' => true,\n    'message' => 'Event system entry created successfully',\n    'data' => [\n        'id' => 1,\n        'name' => 'user.created',\n        'description' => 'Send welcome email',\n        'event' => 'App\\\\Events\\\\UserCreated',\n        'listener' => 'App\\\\Listeners\\\\SendWelcomeEmail',\n        'priority' => 10,\n        'status' => true,\n        'created_at' => '2024-01-01 12:00:00',\n        'updated_at' => '2024-01-01 12:00:00',\n    ],\n    'code' => 201\n]\n"})}),"\n",(0,r.jsx)(n.h2,{id:"events",children:"Events"}),"\n",(0,r.jsx)(n.p,{children:"The service fires the following events:"}),"\n",(0,r.jsx)(n.h3,{id:"eventsystemstoredevent",children:"EventSystemStoredEvent"}),"\n",(0,r.jsx)(n.p,{children:"Fired after successfully storing a new event system entry."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Payload:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"$event"})," (Event): The created event model"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"$data"})," (array): The validated input data"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"eventsystemdeletingevent",children:"EventSystemDeletingEvent"}),"\n",(0,r.jsx)(n.p,{children:"Fired before deleting an event system entry."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Payload:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"$event"})," (Event): The event model being deleted"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"eventsystemdeletedevent",children:"EventSystemDeletedEvent"}),"\n",(0,r.jsx)(n.p,{children:"Fired after successfully deleting an event system entry."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Payload:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"$event"})," (Event): The deleted event model"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"cache-management",children:"Cache Management"}),"\n",(0,r.jsx)(n.p,{children:"The service automatically clears the cache after create, update, and delete operations:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"cache()->forget('events');\n"})}),"\n",(0,r.jsx)(n.h2,{id:"complete-examples",children:"Complete Examples"}),"\n",(0,r.jsx)(n.h3,{id:"register-multiple-events",children:"Register Multiple Events"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"use JobMetric\\EventSystem\\Facades\\EventSystem;\n\n$events = [\n    [\n        'name' => 'user.created',\n        'description' => 'Send welcome email',\n        'event' => App\\Events\\UserCreated::class,\n        'listener' => App\\Listeners\\SendWelcomeEmail::class,\n        'priority' => 10,\n    ],\n    [\n        'name' => 'order.completed',\n        'description' => 'Send order confirmation',\n        'event' => App\\Events\\OrderCompleted::class,\n        'listener' => App\\Listeners\\SendOrderConfirmation::class,\n        'priority' => 5,\n    ],\n];\n\nforeach ($events as $eventData) {\n    $response = EventSystem::store($eventData);\n    \n    if (!$response->isSuccess()) {\n        Log::error('Failed to register event', [\n            'event' => $eventData['name'],\n            'errors' => $response->getErrors(),\n        ]);\n    }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"admin-interface",children:"Admin Interface"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"namespace App\\Http\\Controllers\\Admin;\n\nuse App\\Http\\Controllers\\Controller;\nuse JobMetric\\EventSystem\\Facades\\EventSystem;\nuse Illuminate\\Http\\Request;\n\nclass EventSystemController extends Controller\n{\n    public function index(Request $request)\n    {\n        $events = EventSystem::paginate(\n            filter: $request->only(['status', 'event', 'listener']),\n            page_limit: $request->get('per_page', 15)\n        );\n\n        return view('admin.events.index', compact('events'));\n    }\n\n    public function store(Request $request)\n    {\n        $response = EventSystem::store($request->all());\n        \n        if ($response->isSuccess()) {\n            return redirect()->route('admin.events.index')\n                ->with('success', $response->getMessage());\n        }\n\n        return back()->withErrors($response->getErrors());\n    }\n\n    public function toggleStatus(int $id)\n    {\n        $response = EventSystem::toggleStatus($id);\n\n        return response()->json($response->toArray());\n    }\n\n    public function destroy(string $name)\n    {\n        $response = EventSystem::delete($name);\n\n        if ($response->isSuccess()) {\n            return redirect()->route('admin.events.index')\n                ->with('success', $response->getMessage());\n        }\n\n        return back()->withErrors($response->getErrors());\n    }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"plugin-system",children:"Plugin System"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"class EmailPlugin\n{\n    public function install(): void\n    {\n        EventSystem::store([\n            'name' => 'plugin.email.user.created',\n            'event' => App\\Events\\UserCreated::class,\n            'listener' => EmailPlugin\\Listeners\\SendWelcomeEmail::class,\n            'priority' => 10,\n            'status' => true,\n        ]);\n    }\n\n    public function uninstall(): void\n    {\n        EventSystem::delete('plugin.email.user.created');\n    }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/packages/laravel-event-system/deep-diving/domain-event",children:"DomainEvent"})," - Domain event contract"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/packages/laravel-event-system/deep-diving/support/event-bus",children:"EventBus"})," - Event bus for dispatching events"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/packages/laravel-event-system/deep-diving/support/event-registry",children:"EventRegistry"})," - Registry for managing domain events"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(l.A,{to:"/packages/laravel-event-system/deep-diving/store-event-system-request",children:"StoreEventSystemRequest"})," - Form request for validation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(l.A,{to:"/packages/laravel-event-system/deep-diving/event-system-resource",children:"EventSystemResource"})," - JSON resource for API responses"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(v,{...e})}):v(e)}}}]);