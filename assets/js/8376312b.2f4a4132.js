"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[6139],{2289(e,n,i){i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"laravel-flow/deep-diving/requests/update-flow-task-request","title":"UpdateFlowTaskRequest","description":"Form request class for validating FlowTask update data. This request handles partial updates with dynamic validation based on the task\'s driver, including driver-specific configuration validation.","source":"@site/packages/laravel-flow/deep-diving/requests/update-flow-task-request.md","sourceDirName":"laravel-flow/deep-diving/requests","slug":"/laravel-flow/deep-diving/requests/update-flow-task-request","permalink":"/packages/laravel-flow/deep-diving/requests/update-flow-task-request","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-flow/deep-diving/requests/update-flow-task-request.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9,"sidebar_label":"UpdateFlowTaskRequest"},"sidebar":"packagesSidebar","previous":{"title":"StoreFlowTaskRequest","permalink":"/packages/laravel-flow/deep-diving/requests/store-flow-task-request"},"next":{"title":"StoreFlowTransitionRequest","permalink":"/packages/laravel-flow/deep-diving/requests/store-flow-transition-request"}}');var r=i(4848),t=i(8453);const d={sidebar_position:9,sidebar_label:"UpdateFlowTaskRequest"},a="UpdateFlowTaskRequest",l={},o=[{value:"Namespace",id:"namespace",level:2},{value:"Overview",id:"overview",level:2},{value:"Key Features",id:"key-features",level:2},{value:"Validation Rules",id:"validation-rules",level:2},{value:"Optional Fields",id:"optional-fields",level:3},{value:"Driver Detection",id:"driver-detection",level:2},{value:"Dynamic Config Validation",id:"dynamic-config-validation",level:2},{value:"Context Management",id:"context-management",level:2},{value:"Static Rules Method",id:"static-rules-method",level:2},{value:"rulesFor()",id:"rulesfor",level:3},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Basic Update",id:"basic-update",level:3},{value:"Partial Update - Status Only",id:"partial-update---status-only",level:3},{value:"Partial Update - Config Only",id:"partial-update---config-only",level:3},{value:"Update Driver and Config",id:"update-driver-and-config",level:3},{value:"Update Ordering",id:"update-ordering",level:3},{value:"Complete Update",id:"complete-update",level:3},{value:"Driver Change Handling",id:"driver-change-handling",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Validation Errors",id:"validation-errors",level:3},{value:"Differences from StoreFlowTaskRequest",id:"differences-from-storeflowtaskrequest",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"updateflowtaskrequest",children:"UpdateFlowTaskRequest"})}),"\n",(0,r.jsx)(n.p,{children:"Form request class for validating FlowTask update data. This request handles partial updates with dynamic validation based on the task's driver, including driver-specific configuration validation."}),"\n",(0,r.jsx)(n.h2,{id:"namespace",children:"Namespace"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"JobMetric\\Flow\\Http\\Requests\\FlowTask\\UpdateFlowTaskRequest"})}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"UpdateFlowTaskRequest"})," validates incoming data when updating an existing FlowTask entity. Unlike ",(0,r.jsx)(n.code,{children:"StoreFlowTaskRequest"}),", all fields are optional (",(0,r.jsx)(n.code,{children:"sometimes"}),"), allowing partial updates while maintaining data integrity."]}),"\n",(0,r.jsx)(n.h2,{id:"key-features",children:"Key Features"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Partial Updates"}),": All fields are optional, allowing selective updates"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Dynamic Validation"}),": Rules generated based on current or new driver"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Driver Detection"}),": Automatically detects driver from existing task if not provided"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Context Support"}),": Supports external context injection"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Form Builder Integration"}),": Uses driver's form definition for config validation"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"validation-rules",children:"Validation Rules"}),"\n",(0,r.jsx)(n.h3,{id:"optional-fields",children:"Optional Fields"}),"\n",(0,r.jsxs)(n.p,{children:["All fields use ",(0,r.jsx)(n.code,{children:"sometimes"})," rule:"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field"}),(0,r.jsx)(n.th,{children:"Rule"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"driver"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"sometimes|string"})}),(0,r.jsx)(n.td,{children:"Fully qualified driver class name"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"driver"})," (custom)"]}),(0,r.jsx)(n.td,{children:"Class exists, extends AbstractTaskDriver, registered"}),(0,r.jsx)(n.td,{children:"Driver validation checks"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"config"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"sometimes|array"})}),(0,r.jsx)(n.td,{children:"Driver-specific configuration"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"config.*"})}),(0,r.jsx)(n.td,{children:"Dynamic rules from driver's form"}),(0,r.jsx)(n.td,{children:"Validated based on driver's form definition"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ordering"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"sometimes|nullable|integer|min:0"})}),(0,r.jsx)(n.td,{children:"Task execution order"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"status"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"sometimes|boolean"})}),(0,r.jsx)(n.td,{children:"Active/inactive status"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"driver-detection",children:"Driver Detection"}),"\n",(0,r.jsxs)(n.p,{children:["If ",(0,r.jsx)(n.code,{children:"driver"})," is not provided in the update, the request automatically detects it from the existing task:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// If updating task ID 5\n// And task 5 has driver 'App\\FlowTasks\\SendEmailTask'\n// Then config validation uses SendEmailTask's form definition\n"})}),"\n",(0,r.jsx)(n.h2,{id:"dynamic-config-validation",children:"Dynamic Config Validation"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"config"})," field is validated based on the driver's form definition (from input or existing task):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// If driver (current or new) defines form:\npublic function form(): array\n{\n    return [\n        'recipient' => ['required', 'email'],\n        'subject' => ['required', 'string'],\n    ];\n}\n\n// Then config is validated as:\n'config.recipient' => 'required|email',\n'config.subject' => 'required|string',\n"})}),"\n",(0,r.jsx)(n.h2,{id:"context-management",children:"Context Management"}),"\n",(0,r.jsx)(n.p,{children:"The request supports external context injection:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$request = new UpdateFlowTaskRequest();\n$request->setContext(['flow_task_id' => 123]);\n"})}),"\n",(0,r.jsx)(n.h2,{id:"static-rules-method",children:"Static Rules Method"}),"\n",(0,r.jsx)(n.h3,{id:"rulesfor",children:"rulesFor()"}),"\n",(0,r.jsx)(n.p,{children:"Provides programmatic validation:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$input = [\n    'driver' => 'App\\FlowTasks\\SendEmailTask',\n    'config' => [\n        'recipient' => 'user@example.com',\n    ],\n];\n\n$context = ['flow_task_id' => 5];\n\n$rules = UpdateFlowTaskRequest::rulesFor($input, $context);\n"})}),"\n",(0,r.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,r.jsx)(n.h3,{id:"basic-update",children:"Basic Update"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"use JobMetric\\Flow\\Http\\Requests\\FlowTask\\UpdateFlowTaskRequest;\nuse JobMetric\\Flow\\Facades\\FlowTask;\n\npublic function update(UpdateFlowTaskRequest $request, $id)\n{\n    $validated = $request->validated();\n    \n    $task = FlowTask::update($id, $validated);\n    \n    return response()->json($task);\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"partial-update---status-only",children:"Partial Update - Status Only"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$requestData = [\n    'status' => false, // Deactivate task\n];\n"})}),"\n",(0,r.jsx)(n.h3,{id:"partial-update---config-only",children:"Partial Update - Config Only"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$requestData = [\n    'config' => [\n        'recipient' => 'new-email@example.com',\n    ],\n];\n"})}),"\n",(0,r.jsx)(n.h3,{id:"update-driver-and-config",children:"Update Driver and Config"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$requestData = [\n    'driver' => 'App\\FlowTasks\\SendSmsTask',\n    'config' => [\n        'phone' => '+1234567890',\n        'message' => 'Order confirmed',\n    ],\n];\n"})}),"\n",(0,r.jsx)(n.h3,{id:"update-ordering",children:"Update Ordering"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$requestData = [\n    'ordering' => 5, // Change execution order\n];\n"})}),"\n",(0,r.jsx)(n.h3,{id:"complete-update",children:"Complete Update"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$requestData = [\n    'driver' => 'App\\FlowTasks\\SendEmailTask',\n    'config' => [\n        'recipient' => 'user@example.com',\n        'subject' => 'Updated Subject',\n        'template' => 'updated-template',\n    ],\n    'ordering' => 2,\n    'status' => true,\n];\n"})}),"\n",(0,r.jsx)(n.h2,{id:"driver-change-handling",children:"Driver Change Handling"}),"\n",(0,r.jsx)(n.p,{children:"When changing the driver, the config validation switches to the new driver's form:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// Original task uses SendEmailTask\n// Update to SendSmsTask\n$requestData = [\n    'driver' => 'App\\FlowTasks\\SendSmsTask',\n    'config' => [\n        'phone' => '+1234567890', // New driver's config\n    ],\n];\n"})}),"\n",(0,r.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsx)(n.h3,{id:"validation-errors",children:"Validation Errors"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n    "message": "The given data was invalid.",\n    "errors": {\n        "driver": [\n            "The driver is not registered in FlowTaskRegistry."\n        ],\n        "config.recipient": [\n            "The config.recipient field is required."\n        ]\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"differences-from-storeflowtaskrequest",children:"Differences from StoreFlowTaskRequest"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Feature"}),(0,r.jsx)(n.th,{children:"StoreFlowTaskRequest"}),(0,r.jsx)(n.th,{children:"UpdateFlowTaskRequest"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Field Rules"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"required"})," for driver and transition"]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"sometimes"})," for all fields"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Transition ID"}),(0,r.jsx)(n.td,{children:"Required"}),(0,r.jsx)(n.td,{children:"Not needed (task already has it)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Driver Detection"}),(0,r.jsx)(n.td,{children:"Must be provided"}),(0,r.jsx)(n.td,{children:"Can be detected from existing task"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Context Support"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"flow_id"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"flow_task_id"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Use Case"}),(0,r.jsx)(n.td,{children:"Creating new tasks"}),(0,r.jsx)(n.td,{children:"Updating existing tasks"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Update Only Changed Fields"}),": Only send fields that need updating"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// \u2705 Good\n['status' => false]\n\n// \u274c Bad\n['driver' => '...', 'config' => [...], 'ordering' => 0, 'status' => false]\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Handle Driver Changes"}),": When changing driver, provide new driver's config"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// \u2705 Good\n[\n    'driver' => 'App\\FlowTasks\\SendSmsTask',\n    'config' => ['phone' => '...'], // New driver's config\n]\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Validate Config Structure"}),": Match config to driver's form definition"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// \u2705 Good - Matches form\n'config' => [\n    'recipient' => 'user@example.com',\n]\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Context for Driver Detection"}),": Provide flow_task_id in context"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$request->setContext(['flow_task_id' => $id]);\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/packages/laravel-flow/deep-diving/services/flow-task",children:"FlowTask Service"})," - Task management"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/packages/laravel-flow/deep-diving/requests/store-flow-task-request",children:"StoreFlowTaskRequest"})," - Task creation validation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/packages/laravel-flow/deep-diving/resources/flow-task-resource",children:"FlowTaskResource"})," - Task JSON resource"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/packages/laravel-flow/deep-diving/support/flow-task-registry",children:"FlowTaskRegistry"})," - Driver registration"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/packages/laravel-flow/deep-diving/events",children:"Events"})," - Task lifecycle events"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453(e,n,i){i.d(n,{R:()=>d,x:()=>a});var s=i(6540);const r={},t=s.createContext(r);function d(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);