"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[9523],{4382(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"laravel-flow/deep-diving/resources/flow-transition-resource","title":"FlowTransitionResource","description":"JSON resource class for transforming FlowTransition models into structured API responses. This resource provides a consistent format for transition data with conditional relation loading.","source":"@site/packages/laravel-flow/deep-diving/resources/flow-transition-resource.md","sourceDirName":"laravel-flow/deep-diving/resources","slug":"/laravel-flow/deep-diving/resources/flow-transition-resource","permalink":"/packages/laravel-flow/deep-diving/resources/flow-transition-resource","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-flow/deep-diving/resources/flow-transition-resource.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"sidebar_label":"FlowTransitionResource"},"sidebar":"packagesSidebar","previous":{"title":"FlowTaskResource","permalink":"/packages/laravel-flow/deep-diving/resources/flow-task-resource"},"next":{"title":"FlowInstanceResource","permalink":"/packages/laravel-flow/deep-diving/resources/flow-instance-resource"}}');var r=i(4848),t=i(8453);const l={sidebar_position:4,sidebar_label:"FlowTransitionResource"},o="FlowTransitionResource",d={},a=[{value:"Namespace",id:"namespace",level:2},{value:"Overview",id:"overview",level:2},{value:"Base Properties",id:"base-properties",level:2},{value:"Transition Type Detection",id:"transition-type-detection",level:2},{value:"is_start_edge",id:"is_start_edge",level:3},{value:"is_end_edge",id:"is_end_edge",level:3},{value:"Conditional Properties",id:"conditional-properties",level:2},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Basic Usage",id:"basic-usage",level:3},{value:"With Relations",id:"with-relations",level:3},{value:"In Collections",id:"in-collections",level:3},{value:"In API Responses",id:"in-api-responses",level:3},{value:"Response Examples",id:"response-examples",level:2},{value:"Basic Response",id:"basic-response",level:3},{value:"Generic Input Transition",id:"generic-input-transition",level:3},{value:"Generic Output Transition",id:"generic-output-transition",level:3},{value:"With Translations",id:"with-translations",level:3},{value:"With Relations",id:"with-relations-1",level:3},{value:"Relation Loading",id:"relation-loading",level:2},{value:"Eager Loading Relations",id:"eager-loading-relations",level:3},{value:"Selective Loading",id:"selective-loading",level:3},{value:"Nested Relations",id:"nested-relations",level:3},{value:"Transition Types",id:"transition-types",level:2},{value:"Specific Transition",id:"specific-transition",level:3},{value:"Generic Input Transition",id:"generic-input-transition-1",level:3},{value:"Generic Output Transition",id:"generic-output-transition-1",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"flowtransitionresource",children:"FlowTransitionResource"})}),"\n",(0,r.jsx)(n.p,{children:"JSON resource class for transforming FlowTransition models into structured API responses. This resource provides a consistent format for transition data with conditional relation loading."}),"\n",(0,r.jsx)(n.h2,{id:"namespace",children:"Namespace"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"JobMetric\\Flow\\Http\\Resources\\FlowTransitionResource"})}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"FlowTransitionResource"})," transforms FlowTransition model instances into structured JSON responses. It includes:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Core transition properties"}),"\n",(0,r.jsx)(n.li,{children:"Multi-language translations"}),"\n",(0,r.jsx)(n.li,{children:"State relationships (from/to)"}),"\n",(0,r.jsx)(n.li,{children:"Transition type indicators"}),"\n",(0,r.jsx)(n.li,{children:"ISO 8601 formatted timestamps"}),"\n",(0,r.jsx)(n.li,{children:"Conditional relation loading"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"base-properties",children:"Base Properties"}),"\n",(0,r.jsx)(n.p,{children:"The resource always includes these properties:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Property"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"id"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"int"})}),(0,r.jsx)(n.td,{children:"Transition ID"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"flow_id"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"int"})}),(0,r.jsx)(n.td,{children:"Parent flow ID"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"from"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"int|null"})}),(0,r.jsx)(n.td,{children:"Source state ID (null for generic input)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"to"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"int|null"})}),(0,r.jsx)(n.td,{children:"Target state ID (null for generic output)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"slug"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string|null"})}),(0,r.jsx)(n.td,{children:"URL-friendly identifier"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"is_start_edge"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bool"})}),(0,r.jsx)(n.td,{children:"Whether this is a generic input transition (from=null)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"is_end_edge"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bool"})}),(0,r.jsx)(n.td,{children:"Whether this is a generic output transition (to=null)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"created_at"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"ISO 8601 formatted creation date"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"updated_at"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"ISO 8601 formatted update date"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"transition-type-detection",children:"Transition Type Detection"}),"\n",(0,r.jsx)(n.p,{children:"The resource automatically detects transition types:"}),"\n",(0,r.jsx)(n.h3,{id:"is_start_edge",children:"is_start_edge"}),"\n",(0,r.jsxs)(n.p,{children:["True when ",(0,r.jsx)(n.code,{children:"from"})," is null and ",(0,r.jsx)(n.code,{children:"to"})," is not null (generic input):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"'is_start_edge' => (bool)(is_null($this->from) && !is_null($this->to))\n"})}),"\n",(0,r.jsx)(n.h3,{id:"is_end_edge",children:"is_end_edge"}),"\n",(0,r.jsxs)(n.p,{children:["True when ",(0,r.jsx)(n.code,{children:"from"})," is not null and ",(0,r.jsx)(n.code,{children:"to"})," is null (generic output):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"'is_end_edge' => (bool)(!is_null($this->from) && is_null($this->to))\n"})}),"\n",(0,r.jsx)(n.h2,{id:"conditional-properties",children:"Conditional Properties"}),"\n",(0,r.jsx)(n.p,{children:"These properties are only included when their relations are loaded:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Property"}),(0,r.jsx)(n.th,{children:"Relation"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"translations"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"translations"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"object"})}),(0,r.jsx)(n.td,{children:"Multi-language translations"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"flow"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"flow"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"object"})}),(0,r.jsx)(n.td,{children:"FlowResource for parent flow"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"from_state"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"fromState"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"object|null"})}),(0,r.jsx)(n.td,{children:"FlowStateResource for source state"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"to_state"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"toState"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"object|null"})}),(0,r.jsx)(n.td,{children:"FlowStateResource for target state"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"tasks"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"tasks"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"array"})}),(0,r.jsx)(n.td,{children:"Collection of FlowTaskResource"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"instances"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"instances"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"array"})}),(0,r.jsx)(n.td,{children:"Collection of FlowInstanceResource"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,r.jsx)(n.h3,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"use JobMetric\\Flow\\Http\\Resources\\FlowTransitionResource;\nuse JobMetric\\Flow\\Models\\FlowTransition;\n\n$transition = FlowTransition::find(1);\n\nreturn FlowTransitionResource::make($transition);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"with-relations",children:"With Relations"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$transition = FlowTransition::with([\n    'flow',\n    'fromState',\n    'toState',\n    'tasks',\n])->find(1);\n\nreturn FlowTransitionResource::make($transition);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"in-collections",children:"In Collections"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$transitions = FlowTransition::with(['fromState', 'toState'])->get();\n\nreturn FlowTransitionResource::collection($transitions);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"in-api-responses",children:"In API Responses"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"use JobMetric\\Flow\\Facades\\FlowTransition;\n\npublic function show($id)\n{\n    $transition = FlowTransition::query()\n        ->with(['flow', 'fromState', 'toState', 'tasks'])\n        ->findOrFail($id);\n\n    return new FlowTransitionResource($transition);\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"response-examples",children:"Response Examples"}),"\n",(0,r.jsx)(n.h3,{id:"basic-response",children:"Basic Response"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n    "id": 1,\n    "flow_id": 1,\n    "from": 1,\n    "to": 2,\n    "slug": "approve-order",\n    "is_start_edge": false,\n    "is_end_edge": false,\n    "created_at": "2024-01-01T00:00:00.000000Z",\n    "updated_at": "2024-01-01T00:00:00.000000Z"\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"generic-input-transition",children:"Generic Input Transition"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n    "id": 2,\n    "flow_id": 1,\n    "from": null,\n    "to": 1,\n    "slug": "enter-processing",\n    "is_start_edge": true,\n    "is_end_edge": false,\n    // ... other fields\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"generic-output-transition",children:"Generic Output Transition"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n    "id": 3,\n    "flow_id": 1,\n    "from": 5,\n    "to": null,\n    "slug": "cancel-order",\n    "is_start_edge": false,\n    "is_end_edge": true,\n    // ... other fields\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"with-translations",children:"With Translations"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n    "id": 1,\n    "translations": {\n        "en": {\n            "name": "Approve Order"\n        },\n        "fa": {\n            "name": "\u062a\u0627\u06cc\u06cc\u062f \u0633\u0641\u0627\u0631\u0634"\n        }\n    },\n    "flow_id": 1,\n    "from": 1,\n    "to": 2,\n    // ... other fields\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"with-relations-1",children:"With Relations"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n    "id": 1,\n    "flow_id": 1,\n    "from": 1,\n    "to": 2,\n    "flow": {\n        "id": 1,\n        "subject_type": "App\\\\Models\\\\Order",\n        // ... FlowResource fields\n    },\n    "from_state": {\n        "id": 1,\n        "flow_id": 1,\n        "type": "middle",\n        "status": "pending",\n        // ... FlowStateResource fields\n    },\n    "to_state": {\n        "id": 2,\n        "flow_id": 1,\n        "type": "middle",\n        "status": "approved",\n        // ... FlowStateResource fields\n    },\n    "tasks": [\n        {\n            "id": 1,\n            "flow_transition_id": 1,\n            "driver": "App\\\\FlowTasks\\\\SendEmailTask",\n            // ... FlowTaskResource fields\n        }\n    ]\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"relation-loading",children:"Relation Loading"}),"\n",(0,r.jsx)(n.h3,{id:"eager-loading-relations",children:"Eager Loading Relations"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// Load all relations\n$transition = FlowTransition::with([\n    'translations',\n    'flow',\n    'fromState',\n    'toState',\n    'tasks',\n    'instances',\n])->find(1);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"selective-loading",children:"Selective Loading"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// Load only needed relations\n$transition = FlowTransition::with(['fromState', 'toState'])->find(1);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"nested-relations",children:"Nested Relations"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// Load deeply nested relations\n$transition = FlowTransition::with([\n    'fromState',\n    'toState',\n    'tasks.transition',\n    'flow.states',\n])->find(1);\n"})}),"\n",(0,r.jsx)(n.h2,{id:"transition-types",children:"Transition Types"}),"\n",(0,r.jsx)(n.h3,{id:"specific-transition",children:"Specific Transition"}),"\n",(0,r.jsxs)(n.p,{children:["Both ",(0,r.jsx)(n.code,{children:"from"})," and ",(0,r.jsx)(n.code,{children:"to"})," are specified:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n    "from": 1,\n    "to": 2,\n    "is_start_edge": false,\n    "is_end_edge": false\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"generic-input-transition-1",children:"Generic Input Transition"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"from"})," is null, ",(0,r.jsx)(n.code,{children:"to"})," is specified:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n    "from": null,\n    "to": 1,\n    "is_start_edge": true,\n    "is_end_edge": false\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"generic-output-transition-1",children:"Generic Output Transition"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"from"})," is specified, ",(0,r.jsx)(n.code,{children:"to"})," is null:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n    "from": 5,\n    "to": null,\n    "is_start_edge": false,\n    "is_end_edge": true\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Load Relations Efficiently"}),": Only load relations you need"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// \u2705 Good\nFlowTransition::with(['fromState', 'toState'])->get();\n\n// \u274c Bad\nFlowTransition::with(['flow', 'fromState', 'toState', 'tasks', 'instances'])->get();\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Handle Null States"}),": from/to can be null for generic transitions"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"if ($transition->from_state) {\n    // Handle source state\n}\n\nif ($transition->to_state) {\n    // Handle target state\n}\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Type Indicators"}),": Use is_start_edge and is_end_edge for type detection"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"if ($transition->is_start_edge) {\n    // Generic input transition\n}\n\nif ($transition->is_end_edge) {\n    // Generic output transition\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/packages/laravel-flow/deep-diving/services/flow-transition",children:"FlowTransition Service"})," - Learn about transition management"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/packages/laravel-flow/deep-diving/resources/flow-state-resource",children:"FlowStateResource"})," - State resource"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/packages/laravel-flow/deep-diving/resources/flow-task-resource",children:"FlowTaskResource"})," - Task resource"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453(e,n,i){i.d(n,{R:()=>l,x:()=>o});var s=i(6540);const r={},t=s.createContext(r);function l(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);