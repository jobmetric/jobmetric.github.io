"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[9691],{28453(e,n,t){t.d(n,{R:()=>s,x:()=>l});var a=t(96540);const i={},r=a.createContext(i);function s(e){const n=a.useContext(r);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),a.createElement(r.Provider,{value:n},e.children)}},90110(e,n,t){t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>u,frontMatter:()=>s,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"laravel-unit-converter/deep-diving/exceptions/unit-type-use-default-value","title":"UnitTypeUseDefaultValueException","description":"Thrown when attempting to create a unit with value = 1 when a base unit already exists for that type.","source":"@site/packages/laravel-unit-converter/deep-diving/exceptions/unit-type-use-default-value.md","sourceDirName":"laravel-unit-converter/deep-diving/exceptions","slug":"/laravel-unit-converter/deep-diving/exceptions/unit-type-use-default-value","permalink":"/packages/laravel-unit-converter/deep-diving/exceptions/unit-type-use-default-value","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-unit-converter/deep-diving/exceptions/unit-type-use-default-value.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"sidebar_label":"UnitTypeUseDefaultValueException"},"sidebar":"packagesSidebar","previous":{"title":"UnitTypeDefaultValueException","permalink":"/packages/laravel-unit-converter/deep-diving/exceptions/unit-type-default-value"},"next":{"title":"UnitTypeCannotChangeDefaultValueException","permalink":"/packages/laravel-unit-converter/deep-diving/exceptions/unit-type-cannot-change-default-value"}}');var i=t(74848),r=t(28453);const s={sidebar_position:5,sidebar_label:"UnitTypeUseDefaultValueException"},l="UnitTypeUseDefaultValueException",o={},c=[{value:"Namespace",id:"namespace",level:2},{value:"HTTP Status Code",id:"http-status-code",level:2},{value:"Constructor",id:"constructor",level:2},{value:"Parameters",id:"parameters",level:3},{value:"Understanding the Rule",id:"understanding-the-rule",level:2},{value:"Why Only One Base Unit?",id:"why-only-one-base-unit",level:3},{value:"When Is It Thrown?",id:"when-is-it-thrown",level:2},{value:"Example: Duplicate Base Unit Attempt",id:"example-duplicate-base-unit-attempt",level:3},{value:"Correct Approach",id:"correct-approach",level:3},{value:"Handling the Exception",id:"handling-the-exception",level:2},{value:"In Controllers",id:"in-controllers",level:3},{value:"In Form Validation",id:"in-form-validation",level:3},{value:"Prevention",id:"prevention",level:2},{value:"1. Check Before Creating",id:"1-check-before-creating",level:3},{value:"2. Use changeDefaultValue() Instead",id:"2-use-changedefaultvalue-instead",level:3},{value:"3. UI Validation",id:"3-ui-validation",level:3},{value:"What If You Need to Change the Base Unit?",id:"what-if-you-need-to-change-the-base-unit",level:2},{value:"Related Exceptions",id:"related-exceptions",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"unittypeusedefaultvalueexception",children:"UnitTypeUseDefaultValueException"})}),"\n",(0,i.jsxs)(n.p,{children:["Thrown when attempting to create a unit with ",(0,i.jsx)(n.code,{children:"value = 1"})," when a base unit already exists for that type."]}),"\n",(0,i.jsx)(n.h2,{id:"namespace",children:"Namespace"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"JobMetric\\UnitConverter\\Exceptions\\UnitTypeUseDefaultValueException\n"})}),"\n",(0,i.jsx)(n.h2,{id:"http-status-code",children:"HTTP Status Code"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"400 Bad Request"})}),"\n",(0,i.jsx)(n.h2,{id:"constructor",children:"Constructor"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"public function __construct(\n    string $type,\n    int $code = 400,\n    ?Throwable $previous = null\n)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"$type"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"string"})}),(0,i.jsx)(n.td,{children:"The unit type where a base unit already exists"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"$code"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"int"})}),(0,i.jsx)(n.td,{children:"HTTP status code (default: 400)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"$previous"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Throwable|null"})}),(0,i.jsx)(n.td,{children:"Previous exception for chaining"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"understanding-the-rule",children:"Understanding the Rule"}),"\n",(0,i.jsx)(n.p,{children:"In Laravel Unit Converter's base unit system:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Each type can have ",(0,i.jsx)(n.strong,{children:"only one"})," base unit with ",(0,i.jsx)(n.code,{children:"value = 1"})]}),"\n",(0,i.jsxs)(n.li,{children:["The base unit serves as the ",(0,i.jsx)(n.strong,{children:"reference point"})," for all conversions"]}),"\n",(0,i.jsx)(n.li,{children:"Having multiple base units would break the conversion mathematics"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"why-only-one-base-unit",children:"Why Only One Base Unit?"}),"\n",(0,i.jsx)(n.p,{children:"The conversion formula relies on a single reference:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"result = input_value \xd7 (from_unit.value / to_unit.value)\n"})}),"\n",(0,i.jsxs)(n.p,{children:["If two units had ",(0,i.jsx)(n.code,{children:"value = 1"}),", they would be mathematically equivalent, causing confusion and potential data integrity issues."]}),"\n",(0,i.jsx)(n.h2,{id:"when-is-it-thrown",children:"When Is It Thrown?"}),"\n",(0,i.jsxs)(n.p,{children:["This exception is thrown when you try to create a unit with ",(0,i.jsx)(n.code,{children:"value = 1"})," for a type that already has a base unit."]}),"\n",(0,i.jsx)(n.h3,{id:"example-duplicate-base-unit-attempt",children:"Example: Duplicate Base Unit Attempt"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"use JobMetric\\UnitConverter\\Facades\\UnitConverter;\n\n// Gram already exists as the base unit for weight (value = 1)\n\n// Trying to create another unit with value = 1 - WRONG!\nUnitConverter::store([\n    'type' => 'weight',\n    'value' => 1,  // Error! Base unit already exists\n    'translation' => [\n        'en' => ['name' => 'Base Weight', 'code' => 'bw'],\n    ],\n]);\n// Throws: UnitTypeUseDefaultValueException\n"})}),"\n",(0,i.jsx)(n.h3,{id:"correct-approach",children:"Correct Approach"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"use JobMetric\\UnitConverter\\Facades\\UnitConverter;\n\n// Gram (base unit) already exists\n\n// Create new unit with value relative to gram\nUnitConverter::store([\n    'type' => 'weight',\n    'value' => 1000,  // Not 1, relative to gram\n    'translation' => [\n        'en' => ['name' => 'Kilogram', 'code' => 'kg'],\n    ],\n]);\n// Success!\n"})}),"\n",(0,i.jsx)(n.h2,{id:"handling-the-exception",children:"Handling the Exception"}),"\n",(0,i.jsx)(n.h3,{id:"in-controllers",children:"In Controllers"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"use JobMetric\\UnitConverter\\Exceptions\\UnitTypeUseDefaultValueException;\nuse JobMetric\\UnitConverter\\Facades\\UnitConverter;\n\nclass UnitController extends Controller\n{\n    public function store(Request $request)\n    {\n        try {\n            $response = UnitConverter::store($request->all());\n            return response()->json($response->data, 201);\n        } catch (UnitTypeUseDefaultValueException $e) {\n            return response()->json([\n                'error' => 'base_unit_exists',\n                'message' => $e->getMessage(),\n                'hint' => 'A base unit (value = 1) already exists for this type. Use a different value.',\n            ], 400);\n        }\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"in-form-validation",children:"In Form Validation"}),"\n",(0,i.jsx)(n.p,{children:"Prevent the issue before it reaches the service:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"use JobMetric\\UnitConverter\\Models\\Unit;\n\nclass StoreUnitRequest extends FormRequest\n{\n    public function rules(): array\n    {\n        return [\n            'type' => 'required|string',\n            'value' => 'required|numeric|min:0',\n            'translation' => 'required|array',\n        ];\n    }\n    \n    public function withValidator($validator): void\n    {\n        $validator->after(function ($validator) {\n            $type = $this->input('type');\n            $value = (float) $this->input('value');\n            \n            if ($value === 1.0) {\n                $baseExists = Unit::where('type', $type)\n                    ->where('value', 1)\n                    ->exists();\n                \n                if ($baseExists) {\n                    $validator->errors()->add(\n                        'value',\n                        \"A base unit (value = 1) already exists for type '{$type}'\"\n                    );\n                }\n            }\n        });\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"prevention",children:"Prevention"}),"\n",(0,i.jsx)(n.h3,{id:"1-check-before-creating",children:"1. Check Before Creating"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"use JobMetric\\UnitConverter\\Models\\Unit;\nuse JobMetric\\UnitConverter\\Facades\\UnitConverter;\n\nfunction createUnitSafely(array $data): mixed\n{\n    $type = $data['type'];\n    $value = (float) $data['value'];\n    \n    if ($value === 1.0) {\n        $baseExists = Unit::where('type', $type)->where('value', 1)->exists();\n        \n        if ($baseExists) {\n            throw new \\InvalidArgumentException(\n                \"Base unit already exists for type '{$type}'. Use changeDefaultValue() to change the base unit.\"\n            );\n        }\n    }\n    \n    return UnitConverter::store($data);\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"2-use-changedefaultvalue-instead",children:"2. Use changeDefaultValue() Instead"}),"\n",(0,i.jsxs)(n.p,{children:["If you want to change which unit is the base unit, use ",(0,i.jsx)(n.code,{children:"changeDefaultValue()"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"use JobMetric\\UnitConverter\\Facades\\UnitConverter;\n\n// Current state:\n// - Gram: value = 1 (base)\n// - Kilogram: value = 1000\n\n// Make Kilogram the new base unit\nUnitConverter::changeDefaultValue($kilogramId);\n\n// New state:\n// - Gram: value = 0.001\n// - Kilogram: value = 1 (new base)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"3-ui-validation",children:"3. UI Validation"}),"\n",(0,i.jsxs)(n.p,{children:["In your frontend, prevent users from entering ",(0,i.jsx)(n.code,{children:"value = 1"})," if a base unit exists:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// Example Vue.js validation\nasync function validateUnitValue(type, value) {\n    if (value === 1) {\n        const response = await fetch(`/api/units/base-exists/${type}`);\n        const { exists } = await response.json();\n        \n        if (exists) {\n            return 'A base unit already exists for this type';\n        }\n    }\n    return null;\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"what-if-you-need-to-change-the-base-unit",children:"What If You Need to Change the Base Unit?"}),"\n",(0,i.jsxs)(n.p,{children:["Use the ",(0,i.jsx)(n.code,{children:"changeDefaultValue()"})," method to designate a different unit as the base:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"use JobMetric\\UnitConverter\\Facades\\UnitConverter;\n\n// Scenario: You want Kilogram to be the base unit instead of Gram\n\n// Find the kilogram unit\n$kilogram = UnitConverter::findUnitByCode('kg');\n\n// Make it the base unit\n$response = UnitConverter::changeDefaultValue($kilogram->id);\n\nif ($response->ok) {\n    // All other units in the type are automatically recalculated\n    // Kilogram: value = 1 (new base)\n    // Gram: value = 0.001 (was 1, now relative to kg)\n    // Ton: value = 1000 (was 1000000, now relative to kg)\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"related-exceptions",children:"Related Exceptions"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./unit-type-default-value",children:"UnitTypeDefaultValueException"})," - When first unit doesn't have value = 1"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./unit-type-cannot-change-default-value",children:"UnitTypeCannotChangeDefaultValueException"})," - When trying to modify base unit's value"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./cannot-delete-default-value",children:"CannotDeleteDefaultValueException"})," - When trying to delete base unit"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);