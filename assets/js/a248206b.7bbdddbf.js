"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[7620],{6670(e,l,t){t.r(l),t.d(l,{assets:()=>i,contentTitle:()=>a,default:()=>c,frontMatter:()=>o,metadata:()=>n,toc:()=>u});const n=JSON.parse('{"id":"laravel-flow/deep-diving/requests/set-rollout-request","title":"SetRolloutRequest","description":"Form request class for validating rollout percentage updates for flows. This request ensures that rollout percentages are within valid range (0-100).","source":"@site/packages/laravel-flow/deep-diving/requests/set-rollout-request.md","sourceDirName":"laravel-flow/deep-diving/requests","slug":"/laravel-flow/deep-diving/requests/set-rollout-request","permalink":"/packages/laravel-flow/deep-diving/requests/set-rollout-request","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-flow/deep-diving/requests/set-rollout-request.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"sidebar_label":"SetRolloutRequest"},"sidebar":"packagesSidebar","previous":{"title":"SetActiveWindowRequest","permalink":"/packages/laravel-flow/deep-diving/requests/set-active-window-request"},"next":{"title":"StoreFlowStateRequest","permalink":"/packages/laravel-flow/deep-diving/requests/store-flow-state-request"}}');var s=t(4848),r=t(8453);const o={sidebar_position:5,sidebar_label:"SetRolloutRequest"},a="SetRolloutRequest",i={},u=[{value:"Namespace",id:"namespace",level:2},{value:"Overview",id:"overview",level:2},{value:"Validation Rules",id:"validation-rules",level:2},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Set Rollout Percentage",id:"set-rollout-percentage",level:3},{value:"Request Data Formats",id:"request-data-formats",level:3},{value:"Full Rollout (100%)",id:"full-rollout-100",level:4},{value:"Partial Rollout (50%)",id:"partial-rollout-50",level:4},{value:"Gradual Rollout (10%)",id:"gradual-rollout-10",level:4},{value:"Disable Rollout (0%)",id:"disable-rollout-0",level:4},{value:"Clear Rollout (null)",id:"clear-rollout-null",level:4},{value:"Complete Example",id:"complete-example",level:3},{value:"Integration with Flow Service",id:"integration-with-flow-service",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Validation Errors",id:"validation-errors",level:3},{value:"Invalid Values",id:"invalid-values",level:3},{value:"Use Cases",id:"use-cases",level:2},{value:"A/B Testing",id:"ab-testing",level:3},{value:"Canary Deployments",id:"canary-deployments",level:3},{value:"Feature Flags",id:"feature-flags",level:3},{value:"Regional Rollouts",id:"regional-rollouts",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function d(e){const l={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.header,{children:(0,s.jsx)(l.h1,{id:"setrolloutrequest",children:"SetRolloutRequest"})}),"\n",(0,s.jsx)(l.p,{children:"Form request class for validating rollout percentage updates for flows. This request ensures that rollout percentages are within valid range (0-100)."}),"\n",(0,s.jsx)(l.h2,{id:"namespace",children:"Namespace"}),"\n",(0,s.jsx)(l.p,{children:(0,s.jsx)(l.code,{children:"JobMetric\\Flow\\Http\\Requests\\Flow\\SetRolloutRequest"})}),"\n",(0,s.jsx)(l.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsxs)(l.p,{children:["The ",(0,s.jsx)(l.code,{children:"SetRolloutRequest"})," validates rollout percentage input when setting or updating the rollout percentage for a flow. Rollout percentage determines what percentage of subjects should use this flow."]}),"\n",(0,s.jsx)(l.h2,{id:"validation-rules",children:"Validation Rules"}),"\n",(0,s.jsxs)(l.table,{children:[(0,s.jsx)(l.thead,{children:(0,s.jsxs)(l.tr,{children:[(0,s.jsx)(l.th,{children:"Field"}),(0,s.jsx)(l.th,{children:"Rule"}),(0,s.jsx)(l.th,{children:"Description"})]})}),(0,s.jsx)(l.tbody,{children:(0,s.jsxs)(l.tr,{children:[(0,s.jsx)(l.td,{children:(0,s.jsx)(l.code,{children:"rollout_pct"})}),(0,s.jsx)(l.td,{children:(0,s.jsx)(l.code,{children:"nullable|integer|between:0,100"})}),(0,s.jsx)(l.td,{children:"Rollout percentage (0-100)"})]})})]}),"\n",(0,s.jsx)(l.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,s.jsx)(l.h3,{id:"set-rollout-percentage",children:"Set Rollout Percentage"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-php",children:"use JobMetric\\Flow\\Http\\Requests\\Flow\\SetRolloutRequest;\nuse JobMetric\\Flow\\Facades\\Flow;\n\npublic function setRollout(SetRolloutRequest $request, $id)\n{\n    $validated = $request->validated();\n    \n    Flow::setRollout($id, $validated['rollout_pct']);\n    \n    return response()->json(['message' => 'Rollout percentage updated']);\n}\n"})}),"\n",(0,s.jsx)(l.h3,{id:"request-data-formats",children:"Request Data Formats"}),"\n",(0,s.jsx)(l.h4,{id:"full-rollout-100",children:"Full Rollout (100%)"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-php",children:"$requestData = [\n    'rollout_pct' => 100, // All subjects use this flow\n];\n"})}),"\n",(0,s.jsx)(l.h4,{id:"partial-rollout-50",children:"Partial Rollout (50%)"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-php",children:"$requestData = [\n    'rollout_pct' => 50, // Half of subjects use this flow\n];\n"})}),"\n",(0,s.jsx)(l.h4,{id:"gradual-rollout-10",children:"Gradual Rollout (10%)"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-php",children:"$requestData = [\n    'rollout_pct' => 10, // Only 10% of subjects use this flow\n];\n"})}),"\n",(0,s.jsx)(l.h4,{id:"disable-rollout-0",children:"Disable Rollout (0%)"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-php",children:"$requestData = [\n    'rollout_pct' => 0, // No subjects use this flow\n];\n"})}),"\n",(0,s.jsx)(l.h4,{id:"clear-rollout-null",children:"Clear Rollout (null)"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-php",children:"$requestData = [\n    'rollout_pct' => null, // Rollout percentage removed\n];\n"})}),"\n",(0,s.jsx)(l.h3,{id:"complete-example",children:"Complete Example"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-php",children:'// POST /api/flows/1/set-rollout\n{\n    "rollout_pct": 25\n}\n\n// This sets the flow to be used by 25% of subjects\n'})}),"\n",(0,s.jsx)(l.h2,{id:"integration-with-flow-service",children:"Integration with Flow Service"}),"\n",(0,s.jsxs)(l.p,{children:["The request is typically used with the ",(0,s.jsx)(l.code,{children:"Flow::setRollout()"})," method:"]}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-php",children:"use JobMetric\\Flow\\Facades\\Flow;\n\npublic function setRollout(SetRolloutRequest $request, $id)\n{\n    $rolloutPct = $request->validated()['rollout_pct'];\n    \n    Flow::setRollout($id, $rolloutPct);\n    \n    return response()->json(['message' => 'Rollout percentage updated']);\n}\n"})}),"\n",(0,s.jsx)(l.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,s.jsx)(l.h3,{id:"validation-errors",children:"Validation Errors"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-json",children:'{\n    "message": "The given data was invalid.",\n    "errors": {\n        "rollout_pct": [\n            "The rollout pct must be between 0 and 100."\n        ]\n    }\n}\n'})}),"\n",(0,s.jsx)(l.h3,{id:"invalid-values",children:"Invalid Values"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-php",children:"// \u274c Invalid - Out of range\n'rollout_pct' => 150, // Must be 100 or less\n'rollout_pct' => -10, // Must be >= 0\n\n// \u274c Invalid - Wrong type\n'rollout_pct' => '50', // Must be integer\n'rollout_pct' => 50.5, // Must be integer\n"})}),"\n",(0,s.jsx)(l.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,s.jsx)(l.h3,{id:"ab-testing",children:"A/B Testing"}),"\n",(0,s.jsx)(l.p,{children:"Gradually roll out a new flow to test its effectiveness:"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-php",children:"// Phase 1: 10% rollout\n'rollout_pct' => 10,\n\n// Phase 2: 25% rollout\n'rollout_pct' => 25,\n\n// Phase 3: 50% rollout\n'rollout_pct' => 50,\n\n// Phase 4: 100% rollout\n'rollout_pct' => 100,\n"})}),"\n",(0,s.jsx)(l.h3,{id:"canary-deployments",children:"Canary Deployments"}),"\n",(0,s.jsx)(l.p,{children:"Test new flows with a small percentage before full deployment:"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-php",children:"// Start with 5% canary\n'rollout_pct' => 5,\n\n// Gradually increase\n'rollout_pct' => 20,\n'rollout_pct' => 50,\n'rollout_pct' => 100,\n"})}),"\n",(0,s.jsx)(l.h3,{id:"feature-flags",children:"Feature Flags"}),"\n",(0,s.jsx)(l.p,{children:"Control feature availability using rollout percentage:"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-php",children:"// Feature enabled for 30% of users\n'rollout_pct' => 30,\n\n// Disable feature\n'rollout_pct' => 0,\n"})}),"\n",(0,s.jsx)(l.h3,{id:"regional-rollouts",children:"Regional Rollouts"}),"\n",(0,s.jsx)(l.p,{children:"Roll out flows to specific regions gradually:"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-php",children:"// Start with small region\n'rollout_pct' => 10,\n\n// Expand to more regions\n'rollout_pct' => 50,\n'rollout_pct' => 100,\n"})}),"\n",(0,s.jsx)(l.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsxs)(l.ol,{children:["\n",(0,s.jsxs)(l.li,{children:["\n",(0,s.jsxs)(l.p,{children:[(0,s.jsx)(l.strong,{children:"Gradual Rollouts"}),": Start with small percentages and increase gradually"]}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-php",children:"// \u2705 Good - Gradual rollout\n10% \u2192 25% \u2192 50% \u2192 100%\n\n// \u26a0\ufe0f Risky - Immediate full rollout\n0% \u2192 100%\n"})}),"\n"]}),"\n",(0,s.jsxs)(l.li,{children:["\n",(0,s.jsxs)(l.p,{children:[(0,s.jsx)(l.strong,{children:"Monitor Performance"}),": Monitor flow performance at each rollout stage"]}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-php",children:"// Monitor metrics before increasing\nif ($metrics->isHealthy()) {\n    $rolloutPct = min($rolloutPct + 10, 100);\n}\n"})}),"\n"]}),"\n",(0,s.jsxs)(l.li,{children:["\n",(0,s.jsxs)(l.p,{children:[(0,s.jsx)(l.strong,{children:"Use Integer Values"}),": Always use integer percentages"]}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-php",children:"// \u2705 Good\n'rollout_pct' => 25\n\n// \u274c Bad\n'rollout_pct' => 25.5\n"})}),"\n"]}),"\n",(0,s.jsxs)(l.li,{children:["\n",(0,s.jsxs)(l.p,{children:[(0,s.jsx)(l.strong,{children:"Handle Null Values"}),': Consider null as "no rollout restriction"']}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-php",children:"// Null means no rollout percentage set\n'rollout_pct' => null\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(l.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,s.jsxs)(l.ul,{children:["\n",(0,s.jsxs)(l.li,{children:[(0,s.jsx)(l.a,{href:"/packages/laravel-flow/deep-diving/services/flow",children:"Flow Service"})," - Learn about flow management and rollout"]}),"\n",(0,s.jsxs)(l.li,{children:[(0,s.jsx)(l.a,{href:"/packages/laravel-flow/deep-diving/support/flow-picker-builder",children:"FlowPickerBuilder"})," - Flow selection with rollout"]}),"\n"]})]})}function c(e={}){const{wrapper:l}={...(0,r.R)(),...e.components};return l?(0,s.jsx)(l,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453(e,l,t){t.d(l,{R:()=>o,x:()=>a});var n=t(6540);const s={},r=n.createContext(s);function o(e){const l=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(l):{...l,...e}},[l,e])}function a(e){let l;return l=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(r.Provider,{value:l},e.children)}}}]);