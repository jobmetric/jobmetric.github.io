"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[2196],{6219(e,n,s){s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>l,toc:()=>c});const l=JSON.parse('{"id":"laravel-flow/deep-diving/resources/flow-resource","title":"FlowResource","description":"JSON resource class for transforming Flow models into structured API responses. This resource provides a consistent format for flow data with conditional relation loading.","source":"@site/packages/laravel-flow/deep-diving/resources/flow-resource.md","sourceDirName":"laravel-flow/deep-diving/resources","slug":"/laravel-flow/deep-diving/resources/flow-resource","permalink":"/packages/laravel-flow/deep-diving/resources/flow-resource","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-flow/deep-diving/resources/flow-resource.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"sidebar_label":"FlowResource"},"sidebar":"packagesSidebar","previous":{"title":"UpdateFlowTransitionRequest","permalink":"/packages/laravel-flow/deep-diving/requests/update-flow-transition-request"},"next":{"title":"FlowStateResource","permalink":"/packages/laravel-flow/deep-diving/resources/flow-state-resource"}}');var i=s(4848),r=s(8453);const t={sidebar_position:1,sidebar_label:"FlowResource"},d="FlowResource",o={},c=[{value:"Namespace",id:"namespace",level:2},{value:"Overview",id:"overview",level:2},{value:"Base Properties",id:"base-properties",level:2},{value:"Conditional Properties",id:"conditional-properties",level:2},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Basic Usage",id:"basic-usage",level:3},{value:"With Relations",id:"with-relations",level:3},{value:"In Collections",id:"in-collections",level:3},{value:"In API Responses",id:"in-api-responses",level:3},{value:"Response Examples",id:"response-examples",level:2},{value:"Basic Response",id:"basic-response",level:3},{value:"With Translations",id:"with-translations",level:3},{value:"With Relations",id:"with-relations-1",level:3},{value:"Relation Loading",id:"relation-loading",level:2},{value:"Eager Loading Relations",id:"eager-loading-relations",level:3},{value:"Selective Loading",id:"selective-loading",level:3},{value:"Nested Relations",id:"nested-relations",level:3},{value:"Timestamp Format",id:"timestamp-format",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"flowresource",children:"FlowResource"})}),"\n",(0,i.jsx)(n.p,{children:"JSON resource class for transforming Flow models into structured API responses. This resource provides a consistent format for flow data with conditional relation loading."}),"\n",(0,i.jsx)(n.h2,{id:"namespace",children:"Namespace"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"JobMetric\\Flow\\Http\\Resources\\FlowResource"})}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"FlowResource"})," transforms Flow model instances into structured JSON responses. It includes:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Core flow properties"}),"\n",(0,i.jsx)(n.li,{children:"Multi-language translations"}),"\n",(0,i.jsx)(n.li,{children:"ISO 8601 formatted timestamps"}),"\n",(0,i.jsx)(n.li,{children:"Conditional relation loading"}),"\n",(0,i.jsx)(n.li,{children:"Nested resource transformations"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"base-properties",children:"Base Properties"}),"\n",(0,i.jsx)(n.p,{children:"The resource always includes these properties:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Property"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"id"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"int"})}),(0,i.jsx)(n.td,{children:"Flow ID"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"subject_type"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"string"})}),(0,i.jsx)(n.td,{children:"Model class name that uses this flow"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"subject_scope"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"string|null"})}),(0,i.jsx)(n.td,{children:"Optional scope identifier"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"subject_collection"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"string|null"})}),(0,i.jsx)(n.td,{children:"Optional collection identifier"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"version"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"int"})}),(0,i.jsx)(n.td,{children:"Flow version number"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"is_default"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"bool"})}),(0,i.jsx)(n.td,{children:"Whether this is the default flow"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"status"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"bool"})}),(0,i.jsx)(n.td,{children:"Active/inactive status"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"channel"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"string|null"})}),(0,i.jsx)(n.td,{children:"Channel identifier"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ordering"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"int"})}),(0,i.jsx)(n.td,{children:"Display order"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"rollout_pct"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"int|null"})}),(0,i.jsx)(n.td,{children:"Rollout percentage (0-100)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"environment"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"string|null"})}),(0,i.jsx)(n.td,{children:"Environment identifier"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"active_from"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"string|null"})}),(0,i.jsx)(n.td,{children:"ISO 8601 formatted start date"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"active_to"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"string|null"})}),(0,i.jsx)(n.td,{children:"ISO 8601 formatted end date"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"deleted_at"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"string|null"})}),(0,i.jsx)(n.td,{children:"ISO 8601 formatted deletion date"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"created_at"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"string"})}),(0,i.jsx)(n.td,{children:"ISO 8601 formatted creation date"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"updated_at"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"string"})}),(0,i.jsx)(n.td,{children:"ISO 8601 formatted update date"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"conditional-properties",children:"Conditional Properties"}),"\n",(0,i.jsx)(n.p,{children:"These properties are only included when their relations are loaded:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Property"}),(0,i.jsx)(n.th,{children:"Relation"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"translations"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"translations"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"object"})}),(0,i.jsx)(n.td,{children:"Multi-language translations"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"states"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"states"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"array"})}),(0,i.jsx)(n.td,{children:"Collection of FlowStateResource"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"transitions"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"transitions"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"array"})}),(0,i.jsx)(n.td,{children:"Collection of FlowTransitionResource"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"tasks"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"tasks"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"array"})}),(0,i.jsx)(n.td,{children:"Collection of FlowTaskResource"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"flow_instances"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"flowInstances"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"array"})}),(0,i.jsx)(n.td,{children:"Collection of FlowInstanceResource"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"uses"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"uses"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"array"})}),(0,i.jsx)(n.td,{children:"Collection of FlowUseResource"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"start_state"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"startState"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"object|null"})}),(0,i.jsx)(n.td,{children:"FlowStateResource for START state"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"end_state"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"endState"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"object|null"})}),(0,i.jsx)(n.td,{children:"FlowStateResource for END state"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,i.jsx)(n.h3,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"use JobMetric\\Flow\\Http\\Resources\\FlowResource;\nuse JobMetric\\Flow\\Models\\Flow;\n\n$flow = Flow::find(1);\n\nreturn FlowResource::make($flow);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"with-relations",children:"With Relations"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"$flow = Flow::with([\n    'states',\n    'transitions',\n    'startState',\n    'endState',\n])->find(1);\n\nreturn FlowResource::make($flow);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"in-collections",children:"In Collections"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"$flows = Flow::with('states')->get();\n\nreturn FlowResource::collection($flows);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"in-api-responses",children:"In API Responses"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"use JobMetric\\Flow\\Facades\\Flow;\n\npublic function show($id)\n{\n    $flow = Flow::query()\n        ->with(['states', 'transitions', 'startState'])\n        ->findOrFail($id);\n\n    return new FlowResource($flow);\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"response-examples",children:"Response Examples"}),"\n",(0,i.jsx)(n.h3,{id:"basic-response",children:"Basic Response"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "id": 1,\n    "subject_type": "App\\\\Models\\\\Order",\n    "subject_scope": null,\n    "subject_collection": null,\n    "version": 1,\n    "is_default": true,\n    "status": true,\n    "channel": "web",\n    "ordering": 0,\n    "rollout_pct": 100,\n    "environment": "production",\n    "active_from": "2024-01-01T00:00:00.000000Z",\n    "active_to": "2024-12-31T23:59:59.000000Z",\n    "deleted_at": null,\n    "created_at": "2024-01-01T00:00:00.000000Z",\n    "updated_at": "2024-01-01T00:00:00.000000Z"\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"with-translations",children:"With Translations"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "id": 1,\n    "translations": {\n        "en": {\n            "name": "Order Processing Workflow",\n            "description": "Handles order processing"\n        },\n        "fa": {\n            "name": "\u06af\u0631\u062f\u0634 \u06a9\u0627\u0631 \u067e\u0631\u062f\u0627\u0632\u0634 \u0633\u0641\u0627\u0631\u0634",\n            "description": "\u067e\u0631\u062f\u0627\u0632\u0634 \u0633\u0641\u0627\u0631\u0634"\n        }\n    },\n    "subject_type": "App\\\\Models\\\\Order",\n    // ... other fields\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"with-relations-1",children:"With Relations"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "id": 1,\n    "subject_type": "App\\\\Models\\\\Order",\n    "states": [\n        {\n            "id": 1,\n            "flow_id": 1,\n            "type": "start",\n            "status": null,\n            // ... FlowStateResource fields\n        }\n    ],\n    "transitions": [\n        {\n            "id": 1,\n            "flow_id": 1,\n            "from": 1,\n            "to": 2,\n            // ... FlowTransitionResource fields\n        }\n    ],\n    "start_state": {\n        "id": 1,\n        "flow_id": 1,\n        "type": "start",\n        // ... FlowStateResource fields\n    },\n    "end_state": {\n        "id": 5,\n        "flow_id": 1,\n        "type": "middle",\n        "is_end": true,\n        // ... FlowStateResource fields\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"relation-loading",children:"Relation Loading"}),"\n",(0,i.jsx)(n.h3,{id:"eager-loading-relations",children:"Eager Loading Relations"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// Load all relations\n$flow = Flow::with([\n    'translations',\n    'states',\n    'transitions',\n    'tasks',\n    'flowInstances',\n    'uses',\n    'startState',\n    'endState',\n])->find(1);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"selective-loading",children:"Selective Loading"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// Load only needed relations\n$flow = Flow::with(['states', 'transitions'])->find(1);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"nested-relations",children:"Nested Relations"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// Load nested relations\n$flow = Flow::with([\n    'states',\n    'transitions.tasks',\n    'transitions.fromState',\n    'transitions.toState',\n])->find(1);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"timestamp-format",children:"Timestamp Format"}),"\n",(0,i.jsx)(n.p,{children:"All timestamps are formatted as ISO 8601 strings:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:'// Database: 2024-01-01 00:00:00\n// Resource: "2024-01-01T00:00:00.000000Z"\n'})}),"\n",(0,i.jsx)(n.p,{children:"This ensures interoperability across different clients and timezones."}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Load Relations Efficiently"}),": Only load relations you need"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// \u2705 Good - Load only needed\nFlow::with(['states', 'transitions'])->get();\n\n// \u274c Bad - Load everything\nFlow::with(['states', 'transitions', 'tasks', 'flowInstances', 'uses'])->get();\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use Resource Collections"}),": Use collection for multiple items"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// \u2705 Good\nFlowResource::collection($flows);\n\n// \u274c Bad\nforeach ($flows as $flow) {\n    new FlowResource($flow);\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Handle Null Values"}),": Timestamps can be null"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// active_from, active_to, deleted_at can be null\nif ($flow->active_from) {\n    // Handle active window\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/packages/laravel-flow/deep-diving/services/flow",children:"Flow Service"})," - Learn about flow management"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/packages/laravel-flow/deep-diving/resources/flow-state-resource",children:"FlowStateResource"})," - State resource"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/packages/laravel-flow/deep-diving/resources/flow-transition-resource",children:"FlowTransitionResource"})," - Transition resource"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453(e,n,s){s.d(n,{R:()=>t,x:()=>d});var l=s(6540);const i={},r=l.createContext(i);function t(e){const n=l.useContext(r);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),l.createElement(r.Provider,{value:n},e.children)}}}]);