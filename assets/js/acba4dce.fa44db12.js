"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[24],{26991(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>l,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"laravel-language/deep-diving/support/helpers","title":"Helper Functions","description":"Laravel Language provides three global helper functions for timezone handling. These functions work seamlessly with SetTimezoneMiddleware to provide timezone-aware date formatting and conversion.","source":"@site/packages/laravel-language/deep-diving/support/helpers.md","sourceDirName":"laravel-language/deep-diving/support","slug":"/laravel-language/deep-diving/support/helpers","permalink":"/packages/laravel-language/deep-diving/support/helpers","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-language/deep-diving/support/helpers.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"sidebar_label":"Helper Functions"},"sidebar":"packagesSidebar","previous":{"title":"CurrentLanguage","permalink":"/packages/laravel-language/deep-diving/support/current-language"},"next":{"title":"DateBasedOnCalendarCast","permalink":"/packages/laravel-language/deep-diving/date-based-on-calendar-cast"}}');var s=t(74848),r=t(28453),i=t(28774);const l={sidebar_position:2,sidebar_label:"Helper Functions"},o="Helper Functions",d={},c=[{value:"Overview",id:"overview",level:2},{value:"client_timezone()",id:"client_timezone",level:2},{value:"Basic Usage",id:"basic-usage",level:3},{value:"Example: Display Current Timezone",id:"example-display-current-timezone",level:3},{value:"Example: Timezone-Aware Queries",id:"example-timezone-aware-queries",level:3},{value:"tz_format()",id:"tz_format",level:2},{value:"Supported Input Types",id:"supported-input-types",level:3},{value:"Basic Usage",id:"basic-usage-1",level:3},{value:"Example 1: Event Display",id:"example-1-event-display",level:3},{value:"Example 2: Order Timestamps",id:"example-2-order-timestamps",level:3},{value:"Example 3: Explicit Timezone Conversion",id:"example-3-explicit-timezone-conversion",level:3},{value:"Example 4: Unix Timestamp Formatting",id:"example-4-unix-timestamp-formatting",level:3},{value:"Example 5: Blade Template Usage",id:"example-5-blade-template-usage",level:3},{value:"tz_carbon()",id:"tz_carbon",level:2},{value:"Basic Usage",id:"basic-usage-2",level:3},{value:"Example 1: Date Calculations",id:"example-1-date-calculations",level:3},{value:"Example 2: Time Range Queries",id:"example-2-time-range-queries",level:3},{value:"Example 3: Relative Time Display",id:"example-3-relative-time-display",level:3},{value:"Example 4: Date Comparisons",id:"example-4-date-comparisons",level:3},{value:"Example 5: Explicit Timezone Conversion",id:"example-5-explicit-timezone-conversion",level:3},{value:"Complete Examples",id:"complete-examples",level:2},{value:"Example 1: Event Management System",id:"example-1-event-management-system",level:3},{value:"Example 2: Order Tracking",id:"example-2-order-tracking",level:3},{value:"Example 3: Analytics Dashboard",id:"example-3-analytics-dashboard",level:3},{value:"Example 4: Notification System",id:"example-4-notification-system",level:3},{value:"Example 5: Blade Components",id:"example-5-blade-components",level:3},{value:"When to Use Helper Functions",id:"when-to-use-helper-functions",level:2},{value:"Primary Use Cases",id:"primary-use-cases",level:3},{value:"1. API Responses",id:"1-api-responses",level:4},{value:"2. Display Logic",id:"2-display-logic",level:4},{value:"3. Date Calculations",id:"3-date-calculations",level:4},{value:"4. Relative Time Display",id:"4-relative-time-display",level:4},{value:"When NOT to Use",id:"when-not-to-use",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Always Store in UTC",id:"1-always-store-in-utc",level:3},{value:"2. Use Helpers for Display Only",id:"2-use-helpers-for-display-only",level:3},{value:"3. Combine with Middleware",id:"3-combine-with-middleware",level:3},{value:"4. Use Appropriate Format",id:"4-use-appropriate-format",level:3},{value:"Common Mistakes to Avoid",id:"common-mistakes-to-avoid",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function m(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"helper-functions",children:"Helper Functions"})}),"\n",(0,s.jsxs)(n.p,{children:["Laravel Language provides three global helper functions for timezone handling. These functions work seamlessly with ",(0,s.jsx)(n.code,{children:"SetTimezoneMiddleware"})," to provide timezone-aware date formatting and conversion."]}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"The helper functions:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"client_timezone()"}),": Get the current client timezone"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"tz_format()"}),": Format dates in client's timezone"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"tz_carbon()"}),": Get Carbon instances in client's timezone"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["All functions automatically use the timezone set by ",(0,s.jsx)(n.code,{children:"SetTimezoneMiddleware"})," via ",(0,s.jsx)(n.code,{children:"config('app.client_timezone')"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"client_timezone",children:"client_timezone()"}),"\n",(0,s.jsxs)(n.p,{children:["Get the effective client timezone resolved by ",(0,s.jsx)(n.code,{children:"SetTimezoneMiddleware"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"function client_timezone(): string\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"string"})," - Timezone identifier (e.g., 'America/New_York', 'Asia/Tehran')"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Priority:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"config('app.client_timezone')"})," (set by middleware)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"config('app.timezone')"})," (fallback)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"'UTC'"})," (final fallback)"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"$timezone = client_timezone();\n// Returns: 'America/New_York' (if middleware set it)\n// Or: 'UTC' (if no middleware)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-display-current-timezone",children:"Example: Display Current Timezone"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// In controller\npublic function settings()\n{\n    return response()->json([\n        'timezone' => client_timezone(),\n        'current_time' => now()->setTimezone(client_timezone())->format('Y-m-d H:i:s'),\n    ]);\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-timezone-aware-queries",children:"Example: Timezone-Aware Queries"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// Get events in user's timezone\n$timezone = client_timezone();\n$startOfDay = Carbon::now($timezone)->startOfDay();\n$endOfDay = Carbon::now($timezone)->endOfDay();\n\n$events = Event::whereBetween('starts_at', [$startOfDay, $endOfDay])->get();\n"})}),"\n",(0,s.jsx)(n.h2,{id:"tz_format",children:"tz_format()"}),"\n",(0,s.jsx)(n.p,{children:"Format a date/time value into the client's timezone."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"function tz_format(\n    Carbon|DateTimeInterface|int|string $value,\n    string $format = 'Y-m-d H:i:s',\n    ?string $tz = null,\n    ?string $fromTz = null\n): string\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"$value"})," (",(0,s.jsx)(n.code,{children:"Carbon|DateTimeInterface|int|string"}),"): Date/time value to format"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"$format"})," (",(0,s.jsx)(n.code,{children:"string"}),"): Format string (default: ",(0,s.jsx)(n.code,{children:"'Y-m-d H:i:s'"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"$tz"})," (",(0,s.jsx)(n.code,{children:"string|null"}),"): Target timezone (default: ",(0,s.jsx)(n.code,{children:"client_timezone()"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"$fromTz"})," (",(0,s.jsx)(n.code,{children:"string|null"}),"): Source timezone (default: ",(0,s.jsx)(n.code,{children:"config('app.timezone')"}),")"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"string"})," - Formatted date string"]}),"\n",(0,s.jsx)(n.h3,{id:"supported-input-types",children:"Supported Input Types"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Carbon instances"}),": ",(0,s.jsx)(n.code,{children:"Carbon::now()"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"DateTimeInterface"}),": ",(0,s.jsx)(n.code,{children:"new DateTime()"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Unix timestamps"}),": ",(0,s.jsx)(n.code,{children:"1703520000"})," (integer)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"String timestamps"}),": ",(0,s.jsx)(n.code,{children:"'1703520000'"})," (numeric string)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Date strings"}),": ",(0,s.jsx)(n.code,{children:"'2024-12-25 14:30:00'"})]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"basic-usage-1",children:"Basic Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:'// Format current time in client timezone\n$formatted = tz_format(now());\n// Returns: "2024-12-25 09:30:00" (if client is in New York, server is UTC)\n\n// Custom format\n$formatted = tz_format(now(), \'Y-m-d H:i:s A\');\n// Returns: "2024-12-25 09:30:00 AM"\n'})}),"\n",(0,s.jsx)(n.h3,{id:"example-1-event-display",children:"Example 1: Event Display"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// app/Http/Controllers/EventController.php\npublic function show(Event $event)\n{\n    return response()->json([\n        'id' => $event->id,\n        'title' => $event->title,\n        'starts_at' => tz_format($event->starts_at),\n        'starts_at_formatted' => tz_format($event->starts_at, 'l, F j, Y \\a\\t g:i A'),\n        'timezone' => client_timezone(),\n    ]);\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Response"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n    "id": 1,\n    "title": "Conference",\n    "starts_at": "2024-12-25 09:00:00",\n    "starts_at_formatted": "Wednesday, December 25, 2024 at 9:00 AM",\n    "timezone": "America/New_York"\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"example-2-order-timestamps",children:"Example 2: Order Timestamps"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// app/Http/Controllers/OrderController.php\npublic function show(Order $order)\n{\n    return response()->json([\n        'order_number' => $order->number,\n        'placed_at' => tz_format($order->created_at, 'Y-m-d H:i:s'),\n        'estimated_delivery' => tz_format($order->estimated_delivery, 'F j, Y'),\n        'timezone' => client_timezone(),\n    ]);\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-3-explicit-timezone-conversion",children:"Example 3: Explicit Timezone Conversion"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// Convert from UTC to specific timezone\n$utcDate = '2024-12-25 12:00:00';\n$tehranDate = tz_format($utcDate, 'Y-m-d H:i:s', 'Asia/Tehran', 'UTC');\n// Returns: \"2024-12-25 15:30:00\" (UTC+3:30)\n\n// Convert from one timezone to another\n$newYorkDate = tz_format($utcDate, 'Y-m-d H:i:s', 'America/New_York', 'UTC');\n// Returns: \"2024-12-25 07:00:00\" (UTC-5)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-4-unix-timestamp-formatting",children:"Example 4: Unix Timestamp Formatting"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// Format Unix timestamp\n$timestamp = 1703520000; // 2023-12-25 12:00:00 UTC\n$formatted = tz_format($timestamp, 'Y-m-d H:i:s');\n// Returns formatted date in client timezone\n\n// String timestamp\n$formatted = tz_format('1703520000', 'Y-m-d H:i:s');\n// Also works\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-5-blade-template-usage",children:"Example 5: Blade Template Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-blade",children:"{{-- Display event time in user's timezone --}}\n<div class=\"event-time\">\n    <strong>Starts:</strong> {{ tz_format($event->starts_at, 'F j, Y \\a\\t g:i A') }}\n    <small>({{ client_timezone() }})</small>\n</div>\n"})}),"\n",(0,s.jsx)(n.h2,{id:"tz_carbon",children:"tz_carbon()"}),"\n",(0,s.jsx)(n.p,{children:"Convert an input into a Carbon instance adjusted to the client's timezone."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"function tz_carbon(\n    Carbon|DateTimeInterface|int|string $value,\n    ?string $tz = null,\n    ?string $fromTz = null\n): Carbon\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"$value"})," (",(0,s.jsx)(n.code,{children:"Carbon|DateTimeInterface|int|string"}),"): Date/time value"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"$tz"})," (",(0,s.jsx)(n.code,{children:"string|null"}),"): Target timezone (default: ",(0,s.jsx)(n.code,{children:"client_timezone()"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"$fromTz"})," (",(0,s.jsx)(n.code,{children:"string|null"}),"): Source timezone (default: ",(0,s.jsx)(n.code,{children:"config('app.timezone')"}),")"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Carbon"})," - Carbon instance in target timezone"]}),"\n",(0,s.jsx)(n.h3,{id:"basic-usage-2",children:"Basic Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// Get Carbon instance in client timezone\n$carbon = tz_carbon(now());\n// Returns: Carbon instance in client timezone\n\n// Use Carbon methods\n$formatted = tz_carbon(now())->format('Y-m-d H:i:s');\n$diff = tz_carbon(now())->diffForHumans();\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-1-date-calculations",children:"Example 1: Date Calculations"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// Calculate days until event\n$eventDate = tz_carbon($event->starts_at);\n$daysUntil = now($eventDate->timezone)->diffInDays($eventDate);\n\nreturn response()->json([\n    'event_date' => $eventDate->format('Y-m-d H:i:s'),\n    'days_until' => $daysUntil,\n    'human_readable' => $eventDate->diffForHumans(),\n]);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-2-time-range-queries",children:"Example 2: Time Range Queries"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// Get today's events in user's timezone\n$timezone = client_timezone();\n$startOfDay = tz_carbon(now())->startOfDay();\n$endOfDay = tz_carbon(now())->endOfDay();\n\n$events = Event::whereBetween('starts_at', [\n    $startOfDay->utc(),\n    $endOfDay->utc()\n])->get();\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-3-relative-time-display",children:"Example 3: Relative Time Display"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// app/Http/Controllers/PostController.php\npublic function index()\n{\n    $posts = Post::latest()->get()->map(function ($post) {\n        return [\n            'id' => $post->id,\n            'content' => $post->content,\n            'posted_at' => tz_carbon($post->created_at)->diffForHumans(),\n            'posted_time' => tz_carbon($post->created_at)->format('g:i A'),\n        ];\n    });\n    \n    return response()->json($posts);\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Response"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'[\n    {\n        "id": 1,\n        "content": "Hello world",\n        "posted_at": "2 hours ago",\n        "posted_time": "3:45 PM"\n    }\n]\n'})}),"\n",(0,s.jsx)(n.h3,{id:"example-4-date-comparisons",children:"Example 4: Date Comparisons"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// Check if event is today\n$eventDate = tz_carbon($event->starts_at);\n$isToday = $eventDate->isToday();\n\n// Check if event is in the future\n$isFuture = $eventDate->isFuture();\n\n// Get time until event\n$timeUntil = $eventDate->diffForHumans();\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-5-explicit-timezone-conversion",children:"Example 5: Explicit Timezone Conversion"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// Convert to specific timezone\n$carbon = tz_carbon('2024-12-25 12:00:00', 'Asia/Tehran', 'UTC');\n// Returns: Carbon instance in Asia/Tehran timezone\n\n// Use for calculations\n$carbon->addDays(7);\n$carbon->startOfWeek();\n"})}),"\n",(0,s.jsx)(n.h2,{id:"complete-examples",children:"Complete Examples"}),"\n",(0,s.jsx)(n.h3,{id:"example-1-event-management-system",children:"Example 1: Event Management System"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// app/Http/Controllers/EventController.php\nclass EventController extends Controller\n{\n    public function index()\n    {\n        $timezone = client_timezone();\n        $now = tz_carbon(now());\n        \n        $events = Event::where('starts_at', '>=', $now->utc())\n            ->get()\n            ->map(function ($event) {\n                return [\n                    'id' => $event->id,\n                    'title' => $event->title,\n                    'starts_at' => tz_format($event->starts_at),\n                    'starts_at_carbon' => tz_carbon($event->starts_at),\n                    'time_until' => tz_carbon($event->starts_at)->diffForHumans(),\n                    'is_today' => tz_carbon($event->starts_at)->isToday(),\n                ];\n            });\n        \n        return response()->json([\n            'timezone' => $timezone,\n            'current_time' => tz_format(now()),\n            'events' => $events,\n        ]);\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-2-order-tracking",children:"Example 2: Order Tracking"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// app/Http/Controllers/OrderController.php\nclass OrderController extends Controller\n{\n    public function track(Order $order)\n    {\n        return response()->json([\n            'order_number' => $order->number,\n            'status' => $order->status,\n            'timeline' => [\n                'placed_at' => [\n                    'timestamp' => tz_format($order->created_at),\n                    'relative' => tz_carbon($order->created_at)->diffForHumans(),\n                ],\n                'confirmed_at' => $order->confirmed_at ? [\n                    'timestamp' => tz_format($order->confirmed_at),\n                    'relative' => tz_carbon($order->confirmed_at)->diffForHumans(),\n                ] : null,\n                'shipped_at' => $order->shipped_at ? [\n                    'timestamp' => tz_format($order->shipped_at),\n                    'relative' => tz_carbon($order->shipped_at)->diffForHumans(),\n                ] : null,\n            ],\n            'timezone' => client_timezone(),\n        ]);\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-3-analytics-dashboard",children:"Example 3: Analytics Dashboard"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// app/Http/Controllers/AnalyticsController.php\nclass AnalyticsController extends Controller\n{\n    public function daily()\n    {\n        $timezone = client_timezone();\n        $startOfDay = tz_carbon(now())->startOfDay();\n        $endOfDay = tz_carbon(now())->endOfDay();\n        \n        $metrics = [\n            'date' => tz_format(now(), 'Y-m-d'),\n            'timezone' => $timezone,\n            'visits' => Visit::whereBetween('created_at', [\n                $startOfDay->utc(),\n                $endOfDay->utc()\n            ])->count(),\n            'orders' => Order::whereBetween('created_at', [\n                $startOfDay->utc(),\n                $endOfDay->utc()\n            ])->count(),\n            'revenue' => Order::whereBetween('created_at', [\n                $startOfDay->utc(),\n                $endOfDay->utc()\n            ])->sum('total'),\n        ];\n        \n        return response()->json($metrics);\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-4-notification-system",children:"Example 4: Notification System"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// app/Services/NotificationService.php\nclass NotificationService\n{\n    public function sendEventReminder(Event $event, User $user)\n    {\n        $eventTime = tz_carbon($event->starts_at);\n        $timeUntil = $eventTime->diffForHumans();\n        \n        $user->notify(new EventReminder([\n            'event_title' => $event->title,\n            'event_time' => tz_format($event->starts_at, 'l, F j, Y \\a\\t g:i A'),\n            'time_until' => $timeUntil,\n            'timezone' => client_timezone(),\n        ]));\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-5-blade-components",children:"Example 5: Blade Components"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-blade",children:'{{-- resources/views/components/event-time.blade.php --}}\n@props([\'event\'])\n\n<div class="event-time" data-timezone="{{ client_timezone() }}">\n    <div class="date">\n        {{ tz_format($event->starts_at, \'F j, Y\') }}\n    </div>\n    <div class="time">\n        {{ tz_format($event->starts_at, \'g:i A\') }}\n    </div>\n    <div class="relative">\n        {{ tz_carbon($event->starts_at)->diffForHumans() }}\n    </div>\n</div>\n'})}),"\n",(0,s.jsx)(n.h2,{id:"when-to-use-helper-functions",children:"When to Use Helper Functions"}),"\n",(0,s.jsx)(n.h3,{id:"primary-use-cases",children:"Primary Use Cases"}),"\n",(0,s.jsx)(n.h4,{id:"1-api-responses",children:"1. API Responses"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"When"}),": Building APIs that return date/time data."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Why"}),": Ensures dates are in user's timezone."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"return response()->json([\n    'event_time' => tz_format($event->starts_at),\n    'timezone' => client_timezone(),\n]);\n"})}),"\n",(0,s.jsx)(n.h4,{id:"2-display-logic",children:"2. Display Logic"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"When"}),": Displaying dates in views or components."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Why"}),": Shows dates in user's local timezone."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-blade",children:"{{ tz_format($post->created_at, 'F j, Y \\a\\t g:i A') }}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"3-date-calculations",children:"3. Date Calculations"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"When"}),": Performing date calculations relative to user's timezone."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Why"}),": Ensures calculations are timezone-aware."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"$startOfDay = tz_carbon(now())->startOfDay();\n"})}),"\n",(0,s.jsx)(n.h4,{id:"4-relative-time-display",children:"4. Relative Time Display"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"When"}),': Showing "2 hours ago" style timestamps.']}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Why"}),": Carbon's ",(0,s.jsx)(n.code,{children:"diffForHumans()"})," works with timezone-aware dates."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"tz_carbon($post->created_at)->diffForHumans();\n"})}),"\n",(0,s.jsx)(n.h3,{id:"when-not-to-use",children:"When NOT to Use"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Database Storage"}),": Always store dates in UTC, don't use helpers for storage"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Internal Calculations"}),": For server-side calculations, use UTC directly"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Without Middleware"}),": Helpers require ",(0,s.jsx)(n.code,{children:"SetTimezoneMiddleware"})," to work properly"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsx)(n.h3,{id:"1-always-store-in-utc",children:"1. Always Store in UTC"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// \u2705 Good - Store in UTC\n$event->starts_at = Carbon::parse($request->input('starts_at'), $userTimezone)->utc();\n$event->save();\n\n// Display in user timezone\n$formatted = tz_format($event->starts_at);\n\n// \u274c Bad - Store in user timezone\n$event->starts_at = Carbon::parse($request->input('starts_at'), $userTimezone);\n$event->save();\n"})}),"\n",(0,s.jsx)(n.h3,{id:"2-use-helpers-for-display-only",children:"2. Use Helpers for Display Only"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// \u2705 Good - Use helpers for display\nreturn response()->json([\n    'starts_at' => tz_format($event->starts_at),\n]);\n\n// \u274c Bad - Use helpers for storage\n$event->starts_at = tz_carbon($request->input('starts_at'));\n"})}),"\n",(0,s.jsx)(n.h3,{id:"3-combine-with-middleware",children:"3. Combine with Middleware"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// \u2705 Good - Middleware sets timezone, helpers use it\n// SetTimezoneMiddleware sets config('app.client_timezone')\n$formatted = tz_format($date); // Uses client timezone\n\n// \u274c Bad - Helpers without middleware\n// No middleware, helpers fall back to config('app.timezone')\n"})}),"\n",(0,s.jsx)(n.h3,{id:"4-use-appropriate-format",children:"4. Use Appropriate Format"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// \u2705 Good - Appropriate format for context\ntz_format($date, 'Y-m-d H:i:s'); // API\ntz_format($date, 'F j, Y \\a\\t g:i A'); // Display\ntz_format($date, 'c'); // ISO 8601\n\n// \u274c Bad - Wrong format\ntz_format($date, 'Y-m-d'); // Missing time for time-sensitive data\n"})}),"\n",(0,s.jsx)(n.h2,{id:"common-mistakes-to-avoid",children:"Common Mistakes to Avoid"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Storing timezone-aware dates"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// \u274c Wrong\n$event->starts_at = tz_carbon($request->input('starts_at'));\n\n// \u2705 Correct\n$event->starts_at = Carbon::parse($request->input('starts_at'), $userTz)->utc();\n// Display: tz_format($event->starts_at)\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Not using middleware"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// \u274c Wrong - Helpers won't work properly\n// Without SetTimezoneMiddleware\n$formatted = tz_format($date);\n\n// \u2705 Correct - Register middleware\n// app/Http/Kernel.php\nprotected $middlewareGroups = [\n    'web' => [\n        \\JobMetric\\Language\\Http\\Middleware\\SetTimezoneMiddleware::class,\n    ],\n];\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Using for database queries"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// \u274c Wrong - Use UTC for queries\n$events = Event::where('starts_at', '>=', tz_carbon(now()));\n\n// \u2705 Correct - Convert to UTC\n$events = Event::where('starts_at', '>=', tz_carbon(now())->utc());\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Not handling null values"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// \u274c Wrong - May throw error\n$formatted = tz_format($order->shipped_at);\n\n// \u2705 Correct - Check for null\n$formatted = $order->shipped_at ? tz_format($order->shipped_at) : null;\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(i.A,{to:"/packages/laravel-language/deep-diving/middleware/set-timezone-middleware",children:"SetTimezoneMiddleware"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(i.A,{to:"/packages/laravel-language/deep-diving/support/current-language",children:"CurrentLanguage"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(i.A,{to:"/packages/laravel-language/deep-diving/models/language",children:"Language Model"}),"\n"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(m,{...e})}):m(e)}},28453(e,n,t){t.d(n,{R:()=>i,x:()=>l});var a=t(96540);const s={},r=a.createContext(s);function i(e){const n=a.useContext(r);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);