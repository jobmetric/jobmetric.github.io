"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[7293],{28453(e,t,s){s.d(t,{R:()=>a,x:()=>d});var n=s(96540);const l={},i=n.createContext(l);function a(e){const t=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),n.createElement(i.Provider,{value:t},e.children)}},78947(e,t,s){s.r(t),s.d(t,{assets:()=>r,contentTitle:()=>d,default:()=>h,frontMatter:()=>a,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"laravel-flow/deep-diving/requests/update-flow-state-request","title":"UpdateFlowStateRequest","description":"Form request class for validating FlowState update data. This request handles partial updates with context-aware validation, ensuring translation uniqueness while allowing selective field updates.","source":"@site/packages/laravel-flow/deep-diving/requests/update-flow-state-request.md","sourceDirName":"laravel-flow/deep-diving/requests","slug":"/laravel-flow/deep-diving/requests/update-flow-state-request","permalink":"/packages/laravel-flow/deep-diving/requests/update-flow-state-request","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-flow/deep-diving/requests/update-flow-state-request.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7,"sidebar_label":"UpdateFlowStateRequest"},"sidebar":"packagesSidebar","previous":{"title":"StoreFlowStateRequest","permalink":"/packages/laravel-flow/deep-diving/requests/store-flow-state-request"},"next":{"title":"StoreFlowTaskRequest","permalink":"/packages/laravel-flow/deep-diving/requests/store-flow-task-request"}}');var l=s(74848),i=s(28453);const a={sidebar_position:7,sidebar_label:"UpdateFlowStateRequest"},d="UpdateFlowStateRequest",r={},o=[{value:"Namespace",id:"namespace",level:2},{value:"Overview",id:"overview",level:2},{value:"Key Features",id:"key-features",level:2},{value:"Validation Rules",id:"validation-rules",level:2},{value:"Optional Fields",id:"optional-fields",level:3},{value:"Context Management",id:"context-management",level:2},{value:"Static Rules Method",id:"static-rules-method",level:2},{value:"rulesFor()",id:"rulesfor",level:3},{value:"Status Validation",id:"status-validation",level:2},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Basic Update",id:"basic-update",level:3},{value:"Partial Update - Status Only",id:"partial-update---status-only",level:3},{value:"Partial Update - Translation Only",id:"partial-update---translation-only",level:3},{value:"Update Visual Configuration",id:"update-visual-configuration",level:3},{value:"Update Multiple Fields",id:"update-multiple-fields",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Validation Errors",id:"validation-errors",level:3},{value:"Differences from StoreFlowStateRequest",id:"differences-from-storeflowstaterequest",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function c(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t.header,{children:(0,l.jsx)(t.h1,{id:"updateflowstaterequest",children:"UpdateFlowStateRequest"})}),"\n",(0,l.jsx)(t.p,{children:"Form request class for validating FlowState update data. This request handles partial updates with context-aware validation, ensuring translation uniqueness while allowing selective field updates."}),"\n",(0,l.jsx)(t.h2,{id:"namespace",children:"Namespace"}),"\n",(0,l.jsx)(t.p,{children:(0,l.jsx)(t.code,{children:"JobMetric\\Flow\\Http\\Requests\\FlowState\\UpdateFlowStateRequest"})}),"\n",(0,l.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,l.jsxs)(t.p,{children:["The ",(0,l.jsx)(t.code,{children:"UpdateFlowStateRequest"})," validates incoming data when updating an existing FlowState entity. Unlike ",(0,l.jsx)(t.code,{children:"StoreFlowStateRequest"}),", all fields are optional (",(0,l.jsx)(t.code,{children:"sometimes"}),"), allowing partial updates while maintaining data integrity."]}),"\n",(0,l.jsx)(t.h2,{id:"key-features",children:"Key Features"}),"\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsxs)(t.li,{children:[(0,l.jsx)(t.strong,{children:"Partial Updates"}),": All fields are optional, allowing selective updates"]}),"\n",(0,l.jsxs)(t.li,{children:[(0,l.jsx)(t.strong,{children:"Context-Aware Validation"}),": Uses ",(0,l.jsx)(t.code,{children:"flow_id"})," and ",(0,l.jsx)(t.code,{children:"state_id"})," from context"]}),"\n",(0,l.jsxs)(t.li,{children:[(0,l.jsx)(t.strong,{children:"Static Rules Method"}),": Provides ",(0,l.jsx)(t.code,{children:"rulesFor()"})," for programmatic validation"]}),"\n",(0,l.jsxs)(t.li,{children:[(0,l.jsx)(t.strong,{children:"Status Validation"}),": Validates status against flow's driver"]}),"\n",(0,l.jsxs)(t.li,{children:[(0,l.jsx)(t.strong,{children:"Translation Uniqueness"}),": Validates translation names excluding current state"]}),"\n"]}),"\n",(0,l.jsx)(t.h2,{id:"validation-rules",children:"Validation Rules"}),"\n",(0,l.jsx)(t.h3,{id:"optional-fields",children:"Optional Fields"}),"\n",(0,l.jsxs)(t.p,{children:["All fields use ",(0,l.jsx)(t.code,{children:"sometimes"})," rule:"]}),"\n",(0,l.jsxs)(t.table,{children:[(0,l.jsx)(t.thead,{children:(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.th,{children:"Field"}),(0,l.jsx)(t.th,{children:"Rule"}),(0,l.jsx)(t.th,{children:"Description"})]})}),(0,l.jsxs)(t.tbody,{children:[(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"translation"})}),(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"sometimes|array"})}),(0,l.jsx)(t.td,{children:"Multi-language translation data"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"translation.{locale}"})}),(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"sometimes|array"})}),(0,l.jsx)(t.td,{children:"Translation data for specific locale"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"translation.{locale}.name"})}),(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"required|string"})}),(0,l.jsx)(t.td,{children:"State name (validated if locale provided)"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"status"})}),(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"sometimes|nullable|CheckStatusInDriverRule"})}),(0,l.jsx)(t.td,{children:"Status value (validated against flow's driver)"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"config"})}),(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"sometimes|array"})}),(0,l.jsx)(t.td,{children:"Custom configuration array"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"color"})}),(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"sometimes|nullable|hex_color"})}),(0,l.jsx)(t.td,{children:"Hex color code"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"icon"})}),(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"sometimes|nullable|string"})}),(0,l.jsx)(t.td,{children:"Icon identifier"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"position"})}),(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"sometimes|array|required_array_keys:x,y"})}),(0,l.jsx)(t.td,{children:"Position coordinates"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"position.x"})}),(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"numeric"})}),(0,l.jsx)(t.td,{children:"X coordinate"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"position.y"})}),(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"numeric"})}),(0,l.jsx)(t.td,{children:"Y coordinate"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"is_terminal"})}),(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"sometimes|boolean"})}),(0,l.jsx)(t.td,{children:"Terminal state flag"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"translation.{locale}.description"})}),(0,l.jsx)(t.td,{children:(0,l.jsx)(t.code,{children:"nullable|string"})}),(0,l.jsx)(t.td,{children:"Optional description"})]})]})]}),"\n",(0,l.jsx)(t.h2,{id:"context-management",children:"Context Management"}),"\n",(0,l.jsx)(t.p,{children:"The request supports external context injection:"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-php",children:"$request = new UpdateFlowStateRequest();\n$request->setContext([\n    'flow_id' => 123,\n    'state_id' => 456,\n]);\n"})}),"\n",(0,l.jsx)(t.h2,{id:"static-rules-method",children:"Static Rules Method"}),"\n",(0,l.jsx)(t.h3,{id:"rulesfor",children:"rulesFor()"}),"\n",(0,l.jsx)(t.p,{children:"Provides programmatic validation:"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-php",children:"$input = [\n    'translation' => [\n        'en' => ['name' => 'Updated Name'],\n    ],\n    'status' => 'completed',\n];\n\n$context = [\n    'flow_id' => 1,\n    'state_id' => 5,\n];\n\n$rules = UpdateFlowStateRequest::rulesFor($input, $context);\n"})}),"\n",(0,l.jsx)(t.h2,{id:"status-validation",children:"Status Validation"}),"\n",(0,l.jsxs)(t.p,{children:["The ",(0,l.jsx)(t.code,{children:"status"})," field uses ",(0,l.jsx)(t.code,{children:"CheckStatusInDriverRule"})," to validate against the flow's driver:"]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-php",children:"// If flow uses OrderStatus enum\n'status' => 'completed', // \u2705 Valid if in enum\n'status' => 'invalid',   // \u274c Invalid if not in enum\n"})}),"\n",(0,l.jsx)(t.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,l.jsx)(t.h3,{id:"basic-update",children:"Basic Update"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-php",children:"use JobMetric\\Flow\\Http\\Requests\\FlowState\\UpdateFlowStateRequest;\nuse JobMetric\\Flow\\Facades\\FlowState;\n\npublic function update(UpdateFlowStateRequest $request, $id)\n{\n    $validated = $request->validated();\n    \n    $state = FlowState::update($id, $validated);\n    \n    return response()->json($state);\n}\n"})}),"\n",(0,l.jsx)(t.h3,{id:"partial-update---status-only",children:"Partial Update - Status Only"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-php",children:"$requestData = [\n    'status' => 'completed',\n];\n"})}),"\n",(0,l.jsx)(t.h3,{id:"partial-update---translation-only",children:"Partial Update - Translation Only"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-php",children:"$requestData = [\n    'translation' => [\n        'en' => [\n            'name' => 'Updated State Name',\n            'description' => 'New description',\n        ],\n    ],\n];\n"})}),"\n",(0,l.jsx)(t.h3,{id:"update-visual-configuration",children:"Update Visual Configuration"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-php",children:"$requestData = [\n    'color' => '#10B981',\n    'icon' => 'fas fa-check-circle',\n    'position' => [\n        'x' => 300,\n        'y' => 400,\n    ],\n];\n"})}),"\n",(0,l.jsx)(t.h3,{id:"update-multiple-fields",children:"Update Multiple Fields"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-php",children:"$requestData = [\n    'translation' => [\n        'en' => ['name' => 'Updated Name'],\n    ],\n    'status' => 'completed',\n    'is_terminal' => true,\n    'color' => '#10B981',\n];\n"})}),"\n",(0,l.jsx)(t.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,l.jsx)(t.h3,{id:"validation-errors",children:"Validation Errors"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-json",children:'{\n    "message": "The given data was invalid.",\n    "errors": {\n        "translation.en.name": [\n            "A state with this name already exists in this flow."\n        ],\n        "status": [\n            "The status value is not valid for this flow\'s driver."\n        ]\n    }\n}\n'})}),"\n",(0,l.jsx)(t.h2,{id:"differences-from-storeflowstaterequest",children:"Differences from StoreFlowStateRequest"}),"\n",(0,l.jsxs)(t.table,{children:[(0,l.jsx)(t.thead,{children:(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.th,{children:"Feature"}),(0,l.jsx)(t.th,{children:"StoreFlowStateRequest"}),(0,l.jsx)(t.th,{children:"UpdateFlowStateRequest"})]})}),(0,l.jsxs)(t.tbody,{children:[(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{children:"Field Rules"}),(0,l.jsxs)(t.td,{children:[(0,l.jsx)(t.code,{children:"required"})," for translations"]}),(0,l.jsxs)(t.td,{children:[(0,l.jsx)(t.code,{children:"sometimes"})," for all fields"]})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{children:"Context Support"}),(0,l.jsxs)(t.td,{children:[(0,l.jsx)(t.code,{children:"flow_id"})," only"]}),(0,l.jsxs)(t.td,{children:[(0,l.jsx)(t.code,{children:"flow_id"})," and ",(0,l.jsx)(t.code,{children:"state_id"})]})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{children:"Static Method"}),(0,l.jsxs)(t.td,{children:[(0,l.jsx)(t.code,{children:"normalize()"})," and ",(0,l.jsx)(t.code,{children:"rulesFor()"})]}),(0,l.jsxs)(t.td,{children:[(0,l.jsx)(t.code,{children:"rulesFor()"})," only"]})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{children:"Uniqueness Check"}),(0,l.jsx)(t.td,{children:"Checks all states in flow"}),(0,l.jsx)(t.td,{children:"Excludes current state"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{children:"Flow ID"}),(0,l.jsx)(t.td,{children:"Required field"}),(0,l.jsx)(t.td,{children:"Optional (from context)"})]})]})]}),"\n",(0,l.jsx)(t.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,l.jsxs)(t.ol,{children:["\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsxs)(t.p,{children:[(0,l.jsx)(t.strong,{children:"Use Context for Uniqueness"}),": Always provide ",(0,l.jsx)(t.code,{children:"flow_id"})," and ",(0,l.jsx)(t.code,{children:"state_id"})," in context"]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-php",children:"$request->setContext([\n    'flow_id' => $flowId,\n    'state_id' => $stateId,\n]);\n"})}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsxs)(t.p,{children:[(0,l.jsx)(t.strong,{children:"Validate Only Changed Fields"}),": Only send fields that need updating"]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-php",children:"// \u2705 Good\n['status' => 'completed']\n\n// \u274c Bad\n['translation' => [...], 'status' => 'completed', 'color' => '#...', ...]\n"})}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsxs)(t.p,{children:[(0,l.jsx)(t.strong,{children:"Handle Status Changes Carefully"}),": Ensure status is valid for flow's driver"]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-php",children:"// \u2705 Good - Validate first\n$validStatuses = OrderStatus::values();\nif (in_array($newStatus, $validStatuses)) {\n    'status' => $newStatus,\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(t.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsxs)(t.li,{children:[(0,l.jsx)(t.a,{href:"/packages/laravel-flow/deep-diving/services/flow-state",children:"FlowState Service"})," - State management"]}),"\n",(0,l.jsxs)(t.li,{children:[(0,l.jsx)(t.a,{href:"/packages/laravel-flow/deep-diving/requests/store-flow-state-request",children:"StoreFlowStateRequest"})," - State creation validation"]}),"\n",(0,l.jsxs)(t.li,{children:[(0,l.jsx)(t.a,{href:"/packages/laravel-flow/deep-diving/resources/flow-state-resource",children:"FlowStateResource"})," - State JSON resource"]}),"\n",(0,l.jsxs)(t.li,{children:[(0,l.jsx)(t.a,{href:"/packages/laravel-flow/deep-diving/rules/check-status-in-driver-rule",children:"CheckStatusInDriverRule"})," - Status validation rule"]}),"\n",(0,l.jsxs)(t.li,{children:[(0,l.jsx)(t.a,{href:"/packages/laravel-flow/deep-diving/events",children:"Events"})," - State lifecycle events"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,l.jsx)(t,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}}}]);