"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[1294],{4250(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"laravel-location/deep-diving/events","title":"Events","description":"Laravel Location fires domain events for the lifecycle of its main entities.","source":"@site/packages/laravel-location/deep-diving/events.md","sourceDirName":"laravel-location/deep-diving","slug":"/laravel-location/deep-diving/events","permalink":"/packages/laravel-location/deep-diving/events","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-location/deep-diving/events.md","tags":[],"version":"current","sidebarPosition":11,"frontMatter":{"sidebar_position":11,"sidebar_label":"Events"},"sidebar":"packagesSidebar","previous":{"title":"Datasets","permalink":"/packages/laravel-location/deep-diving/datasets"}}');var o=t(74848),s=t(28453);const r={sidebar_position:11,sidebar_label:"Events"},l="Events",c={},d=[{value:"Listening to events",id:"listening-to-events",level:2},{value:"Event classes (by entity)",id:"event-classes-by-entity",level:2},{value:"Country",id:"country",level:3},{value:"Province / City / District",id:"province--city--district",level:3},{value:"Location",id:"location",level:3},{value:"GeoArea",id:"geoarea",level:3},{value:"Address",id:"address",level:3},{value:"Note (naming convention)",id:"note-naming-convention",level:2}];function a(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"events",children:"Events"})}),"\n",(0,o.jsxs)(n.p,{children:["Laravel Location fires ",(0,o.jsx)(n.strong,{children:"domain events"})," for the lifecycle of its main entities."]}),"\n",(0,o.jsxs)(n.p,{children:["All events implement ",(0,o.jsx)(n.code,{children:"JobMetric\\EventSystem\\Contracts\\DomainEvent"})," and expose:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"public static function key(): string"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"public static function definition(): DomainEventDefinition"})}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Typical event types:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Store"})," / ",(0,o.jsx)(n.code,{children:"Update"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Delete"})," / ",(0,o.jsx)(n.code,{children:"Restore"})," / ",(0,o.jsx)(n.code,{children:"ForceDelete"})," (for soft-deletable entities)"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Entities with events:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Country"}),"\n",(0,o.jsx)(n.li,{children:"Province"}),"\n",(0,o.jsx)(n.li,{children:"City"}),"\n",(0,o.jsx)(n.li,{children:"District"}),"\n",(0,o.jsx)(n.li,{children:"Location (store only)"}),"\n",(0,o.jsx)(n.li,{children:"GeoArea"}),"\n",(0,o.jsx)(n.li,{children:"Address"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"listening-to-events",children:"Listening to events"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-php",children:"use Illuminate\\Support\\Facades\\Event;\nuse JobMetric\\Location\\Events\\Country\\CountryStoreEvent;\n\nEvent::listen(CountryStoreEvent::class, function (CountryStoreEvent $event) {\n    $country = $event->country;\n});\n"})}),"\n",(0,o.jsx)(n.h2,{id:"event-classes-by-entity",children:"Event classes (by entity)"}),"\n",(0,o.jsx)(n.h3,{id:"country",children:"Country"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"JobMetric\\Location\\Events\\Country\\CountryStoreEvent"})," (payload: ",(0,o.jsx)(n.code,{children:"Country $country"}),")"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"JobMetric\\Location\\Events\\Country\\CountryUpdateEvent"})," (payload: ",(0,o.jsx)(n.code,{children:"Country $country"}),", ",(0,o.jsx)(n.code,{children:"array $data"}),")"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"JobMetric\\Location\\Events\\Country\\CountryDeleteEvent"})," (payload: ",(0,o.jsx)(n.code,{children:"Country $country"}),")"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"JobMetric\\Location\\Events\\Country\\CountryRestoreEvent"})," (payload: ",(0,o.jsx)(n.code,{children:"Country $country"}),")"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"JobMetric\\Location\\Events\\Country\\CountryForceDeleteEvent"})," (payload: ",(0,o.jsx)(n.code,{children:"Country $country"}),")"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"province--city--district",children:"Province / City / District"}),"\n",(0,o.jsx)(n.p,{children:"Each follows the same payload pattern as Country:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Store: model only"}),"\n",(0,o.jsx)(n.li,{children:"Update: model + data array"}),"\n",(0,o.jsx)(n.li,{children:"Delete/Restore/ForceDelete: model only"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"location",children:"Location"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"JobMetric\\Location\\Events\\Location\\LocationStoreEvent"})," (payload: ",(0,o.jsx)(n.code,{children:"Location $location"}),", ",(0,o.jsx)(n.code,{children:"array $data = []"}),")"]}),"\n"]}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["Note: Location uses ",(0,o.jsx)(n.code,{children:"firstOrCreate()"}),". If the record already exists, the store event is ",(0,o.jsx)(n.strong,{children:"not"})," fired."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"geoarea",children:"GeoArea"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"GeoAreaStoreEvent"})," (payload: ",(0,o.jsx)(n.code,{children:"GeoArea $geoArea"}),")"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"GeoAreaUpdateEvent"})," (payload: ",(0,o.jsx)(n.code,{children:"GeoArea $geoArea"}),", ",(0,o.jsx)(n.code,{children:"array $data"}),")"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"GeoAreaDeleteEvent"})," / ",(0,o.jsx)(n.code,{children:"GeoAreaRestoreEvent"})," / ",(0,o.jsx)(n.code,{children:"GeoAreaForceDeleteEvent"})," (payload: ",(0,o.jsx)(n.code,{children:"GeoArea $geoArea"}),")"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"address",children:"Address"}),"\n",(0,o.jsx)(n.p,{children:"Address events follow the same pattern:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Store: address model only"}),"\n",(0,o.jsx)(n.li,{children:"Update: address model + data array"}),"\n",(0,o.jsx)(n.li,{children:"Delete/Restore/ForceDelete: address model only"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"note-naming-convention",children:"Note (naming convention)"}),"\n",(0,o.jsx)(n.p,{children:"The exact event class names follow the convention:"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"JobMetric\\Location\\Events\\{Entity}\\{Entity}{Action}Event"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(a,{...e})}):a(e)}},28453(e,n,t){t.d(n,{R:()=>r,x:()=>l});var i=t(96540);const o={},s=i.createContext(o);function r(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);