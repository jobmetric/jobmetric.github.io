"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[5709],{4500(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>g,frontMatter:()=>l,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"laravel-event-system/deep-diving/support/event-registry","title":"EventRegistry","description":"The EventRegistry is responsible for managing domain events and their metadata definitions. It keeps a mapping between stable event keys and their corresponding event classes, as well as full DomainEventDefinition instances for use in UI, automation, and logging.","source":"@site/packages/laravel-event-system/deep-diving/support/event-registry.md","sourceDirName":"laravel-event-system/deep-diving/support","slug":"/laravel-event-system/deep-diving/support/event-registry","permalink":"/packages/laravel-event-system/deep-diving/support/event-registry","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-event-system/deep-diving/support/event-registry.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7,"sidebar_label":"EventRegistry"},"sidebar":"packagesSidebar","previous":{"title":"EventBus","permalink":"/packages/laravel-event-system/deep-diving/support/event-bus"},"next":{"title":"DomainEventDefinition","permalink":"/packages/laravel-event-system/deep-diving/support/domain-event-definition"}}');var t=i(4848),r=i(8453);const l={sidebar_position:7,sidebar_label:"EventRegistry"},o="EventRegistry",d={},a=[{value:"When to Use EventRegistry",id:"when-to-use-eventregistry",level:2},{value:"Overview",id:"overview",level:2},{value:"Namespace",id:"namespace",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"Available Methods",id:"available-methods",level:2},{value:"<code>register(string $eventClass): void</code>",id:"registerstring-eventclass-void",level:3},{value:"<code>forKey(string $key): ?string</code>",id:"forkeystring-key-string",level:3},{value:"<code>definitionForKey(string $key): ?DomainEventDefinition</code>",id:"definitionforkeystring-key-domaineventdefinition",level:3},{value:"<code>allDefinitions(): array</code>",id:"alldefinitions-array",level:3},{value:"<code>has(string $key): bool</code>",id:"hasstring-key-bool",level:3},{value:"<code>keyFor(object|string $event): ?string</code>",id:"keyforobjectstring-event-string",level:3},{value:"Complete Example",id:"complete-example",level:2},{value:"Use Cases",id:"use-cases",level:2},{value:"Event Selection UI",id:"event-selection-ui",level:3},{value:"Event Logging",id:"event-logging",level:3},{value:"API Documentation",id:"api-documentation",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"eventregistry",children:"EventRegistry"})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"EventRegistry"})," is responsible for managing domain events and their metadata definitions. It keeps a mapping between stable event keys and their corresponding event classes, as well as full ",(0,t.jsx)(n.code,{children:"DomainEventDefinition"})," instances for use in UI, automation, and logging."]}),"\n",(0,t.jsx)(n.h2,{id:"when-to-use-eventregistry",children:"When to Use EventRegistry"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.strong,{children:["Use ",(0,t.jsx)(n.code,{children:"EventRegistry"})," when you need:"]})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Event registration"}),": Register domain events for key-based lookup"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Key resolution"}),": Resolve event keys to their corresponding classes"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Metadata lookup"}),": Get rich metadata (title, description, icon, tags) for events"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Event listing"}),": Get all registered events for UI/automation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Key lookup"}),": Find the stable key for an event class or instance"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Event validation"}),": Check if an event is registered"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example scenarios:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Registering domain events in service providers"}),"\n",(0,t.jsx)(n.li,{children:"Building event selection UIs"}),"\n",(0,t.jsx)(n.li,{children:"Event logging and audit systems"}),"\n",(0,t.jsx)(n.li,{children:"Workflow automation builders"}),"\n",(0,t.jsx)(n.li,{children:"Rule engine configuration"}),"\n",(0,t.jsx)(n.li,{children:"API documentation generation"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"EventRegistry"})," maintains two internal mappings:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Class Map"}),": Maps stable keys to event class names"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Definition Map"}),": Maps stable keys to ",(0,t.jsx)(n.code,{children:"DomainEventDefinition"})," instances"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"namespace",children:"Namespace"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"JobMetric\\EventSystem\\Support\\EventRegistry\n"})}),"\n",(0,t.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,t.jsx)(n.p,{children:"Inject the registry or resolve it from the container:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"use JobMetric\\EventSystem\\Support\\EventRegistry;\nuse App\\Events\\UserRegistered;\n\n$registry = app(EventRegistry::class);\n\n// Register an event\n$registry->register(UserRegistered::class);\n\n// Check if event exists\nif ($registry->has('user.registered')) {\n    // Event is registered\n}\n\n// Get event class by key\n$eventClass = $registry->forKey('user.registered');\n\n// Get metadata definition\n$definition = $registry->definitionForKey('user.registered');\n\n// Get all definitions\n$allDefinitions = $registry->allDefinitions();\n"})}),"\n",(0,t.jsx)(n.h2,{id:"available-methods",children:"Available Methods"}),"\n",(0,t.jsx)(n.h3,{id:"registerstring-eventclass-void",children:(0,t.jsx)(n.code,{children:"register(string $eventClass): void"})}),"\n",(0,t.jsx)(n.p,{children:"Register a domain event with a given key and event class."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"$eventClass"})," (",(0,t.jsx)(n.code,{children:"class-string<DomainEvent>"}),"): The concrete domain event class to register"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Returns:"})," ",(0,t.jsx)(n.code,{children:"void"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Throws:"})," ",(0,t.jsx)(n.code,{children:"InvalidArgumentException"})," if the class doesn't implement ",(0,t.jsx)(n.code,{children:"DomainEvent"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Behavior:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["The key is resolved from the ",(0,t.jsx)(n.code,{children:"DomainEvent"})," implementation via its static ",(0,t.jsx)(n.code,{children:"key()"})," method"]}),"\n",(0,t.jsxs)(n.li,{children:["Both the class mapping and the ",(0,t.jsx)(n.code,{children:"DomainEventDefinition"})," are stored"]}),"\n",(0,t.jsx)(n.li,{children:"If the event is already registered, it will be overwritten"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"use JobMetric\\EventSystem\\Support\\EventRegistry;\nuse App\\Events\\UserRegistered;\nuse App\\Events\\ProductCreated;\n\n$registry = app(EventRegistry::class);\n\n// Register events\n$registry->register(UserRegistered::class);\n$registry->register(ProductCreated::class);\n"})}),"\n",(0,t.jsx)(n.h3,{id:"forkeystring-key-string",children:(0,t.jsx)(n.code,{children:"forKey(string $key): ?string"})}),"\n",(0,t.jsx)(n.p,{children:"Get the event class for the given key."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"$key"})," (string): The stable event key to look up"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Returns:"})," ",(0,t.jsx)(n.code,{children:"`class-string<DomainEvent>`|null"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$registry = app(EventRegistry::class);\n\n// Get event class\n$eventClass = $registry->forKey('user.registered');\n// Returns: 'App\\Events\\UserRegistered' or null if not found\n\nif ($eventClass) {\n    // Event is registered\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"definitionforkeystring-key-domaineventdefinition",children:(0,t.jsx)(n.code,{children:"definitionForKey(string $key): ?DomainEventDefinition"})}),"\n",(0,t.jsx)(n.p,{children:"Get the metadata definition for a given key."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"$key"})," (string): The stable event key to look up"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Returns:"})," ",(0,t.jsx)(n.code,{children:"DomainEventDefinition|null"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$registry = app(EventRegistry::class);\n\n$definition = $registry->definitionForKey('user.registered');\n\nif ($definition) {\n    echo $definition->title;        // Translation key\n    echo $definition->description;  // Translation key\n    echo $definition->icon;         // Icon class\n    echo implode(', ', $definition->tags); // Tags array\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"alldefinitions-array",children:(0,t.jsx)(n.code,{children:"allDefinitions(): array"})}),"\n",(0,t.jsx)(n.p,{children:"Get all registered metadata definitions keyed by their event keys."}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Returns:"})," ",(0,t.jsx)(n.code,{children:"array<string, DomainEventDefinition>"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:'$registry = app(EventRegistry::class);\n\n$definitions = $registry->allDefinitions();\n\nforeach ($definitions as $key => $definition) {\n    echo "Event: {$key}\\n";\n    echo "Title: " . trans($definition->title) . "\\n";\n    echo "Group: " . trans($definition->group) . "\\n";\n    echo "Tags: " . implode(\', \', $definition->tags ?? []) . "\\n\\n";\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"hasstring-key-bool",children:(0,t.jsx)(n.code,{children:"has(string $key): bool"})}),"\n",(0,t.jsx)(n.p,{children:"Determine whether an event with the given key is registered."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"$key"})," (string): The stable event key to check existence for"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Returns:"})," ",(0,t.jsx)(n.code,{children:"bool"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$registry = app(EventRegistry::class);\n\nif ($registry->has('user.registered')) {\n    // Event is registered\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"keyforobjectstring-event-string",children:(0,t.jsx)(n.code,{children:"keyFor(object|string $event): ?string"})}),"\n",(0,t.jsx)(n.p,{children:"Get the stable key for the given event instance or event class."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"$event"})," (object|string): The event instance or event class name to resolve a key for"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Returns:"})," ",(0,t.jsx)(n.code,{children:"string|null"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$registry = app(EventRegistry::class);\n\n// From instance\n$event = new UserRegistered(123, 'user@example.com', 'John');\n$key = $registry->keyFor($event);\n// Returns: 'user.registered'\n\n// From class name\n$key = $registry->keyFor(UserRegistered::class);\n// Returns: 'user.registered'\n"})}),"\n",(0,t.jsx)(n.h2,{id:"complete-example",children:"Complete Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"namespace App\\Providers;\n\nuse Illuminate\\Support\\ServiceProvider;\nuse JobMetric\\EventSystem\\Support\\EventRegistry;\nuse App\\Events\\UserRegistered;\nuse App\\Events\\UserUpdated;\nuse App\\Events\\ProductCreated;\nuse App\\Events\\ProductUpdated;\nuse App\\Events\\OrderCompleted;\n\nclass EventSystemServiceProvider extends ServiceProvider\n{\n    public function boot(EventRegistry $registry): void\n    {\n        // Register user events\n        $registry->register(UserRegistered::class);\n        $registry->register(UserUpdated::class);\n\n        // Register product events\n        $registry->register(ProductCreated::class);\n        $registry->register(ProductUpdated::class);\n\n        // Register order events\n        $registry->register(OrderCompleted::class);\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,t.jsx)(n.h3,{id:"event-selection-ui",children:"Event Selection UI"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"class EventSelectorComponent\n{\n    public function getAvailableEvents(): array\n    {\n        $registry = app(EventRegistry::class);\n        $definitions = $registry->allDefinitions();\n\n        return collect($definitions)\n            ->map(function ($definition, $key) {\n                return [\n                    'key' => $key,\n                    'title' => trans($definition->title),\n                    'description' => trans($definition->description),\n                    'icon' => $definition->icon,\n                    'tags' => $definition->tags ?? [],\n                    'group' => trans($definition->group),\n                ];\n            })\n            ->groupBy('group')\n            ->toArray();\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"event-logging",children:"Event Logging"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"class EventLogger\n{\n    public function logEvent(object $event): void\n    {\n        $registry = app(EventRegistry::class);\n        $key = $registry->keyFor($event);\n\n        if ($key) {\n            $definition = $registry->definitionForKey($key);\n\n            Log::info('Domain event fired', [\n                'key' => $key,\n                'title' => trans($definition->title),\n                'description' => trans($definition->description),\n                'tags' => $definition->tags,\n            ]);\n        }\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"api-documentation",children:"API Documentation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"class EventDocumentationController extends Controller\n{\n    public function index()\n    {\n        $registry = app(EventRegistry::class);\n        $definitions = $registry->allDefinitions();\n\n        $events = collect($definitions)->map(function ($definition, $key) {\n            return [\n                'key' => $key,\n                'class' => $registry->forKey($key),\n                'title' => trans($definition->title),\n                'description' => trans($definition->description),\n                'icon' => $definition->icon,\n                'tags' => $definition->tags ?? [],\n                'group' => trans($definition->group),\n            ];\n        })->values();\n\n        return response()->json($events);\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Register in Service Providers"}),": Register all domain events in service providers during boot"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Check Before Use"}),": Always check if an event exists before using it"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Use Keys Consistently"}),": Use the same key format across your application"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Provide Rich Metadata"}),": Include complete metadata for UI/automation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Group Related Events"}),": Use consistent group names for related events"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/packages/laravel-event-system/deep-diving/domain-event",children:"DomainEvent"})," - Domain event contract"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/packages/laravel-event-system/deep-diving/support/domain-event-definition",children:"DomainEventDefinition"})," - Metadata definition class"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/packages/laravel-event-system/deep-diving/support/event-bus",children:"EventBus"})," - Event bus for dispatching events"]}),"\n"]})]})}function g(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453(e,n,i){i.d(n,{R:()=>l,x:()=>o});var s=i(6540);const t={},r=s.createContext(t);function l(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);