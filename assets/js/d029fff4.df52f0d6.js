"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[2338],{8453(e,n,t){t.d(n,{R:()=>r,x:()=>a});var s=t(6540);const i={},l=s.createContext(i);function r(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(l.Provider,{value:n},e.children)}},9337(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"laravel-flow/deep-diving/requests/update-flow-transition-request","title":"UpdateFlowTransitionRequest","description":"Form request class for validating FlowTransition update data. This request handles partial updates with complex validation including state relationships, transition types, and uniqueness constraints while excluding the current transition.","source":"@site/packages/laravel-flow/deep-diving/requests/update-flow-transition-request.md","sourceDirName":"laravel-flow/deep-diving/requests","slug":"/laravel-flow/deep-diving/requests/update-flow-transition-request","permalink":"/packages/laravel-flow/deep-diving/requests/update-flow-transition-request","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-flow/deep-diving/requests/update-flow-transition-request.md","tags":[],"version":"current","sidebarPosition":11,"frontMatter":{"sidebar_position":11,"sidebar_label":"UpdateFlowTransitionRequest"},"sidebar":"packagesSidebar","previous":{"title":"StoreFlowTransitionRequest","permalink":"/packages/laravel-flow/deep-diving/requests/store-flow-transition-request"},"next":{"title":"FlowResource","permalink":"/packages/laravel-flow/deep-diving/resources/flow-resource"}}');var i=t(4848),l=t(8453);const r={sidebar_position:11,sidebar_label:"UpdateFlowTransitionRequest"},a="UpdateFlowTransitionRequest",d={},o=[{value:"Namespace",id:"namespace",level:2},{value:"Overview",id:"overview",level:2},{value:"Key Features",id:"key-features",level:2},{value:"Validation Rules",id:"validation-rules",level:2},{value:"Optional Fields",id:"optional-fields",level:3},{value:"Cross-Field Validation",id:"cross-field-validation",level:2},{value:"Effective Values",id:"effective-values",level:3},{value:"At Least One Required",id:"at-least-one-required",level:3},{value:"START State Rules",id:"start-state-rules",level:3},{value:"Terminal State Rules",id:"terminal-state-rules",level:3},{value:"Uniqueness Rules",id:"uniqueness-rules",level:3},{value:"Context Management",id:"context-management",level:2},{value:"Static Rules Method",id:"static-rules-method",level:2},{value:"rulesFor()",id:"rulesfor",level:3},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Basic Update",id:"basic-update",level:3},{value:"Partial Update - Translation Only",id:"partial-update---translation-only",level:3},{value:"Partial Update - States Only",id:"partial-update---states-only",level:3},{value:"Update Slug",id:"update-slug",level:3},{value:"Change Transition Type",id:"change-transition-type",level:3},{value:"Complete Update",id:"complete-update",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Validation Errors",id:"validation-errors",level:3},{value:"Differences from StoreFlowTransitionRequest",id:"differences-from-storeflowtransitionrequest",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"updateflowtransitionrequest",children:"UpdateFlowTransitionRequest"})}),"\n",(0,i.jsx)(n.p,{children:"Form request class for validating FlowTransition update data. This request handles partial updates with complex validation including state relationships, transition types, and uniqueness constraints while excluding the current transition."}),"\n",(0,i.jsx)(n.h2,{id:"namespace",children:"Namespace"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"JobMetric\\Flow\\Http\\Requests\\FlowTransition\\UpdateFlowTransitionRequest"})}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"UpdateFlowTransitionRequest"})," validates incoming data when updating an existing FlowTransition entity. Unlike ",(0,i.jsx)(n.code,{children:"StoreFlowTransitionRequest"}),", all fields are optional (",(0,i.jsx)(n.code,{children:"sometimes"}),"), allowing partial updates while maintaining data integrity and business rules."]}),"\n",(0,i.jsx)(n.h2,{id:"key-features",children:"Key Features"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Partial Updates"}),": All fields are optional, allowing selective updates"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Context-Aware Validation"}),": Uses ",(0,i.jsx)(n.code,{children:"flow_id"})," and ",(0,i.jsx)(n.code,{children:"flow_transition_id"})," from context"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Static Rules Method"}),": Provides ",(0,i.jsx)(n.code,{children:"rulesFor()"})," for programmatic validation"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Current Record Exclusion"}),": Uniqueness checks exclude current transition"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Business Rules"}),": Enforces START state rules, terminal state rules, etc."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"validation-rules",children:"Validation Rules"}),"\n",(0,i.jsx)(n.h3,{id:"optional-fields",children:"Optional Fields"}),"\n",(0,i.jsxs)(n.p,{children:["All fields use ",(0,i.jsx)(n.code,{children:"sometimes"})," rule:"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Field"}),(0,i.jsx)(n.th,{children:"Rule"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"translation"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"sometimes|array"})}),(0,i.jsx)(n.td,{children:"Multi-language translation data"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"translation.{locale}"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"sometimes|array"})}),(0,i.jsx)(n.td,{children:"Translation data for specific locale"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"translation.{locale}.name"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"required|string"})}),(0,i.jsx)(n.td,{children:"Transition name (validated if locale provided)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"from"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"sometimes|nullable|integer|exists:flow_states,id"})}),(0,i.jsx)(n.td,{children:"Source state ID"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"to"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"sometimes|nullable|integer|exists:flow_states,id"})}),(0,i.jsx)(n.td,{children:"Target state ID"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"slug"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"sometimes|nullable|string|max:255|regex:/^[a-z0-9-]+$/|unique:flow_transitions,slug"})}),(0,i.jsx)(n.td,{children:"URL-friendly identifier"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"cross-field-validation",children:"Cross-Field Validation"}),"\n",(0,i.jsxs)(n.p,{children:["The request includes extensive custom validation in ",(0,i.jsx)(n.code,{children:"withValidator()"}),":"]}),"\n",(0,i.jsx)(n.h3,{id:"effective-values",children:"Effective Values"}),"\n",(0,i.jsx)(n.p,{children:"When updating, if a field is not provided, it uses the current value:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// Current transition: from=1, to=2\n// Update: from=3 (to not provided)\n// Effective: from=3, to=2 (keeps current to)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"at-least-one-required",children:"At Least One Required"}),"\n",(0,i.jsxs)(n.p,{children:["After update, at least one of ",(0,i.jsx)(n.code,{children:"from"})," or ",(0,i.jsx)(n.code,{children:"to"})," must be set:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// \u2705 Valid\n'from' => 1, 'to' => 2,\n'from' => null, 'to' => 2,\n'from' => 1, 'to' => null,\n\n// \u274c Invalid\n'from' => null, 'to' => null,\n"})}),"\n",(0,i.jsx)(n.h3,{id:"start-state-rules",children:"START State Rules"}),"\n",(0,i.jsxs)(n.p,{children:["Same rules as ",(0,i.jsx)(n.code,{children:"StoreFlowTransitionRequest"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Cannot Self-Loop"}),": START state cannot have self-loop transitions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Cannot Point To"}),": No transition can point to START state"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Only One Exit"}),": Only one transition can exit from START state"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"First Transition"}),": If this is the only transition, from must remain START"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"terminal-state-rules",children:"Terminal State Rules"}),"\n",(0,i.jsx)(n.p,{children:"Terminal states cannot have generic output transitions:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// \u274c Invalid if from is terminal state\n'from' => $terminalStateId,\n'to' => null,\n"})}),"\n",(0,i.jsx)(n.h3,{id:"uniqueness-rules",children:"Uniqueness Rules"}),"\n",(0,i.jsxs)(n.p,{children:["The combination ",(0,i.jsx)(n.code,{children:"(flow_id, from, to)"})," must be unique, excluding the current transition:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// Current transition: ID=5, from=1, to=2\n// Update to: from=3, to=4\n// Valid if no other transition has from=3, to=4\n// Invalid if another transition (ID\u22605) has from=3, to=4\n"})}),"\n",(0,i.jsx)(n.h2,{id:"context-management",children:"Context Management"}),"\n",(0,i.jsx)(n.p,{children:"The request supports external context injection:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"$request = new UpdateFlowTransitionRequest();\n$request->setContext([\n    'flow_id' => 123,\n    'flow_transition_id' => 456,\n]);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"static-rules-method",children:"Static Rules Method"}),"\n",(0,i.jsx)(n.h3,{id:"rulesfor",children:"rulesFor()"}),"\n",(0,i.jsx)(n.p,{children:"Provides programmatic validation:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"$input = [\n    'translation' => [\n        'en' => ['name' => 'Updated Name'],\n    ],\n    'from' => 3,\n    'to' => 4,\n];\n\n$context = [\n    'flow_id' => 1,\n    'flow_transition_id' => 5,\n];\n\n$rules = UpdateFlowTransitionRequest::rulesFor($input, $context);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,i.jsx)(n.h3,{id:"basic-update",children:"Basic Update"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"use JobMetric\\Flow\\Http\\Requests\\FlowTransition\\UpdateFlowTransitionRequest;\nuse JobMetric\\Flow\\Facades\\FlowTransition;\n\npublic function update(UpdateFlowTransitionRequest $request, $id)\n{\n    $validated = $request->validated();\n    \n    $transition = FlowTransition::update($id, $validated);\n    \n    return response()->json($transition);\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"partial-update---translation-only",children:"Partial Update - Translation Only"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"$requestData = [\n    'translation' => [\n        'en' => [\n            'name' => 'Updated Transition Name',\n        ],\n    ],\n];\n"})}),"\n",(0,i.jsx)(n.h3,{id:"partial-update---states-only",children:"Partial Update - States Only"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"$requestData = [\n    'from' => 3, // Change source state\n    'to' => 4,   // Change target state\n];\n"})}),"\n",(0,i.jsx)(n.h3,{id:"update-slug",children:"Update Slug"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"$requestData = [\n    'slug' => 'updated-slug',\n];\n"})}),"\n",(0,i.jsx)(n.h3,{id:"change-transition-type",children:"Change Transition Type"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// From specific to generic output\n$requestData = [\n    'from' => 1,\n    'to' => null, // Change to generic output\n];\n"})}),"\n",(0,i.jsx)(n.h3,{id:"complete-update",children:"Complete Update"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"$requestData = [\n    'translation' => [\n        'en' => ['name' => 'Updated Name'],\n    ],\n    'from' => 3,\n    'to' => 4,\n    'slug' => 'updated-slug',\n];\n"})}),"\n",(0,i.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,i.jsx)(n.h3,{id:"validation-errors",children:"Validation Errors"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "message": "The given data was invalid.",\n    "errors": {\n        "from": [\n            "The first transition must start from START state."\n        ],\n        "to": [\n            "Terminal states cannot have generic output transitions."\n        ],\n        "slug": [\n            "The slug has already been taken."\n        ]\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"differences-from-storeflowtransitionrequest",children:"Differences from StoreFlowTransitionRequest"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Feature"}),(0,i.jsx)(n.th,{children:"StoreFlowTransitionRequest"}),(0,i.jsx)(n.th,{children:"UpdateFlowTransitionRequest"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Field Rules"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"required"})," for translations"]}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"sometimes"})," for all fields"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Context Support"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"flow_id"})," only"]}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"flow_id"})," and ",(0,i.jsx)(n.code,{children:"flow_transition_id"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Uniqueness Check"}),(0,i.jsx)(n.td,{children:"Checks all transitions"}),(0,i.jsx)(n.td,{children:"Excludes current transition"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Current Record"}),(0,i.jsx)(n.td,{children:"Not applicable"}),(0,i.jsx)(n.td,{children:"Loads and uses current transition"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Effective Values"}),(0,i.jsx)(n.td,{children:"Uses input directly"}),(0,i.jsx)(n.td,{children:"Merges input with current values"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Flow ID"}),(0,i.jsx)(n.td,{children:"Required field"}),(0,i.jsx)(n.td,{children:"Optional (from context)"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use Context for Uniqueness"}),": Always provide ",(0,i.jsx)(n.code,{children:"flow_id"})," and ",(0,i.jsx)(n.code,{children:"flow_transition_id"})," in context"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"$request->setContext([\n    'flow_id' => $flowId,\n    'flow_transition_id' => $transitionId,\n]);\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Update Only Changed Fields"}),": Only send fields that need updating"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// \u2705 Good\n['from' => 3, 'to' => 4]\n\n// \u274c Bad\n['translation' => [...], 'from' => 3, 'to' => 4, 'slug' => '...']\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Respect Business Rules"}),": Follow START and terminal state rules"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// \u2705 Good - Valid transition\n'from' => 2, 'to' => 3,\n\n// \u274c Bad - Violates rules\n'from' => $startId, 'to' => $startId, // START self-loop\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Handle Effective Values"}),": Consider current values when updating"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"// Current: from=1, to=2\n// Update: from=3\n// Result: from=3, to=2 (to unchanged)\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/packages/laravel-flow/deep-diving/services/flow-transition",children:"FlowTransition Service"})," - Learn about transition management"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/packages/laravel-flow/deep-diving/requests/store-flow-transition-request",children:"StoreFlowTransitionRequest"})," - Transition creation validation"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/packages/laravel-flow/deep-diving/services/flow-state",children:"FlowState Service"})," - Learn about states"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);