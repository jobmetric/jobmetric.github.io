"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[3158],{28453(e,n,i){i.d(n,{R:()=>r,x:()=>a});var t=i(96540);const l={},s=t.createContext(l);function r(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),t.createElement(s.Provider,{value:n},e.children)}},99475(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"laravel-unit-converter/deep-diving/has-unit","title":"HasUnit Trait","description":"The HasUnit trait adds unit functionality to any Eloquent model, allowing you to store, retrieve, convert, and manage measurement values through a polymorphic relationship.","source":"@site/packages/laravel-unit-converter/deep-diving/has-unit.md","sourceDirName":"laravel-unit-converter/deep-diving","slug":"/laravel-unit-converter/deep-diving/has-unit","permalink":"/packages/laravel-unit-converter/deep-diving/has-unit","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-unit-converter/deep-diving/has-unit.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"sidebar_label":"HasUnit"},"sidebar":"packagesSidebar","previous":{"title":"Showcase","permalink":"/packages/laravel-unit-converter/showcase"},"next":{"title":"Unit Converter Service","permalink":"/packages/laravel-unit-converter/deep-diving/unit-converter-service"}}');var l=i(74848),s=i(28453);i(28774);const r={sidebar_position:1,sidebar_label:"HasUnit"},a="HasUnit Trait",d={},c=[{value:"Namespace",id:"namespace",level:2},{value:"Overview",id:"overview",level:2},{value:"Basic Usage",id:"basic-usage",level:2},{value:"Attach Trait to Model",id:"attach-trait-to-model",level:3},{value:"Define Allowed Unit Keys",id:"define-allowed-unit-keys",level:3},{value:"Configuration Formats",id:"configuration-formats",level:3},{value:"Available Methods",id:"available-methods",level:2},{value:"Store Unit",id:"store-unit",level:3},{value:"Store Multiple Units",id:"store-multiple-units",level:3},{value:"Get Unit Value",id:"get-unit-value",level:3},{value:"Get All Units",id:"get-all-units",level:3},{value:"Get Unit Values Only",id:"get-unit-values-only",level:3},{value:"Check Unit Exists",id:"check-unit-exists",level:3},{value:"Forget Unit",id:"forget-unit",level:3},{value:"Forget All Units",id:"forget-all-units",level:3},{value:"Mass Assignment",id:"mass-assignment",level:2},{value:"Relationships",id:"relationships",level:2},{value:"Units Relationship",id:"units-relationship",level:3},{value:"Unit Relations Relationship",id:"unit-relations-relationship",level:3},{value:"Query Scopes",id:"query-scopes",level:2},{value:"Has Unit Key",id:"has-unit-key",level:3},{value:"Where Unit Equals",id:"where-unit-equals",level:3},{value:"Configuration Methods",id:"configuration-methods",level:2},{value:"Get Unitables",id:"get-unitables",level:3},{value:"Allow All Keys",id:"allow-all-keys",level:3},{value:"Merge Unitables",id:"merge-unitables",level:3},{value:"Remove Unitable",id:"remove-unitable",level:3},{value:"Events",id:"events",level:2},{value:"Complete Examples",id:"complete-examples",level:2},{value:"E-Commerce Product",id:"e-commerce-product",level:3},{value:"Scientific Sample",id:"scientific-sample",level:3},{value:"Recipe Ingredient",id:"recipe-ingredient",level:3},{value:"Tips and Best Practices",id:"tips-and-best-practices",level:2},{value:"1. Define Unitables Explicitly",id:"1-define-unitables-explicitly",level:3},{value:"2. Use Constants for Unit IDs",id:"2-use-constants-for-unit-ids",level:3},{value:"3. Handle Missing Values",id:"3-handle-missing-values",level:3},{value:"4. Use Batch Operations",id:"4-use-batch-operations",level:3},{value:"5. Leverage Query Scopes",id:"5-leverage-query-scopes",level:3}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"hasunit-trait",children:"HasUnit Trait"})}),"\n",(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(n.code,{children:"HasUnit"})," trait adds unit functionality to any Eloquent model, allowing you to store, retrieve, convert, and manage measurement values through a polymorphic relationship."]}),"\n",(0,l.jsx)(n.h2,{id:"namespace",children:"Namespace"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"JobMetric\\UnitConverter\\HasUnit\n"})}),"\n",(0,l.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(n.code,{children:"HasUnit"})," trait provides:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Unit Storage"}),": Store unit values for any model"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Key Configuration"}),": Control which unit keys are allowed and their expected types"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Automatic Conversion"}),": Convert values between units of the same type"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Query Scopes"}),": Filter models by unit attributes"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Batch Operations"}),": Store multiple unit values in a single operation"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Mass Assignment"}),": Support for storing units via model attributes"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,l.jsx)(n.h3,{id:"attach-trait-to-model",children:"Attach Trait to Model"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"use JobMetric\\UnitConverter\\HasUnit;\n\nclass Product extends Model\n{\n    use HasUnit;\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"define-allowed-unit-keys",children:"Define Allowed Unit Keys"}),"\n",(0,l.jsx)(n.p,{children:"Define which unit keys are allowed and their expected unit types:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"class Product extends Model\n{\n    use HasUnit;\n\n    protected array $unitables = [\n        'weight' => 'weight',    // key => expected unit type\n        'length' => 'length',\n        'width' => 'length',\n        'height' => 'length',\n        'volume' => 'volume',\n    ];\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:["If omitted or set to ",(0,l.jsx)(n.code,{children:"['*']"}),", all keys are allowed without type enforcement."]}),"\n",(0,l.jsx)(n.h3,{id:"configuration-formats",children:"Configuration Formats"}),"\n",(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(n.code,{children:"$unitables"})," property supports multiple formats:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"// Allow all keys (no type enforcement)\nprotected array $unitables = ['*'];\n\n// List format (key and type are the same)\nprotected array $unitables = ['weight', 'length', 'volume'];\n\n// Map format (key => expected type)\nprotected array $unitables = [\n    'weight' => 'weight',\n    'width' => 'length',\n    'height' => 'length',\n];\n\n// Using enum values\nuse JobMetric\\UnitConverter\\Enums\\UnitTypeEnum;\n\nprotected array $unitables = [\n    'weight' => UnitTypeEnum::WEIGHT,\n    'length' => UnitTypeEnum::LENGTH,\n];\n"})}),"\n",(0,l.jsx)(n.h2,{id:"available-methods",children:"Available Methods"}),"\n",(0,l.jsx)(n.h3,{id:"store-unit",children:"Store Unit"}),"\n",(0,l.jsx)(n.p,{children:"Store or update a single unit value:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"$product->storeUnit('weight', $kilogramId, 2.5);\n$product->storeUnit('length', $centimeterId, 100);\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"string $key"})," - Unit key (e.g., weight, length)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"int $unitId"})," - ID of the unit"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"float $value"})," - Value in the specified unit"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Returns:"})," ",(0,l.jsx)(n.code,{children:"static"})," - Fluent interface"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Throws:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"UnitNotFoundException"})," - If unit ID doesn't exist"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"TypeNotFoundInAllowTypesException"})," - If key is not allowed"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"store-multiple-units",children:"Store Multiple Units"}),"\n",(0,l.jsx)(n.p,{children:"Store multiple unit values in a batch:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"$product->storeUnitBatch([\n    'weight' => ['unit_id' => $kilogramId, 'value' => 2.5],\n    'length' => ['unit_id' => $centimeterId, 'value' => 100],\n    'width' => ['unit_id' => $centimeterId, 'value' => 50],\n]);\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"array $units"})," - Array of ",(0,l.jsx)(n.code,{children:"[key => ['unit_id' => int, 'value' => float]]"})]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Returns:"})," ",(0,l.jsx)(n.code,{children:"static"})," - Fluent interface"]}),"\n",(0,l.jsx)(n.h3,{id:"get-unit-value",children:"Get Unit Value"}),"\n",(0,l.jsx)(n.p,{children:"Retrieve a unit value, optionally converted to another unit:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"// Get original value\n$weight = $product->getUnit('weight');\n// => ['unit' => Unit, 'value' => 2.5, 'translation' => ['name' => 'Kilogram', ...]]\n\n// Get converted value\n$weightGrams = $product->getUnit('weight', $gramId);\n// => ['unit' => Unit, 'value' => 2500, 'translation' => ['name' => 'Gram', ...]]\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"string $key"})," - Unit key"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"int|null $convertUnitId"})," - Optional unit ID to convert to"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Returns:"})," ",(0,l.jsx)(n.code,{children:"array"})," with keys:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"unit"})," - Unit model (or null if not set)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"value"})," - Float value (or null if not set)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"translation"})," - Translation data array (or null)"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Throws:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"TypeNotFoundInAllowTypesException"})," - If key is not allowed"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"UnitNotFoundException"})," - If unit or convert unit doesn't exist"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"get-all-units",children:"Get All Units"}),"\n",(0,l.jsx)(n.p,{children:"Retrieve all unit values for the model:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"$units = $product->getUnits();\n// => Collection<string, ['unit' => Unit, 'value' => float, 'translation' => array]>\n\nforeach ($units as $key => $data) {\n    echo \"{$key}: {$data['value']} {$data['translation']['code']}\";\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Returns:"})," ",(0,l.jsx)(n.code,{children:"Collection"})," keyed by unit key"]}),"\n",(0,l.jsx)(n.h3,{id:"get-unit-values-only",children:"Get Unit Values Only"}),"\n",(0,l.jsx)(n.p,{children:"Get all unit values as key-value pairs:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"$values = $product->getUnitValues();\n// => Collection ['weight' => 2.5, 'length' => 100, 'width' => 50]\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Returns:"})," ",(0,l.jsx)(n.code,{children:"Collection<string, float>"})]}),"\n",(0,l.jsx)(n.h3,{id:"check-unit-exists",children:"Check Unit Exists"}),"\n",(0,l.jsx)(n.p,{children:"Check if a unit key has a value:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if ($product->hasUnit('weight')) {\n    // Unit value exists\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"string $key"})," - Unit key to check"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Returns:"})," ",(0,l.jsx)(n.code,{children:"bool"})]}),"\n",(0,l.jsx)(n.h3,{id:"forget-unit",children:"Forget Unit"}),"\n",(0,l.jsx)(n.p,{children:"Delete a unit value by key:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"$product->forgetUnit('weight');\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"string $key"})," - Unit key to delete"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Returns:"})," ",(0,l.jsx)(n.code,{children:"static"})," - Fluent interface"]}),"\n",(0,l.jsx)(n.h3,{id:"forget-all-units",children:"Forget All Units"}),"\n",(0,l.jsx)(n.p,{children:"Delete all unit values or for a specific key:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"// Delete specific key\n$product->forgetUnits('weight');\n\n// Delete all\n$product->forgetUnits();\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"string|null $key"})," - Unit key to delete (null for all)"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Returns:"})," ",(0,l.jsx)(n.code,{children:"static"})," - Fluent interface"]}),"\n",(0,l.jsx)(n.h2,{id:"mass-assignment",children:"Mass Assignment"}),"\n",(0,l.jsx)(n.p,{children:"You can store units through model attributes during create or update:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"$product = Product::create([\n    'name' => 'Laptop',\n    'price' => 999.99,\n    'unit' => [\n        'weight' => ['unit_id' => $kilogramId, 'value' => 2.1],\n        'length' => ['unit_id' => $centimeterId, 'value' => 35],\n        'width' => ['unit_id' => $centimeterId, 'value' => 25],\n        'height' => ['unit_id' => $centimeterId, 'value' => 2],\n    ],\n]);\n"})}),"\n",(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(n.code,{children:"unit"})," attribute is automatically handled by the trait:"]}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Values are validated against allowed keys"}),"\n",(0,l.jsx)(n.li,{children:"Unit types are verified"}),"\n",(0,l.jsx)(n.li,{children:"Values are stored after the model is saved"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"relationships",children:"Relationships"}),"\n",(0,l.jsx)(n.h3,{id:"units-relationship",children:"Units Relationship"}),"\n",(0,l.jsx)(n.p,{children:"Access the polymorphic relationship directly:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"$units = $product->units;\n// => Collection of Unit models with pivot data\n\n// Query relationship\n$weightUnit = $product->units()->wherePivot('type', 'weight')->first();\n"})}),"\n",(0,l.jsx)(n.h3,{id:"unit-relations-relationship",children:"Unit Relations Relationship"}),"\n",(0,l.jsx)(n.p,{children:"Access the pivot records directly:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"$relations = $product->unitRelations;\n// => Collection of UnitRelation models\n\n// Filter by key\n$weightRelation = $product->unitRelation('weight')->first();\n"})}),"\n",(0,l.jsx)(n.h2,{id:"query-scopes",children:"Query Scopes"}),"\n",(0,l.jsx)(n.h3,{id:"has-unit-key",children:"Has Unit Key"}),"\n",(0,l.jsx)(n.p,{children:"Filter models that have a specific unit key:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"$productsWithWeight = Product::hasUnitKey('weight')->get();\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"string $key"})," - Unit key to filter by"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Returns:"})," ",(0,l.jsx)(n.code,{children:"Builder"})]}),"\n",(0,l.jsx)(n.h3,{id:"where-unit-equals",children:"Where Unit Equals"}),"\n",(0,l.jsx)(n.p,{children:"Filter models by unit key and unit ID (optionally value):"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"// Products with a specific unit\n$products = Product::whereUnitEquals('weight', $kilogramId)->get();\n\n// Products with specific unit and value\n$products = Product::whereUnitEquals('weight', $kilogramId, 2.5)->get();\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"string $key"})," - Unit key"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"int $unitId"})," - Unit ID"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"float|null $value"})," - Optional exact value"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Returns:"})," ",(0,l.jsx)(n.code,{children:"Builder"})]}),"\n",(0,l.jsx)(n.h2,{id:"configuration-methods",children:"Configuration Methods"}),"\n",(0,l.jsx)(n.h3,{id:"get-unitables",children:"Get Unitables"}),"\n",(0,l.jsx)(n.p,{children:"Get the configured unitables mapping:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"$unitables = $product->getUnitables();\n// => ['weight' => 'weight', 'length' => 'length', ...]\n"})}),"\n",(0,l.jsx)(n.h3,{id:"allow-all-keys",children:"Allow All Keys"}),"\n",(0,l.jsx)(n.p,{children:"Check if all keys are allowed:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if ($product->unitablesAllowAll()) {\n    // Any key is allowed\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"merge-unitables",children:"Merge Unitables"}),"\n",(0,l.jsx)(n.p,{children:"Add additional allowed keys at runtime:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"$product->mergeUnitables([\n    'depth' => 'length',\n    'capacity' => 'volume',\n]);\n"})}),"\n",(0,l.jsx)(n.h3,{id:"remove-unitable",children:"Remove Unitable"}),"\n",(0,l.jsx)(n.p,{children:"Remove a key from the allowed list:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"$product->removeUnitable('volume');\n"})}),"\n",(0,l.jsx)(n.h2,{id:"events",children:"Events"}),"\n",(0,l.jsx)(n.p,{children:"The trait integrates with model events:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"saving"}),": Validates and buffers unit data from ",(0,l.jsx)(n.code,{children:"unit"})," attribute"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"saved"}),": Persists buffered unit data"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"deleted"}),": Cleans up unit relations (respects SoftDeletes)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"forceDeleted"}),": Cleans up unit relations for soft-deleted models"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"complete-examples",children:"Complete Examples"}),"\n",(0,l.jsx)(n.h3,{id:"e-commerce-product",children:"E-Commerce Product"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"namespace App\\Models;\n\nuse Illuminate\\Database\\Eloquent\\Model;\nuse JobMetric\\UnitConverter\\HasUnit;\n\nclass Product extends Model\n{\n    use HasUnit;\n\n    protected $fillable = ['name', 'sku', 'price'];\n\n    protected array $unitables = [\n        'weight' => 'weight',\n        'length' => 'length',\n        'width' => 'length',\n        'height' => 'length',\n    ];\n\n    /**\n     * Get shipping weight in grams.\n     */\n    public function getShippingWeightInGrams(): float\n    {\n        $weight = $this->getUnit('weight', $this->gramUnitId());\n        return $weight['value'] ?? 0;\n    }\n\n    /**\n     * Get volumetric weight for shipping.\n     */\n    public function getVolumetricWeight(): float\n    {\n        $cmUnit = $this->centimeterUnitId();\n        \n        $length = $this->getUnit('length', $cmUnit)['value'] ?? 0;\n        $width = $this->getUnit('width', $cmUnit)['value'] ?? 0;\n        $height = $this->getUnit('height', $cmUnit)['value'] ?? 0;\n        \n        // Volumetric weight formula: L \xd7 W \xd7 H / 5000\n        return ($length * $width * $height) / 5000;\n    }\n}\n\n// Usage\n$product = Product::create([\n    'name' => 'Wireless Mouse',\n    'sku' => 'WM-001',\n    'price' => 29.99,\n    'unit' => [\n        'weight' => ['unit_id' => 2, 'value' => 100], // 100 grams\n        'length' => ['unit_id' => 4, 'value' => 12], // 12 cm\n        'width' => ['unit_id' => 4, 'value' => 6], // 6 cm\n        'height' => ['unit_id' => 4, 'value' => 4], // 4 cm\n    ],\n]);\n\n$shippingWeight = $product->getShippingWeightInGrams();\n$volumetricWeight = $product->getVolumetricWeight();\n"})}),"\n",(0,l.jsx)(n.h3,{id:"scientific-sample",children:"Scientific Sample"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"namespace App\\Models;\n\nuse Illuminate\\Database\\Eloquent\\Model;\nuse JobMetric\\UnitConverter\\HasUnit;\n\nclass LabSample extends Model\n{\n    use HasUnit;\n\n    protected $fillable = ['name', 'collected_at'];\n\n    protected array $unitables = [\n        'temperature' => 'temperature',\n        'pressure' => 'pressure',\n        'volume' => 'volume',\n        'concentration' => 'concentration',\n    ];\n\n    /**\n     * Get temperature in Kelvin for calculations.\n     */\n    public function getTemperatureKelvin(): float\n    {\n        $temp = $this->getUnit('temperature', $this->kelvinUnitId());\n        return $temp['value'] ?? 273.15; // Default to 0\xb0C\n    }\n\n    /**\n     * Check if sample is at standard conditions.\n     */\n    public function isAtStandardConditions(): bool\n    {\n        $temp = $this->getTemperatureKelvin();\n        $pressure = $this->getUnit('pressure', $this->pascalUnitId())['value'] ?? 0;\n        \n        // STP: 273.15 K and 101325 Pa\n        return abs($temp - 273.15) < 0.5 && abs($pressure - 101325) < 100;\n    }\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"recipe-ingredient",children:"Recipe Ingredient"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"namespace App\\Models;\n\nuse Illuminate\\Database\\Eloquent\\Model;\nuse JobMetric\\UnitConverter\\HasUnit;\n\nclass RecipeIngredient extends Model\n{\n    use HasUnit;\n\n    protected $fillable = ['recipe_id', 'ingredient_id', 'notes'];\n\n    protected array $unitables = [\n        'amount' => 'cooking',\n    ];\n\n    /**\n     * Scale the ingredient amount.\n     */\n    public function scale(float $factor): array\n    {\n        $current = $this->getUnit('amount');\n        \n        return [\n            'unit' => $current['unit'],\n            'value' => $current['value'] * $factor,\n            'translation' => $current['translation'],\n        ];\n    }\n\n    /**\n     * Get amount in metric units.\n     */\n    public function getMetricAmount(): array\n    {\n        return $this->getUnit('amount', $this->gramUnitId());\n    }\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"tips-and-best-practices",children:"Tips and Best Practices"}),"\n",(0,l.jsx)(n.h3,{id:"1-define-unitables-explicitly",children:"1. Define Unitables Explicitly"}),"\n",(0,l.jsxs)(n.p,{children:["Always define the ",(0,l.jsx)(n.code,{children:"$unitables"})," property to prevent invalid keys:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"// Good: Explicit configuration\nprotected array $unitables = [\n    'weight' => 'weight',\n    'length' => 'length',\n];\n\n// Avoid: Allow all (less type safety)\nprotected array $unitables = ['*'];\n"})}),"\n",(0,l.jsx)(n.h3,{id:"2-use-constants-for-unit-ids",children:"2. Use Constants for Unit IDs"}),"\n",(0,l.jsx)(n.p,{children:"Store unit IDs in config or constants:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"class Product extends Model\n{\n    protected function kilogramUnitId(): int\n    {\n        return config('units.weight.kilogram');\n    }\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"3-handle-missing-values",children:"3. Handle Missing Values"}),"\n",(0,l.jsx)(n.p,{children:"Always handle cases where unit values might not be set:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"$weight = $product->getUnit('weight');\n\nif ($weight['value'] === null) {\n    // Handle missing value\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"4-use-batch-operations",children:"4. Use Batch Operations"}),"\n",(0,l.jsxs)(n.p,{children:["For multiple units, use ",(0,l.jsx)(n.code,{children:"storeUnitBatch()"})," for better performance:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"// Good: Single batch operation\n$product->storeUnitBatch([\n    'weight' => ['unit_id' => 1, 'value' => 2.5],\n    'length' => ['unit_id' => 2, 'value' => 100],\n]);\n\n// Avoid: Multiple individual operations\n$product->storeUnit('weight', 1, 2.5);\n$product->storeUnit('length', 2, 100);\n"})}),"\n",(0,l.jsx)(n.h3,{id:"5-leverage-query-scopes",children:"5. Leverage Query Scopes"}),"\n",(0,l.jsx)(n.p,{children:"Use query scopes for filtering:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"// Find all products with weight defined\n$productsWithWeight = Product::hasUnitKey('weight')->get();\n\n// Find products with specific unit\n$productsInKg = Product::whereUnitEquals('weight', $kilogramId)->get();\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}}}]);