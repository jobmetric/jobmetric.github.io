"use strict";(globalThis.webpackChunkjobmetric_document=globalThis.webpackChunkjobmetric_document||[]).push([[8202],{15249(e,n,l){l.r(n),l.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"laravel-url/deep-diving/url-contract","title":"UrlContract Interface","description":"The UrlContract interface defines the contract that models must implement to use the HasUrl trait. It requires a single method that returns the canonical full URL for the model.","source":"@site/packages/laravel-url/deep-diving/url-contract.md","sourceDirName":"laravel-url/deep-diving","slug":"/laravel-url/deep-diving/url-contract","permalink":"/packages/laravel-url/deep-diving/url-contract","draft":false,"unlisted":false,"editUrl":"https://github.com/jobmetric/document/blob/master/packages/laravel-url/deep-diving/url-contract.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"sidebar_label":"UrlContract"},"sidebar":"packagesSidebar","previous":{"title":"HasUrl","permalink":"/packages/laravel-url/deep-diving/has-url"},"next":{"title":"Slug","permalink":"/packages/laravel-url/deep-diving/models/slug"}}');var s=l(74848),t=l(28453),r=l(28774);const a={sidebar_position:2,sidebar_label:"UrlContract"},c="UrlContract Interface",o={},d=[{value:"Namespace",id:"namespace",level:2},{value:"Overview",id:"overview",level:2},{value:"Interface Definition",id:"interface-definition",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Deterministic",id:"deterministic",level:3},{value:"Length Limit",id:"length-limit",level:3},{value:"Format Consistency",id:"format-consistency",level:3},{value:"Normalization",id:"normalization",level:3},{value:"Implementation Examples",id:"implementation-examples",level:2},{value:"Example 1: Simple Product",id:"example-1-simple-product",level:3},{value:"Example 2: Product with Category",id:"example-2-product-with-category",level:3},{value:"Example 3: Hierarchical Pages",id:"example-3-hierarchical-pages",level:3},{value:"Example 4: Blog Post with Category",id:"example-4-blog-post-with-category",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Handle Missing Slugs",id:"1-handle-missing-slugs",level:3},{value:"2. Use Optional Relationships",id:"2-use-optional-relationships",level:3},{value:"3. Keep It Simple",id:"3-keep-it-simple",level:3},{value:"Common Mistakes",id:"common-mistakes",level:2},{value:"Mistake 1: Non-Deterministic URLs",id:"mistake-1-non-deterministic-urls",level:3},{value:"Mistake 2: Missing Fallbacks",id:"mistake-2-missing-fallbacks",level:3},{value:"Mistake 3: Including Query Strings",id:"mistake-3-including-query-strings",level:3},{value:"Related Documentation",id:"related-documentation",level:2}];function u(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"urlcontract-interface",children:"UrlContract Interface"})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"UrlContract"})," interface defines the contract that models must implement to use the ",(0,s.jsx)(n.code,{children:"HasUrl"})," trait. It requires a single method that returns the canonical full URL for the model."]}),"\n",(0,s.jsx)(n.h2,{id:"namespace",children:"Namespace"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"JobMetric\\Url\\Contracts\\UrlContract\n"})}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"UrlContract"})," ensures that models using ",(0,s.jsx)(n.code,{children:"HasUrl"})," can compute their full URLs. The returned URL is used for:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Persistence"}),": Stored in the ",(0,s.jsx)(n.code,{children:"urls"})," table"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Uniqueness checks"}),": Global uniqueness enforcement"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Redirects"}),": Legacy URL redirects to canonical URLs"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Routing resolution"}),": Fallback route matching"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"interface-definition",children:"Interface Definition"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"interface UrlContract\n{\n    public function getFullUrl(): string;\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,s.jsx)(n.h3,{id:"deterministic",children:"Deterministic"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"getFullUrl()"})," method ",(0,s.jsx)(n.strong,{children:"must"})," be deterministic and side-effect free. It should return the same value for the same model state."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// Good: Deterministic\npublic function getFullUrl(): string\n{\n    return '/shop/' . ($this->category->slug ?? 'uncategorized') . '/' . ($this->slug ?? 'product-' . $this->id);\n}\n\n// Bad: Non-deterministic\npublic function getFullUrl(): string\n{\n    return '/shop/' . $this->slug . '?t=' . time();  // Changes every call\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"length-limit",children:"Length Limit"}),"\n",(0,s.jsxs)(n.p,{children:["The returned URL ",(0,s.jsx)(n.strong,{children:"must"})," be \u2264 2000 characters (database constraint)."]}),"\n",(0,s.jsx)(n.h3,{id:"format-consistency",children:"Format Consistency"}),"\n",(0,s.jsx)(n.p,{children:"Choose ONE consistent format across your application:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Path-only"})," (recommended): ",(0,s.jsx)(n.code,{children:'"category/product"'})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Absolute"}),": ",(0,s.jsx)(n.code,{children:'"https://example.com/category/product"'})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Recommended:"})," Use path-only without leading slash for consistency."]}),"\n",(0,s.jsx)(n.h3,{id:"normalization",children:"Normalization"}),"\n",(0,s.jsx)(n.p,{children:"URLs should be normalized according to your URL policy:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"No trailing slashes (or consistent trailing slashes)"}),"\n",(0,s.jsx)(n.li,{children:"Stable casing"}),"\n",(0,s.jsx)(n.li,{children:"No query strings or fragments (canonical path only)"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"implementation-examples",children:"Implementation Examples"}),"\n",(0,s.jsx)(n.h3,{id:"example-1-simple-product",children:"Example 1: Simple Product"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"class Product extends Model implements UrlContract\n{\n    use HasUrl;\n\n    public function getFullUrl(): string\n    {\n        return '/shop/' . ($this->slug ?? 'product-' . $this->id);\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-2-product-with-category",children:"Example 2: Product with Category"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"class Product extends Model implements UrlContract\n{\n    use HasUrl;\n\n    public function category()\n    {\n        return $this->belongsTo(Category::class);\n    }\n\n    public function getFullUrl(): string\n    {\n        $categorySlug = optional($this->category)->slug ?? 'uncategorized';\n        $productSlug = $this->slug ?? 'product-' . $this->id;\n        return \"/shop/{$categorySlug}/{$productSlug}\";\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-3-hierarchical-pages",children:"Example 3: Hierarchical Pages"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"class Page extends Model implements UrlContract\n{\n    use HasUrl;\n\n    public function parent()\n    {\n        return $this->belongsTo(Page::class, 'parent_id');\n    }\n\n    public function getFullUrl(): string\n    {\n        $segments = [];\n        $page = $this;\n\n        while ($page) {\n            array_unshift($segments, $page->slug ?? 'page-' . $page->id);\n            $page = $page->parent;\n        }\n\n        return '/' . implode('/', $segments);\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-4-blog-post-with-category",children:"Example 4: Blog Post with Category"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"class Post extends Model implements UrlContract\n{\n    use HasUrl;\n\n    public function category()\n    {\n        return $this->belongsTo(Category::class);\n    }\n\n    public function getFullUrl(): string\n    {\n        $categorySlug = $this->category->slug ?? 'uncategorized';\n        $postSlug = $this->slug ?? 'post-' . $this->id;\n        return \"/blog/{$categorySlug}/{$postSlug}\";\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsx)(n.h3,{id:"1-handle-missing-slugs",children:"1. Handle Missing Slugs"}),"\n",(0,s.jsx)(n.p,{children:"Always provide a fallback when slug might be null:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// Good: Fallback provided\nreturn '/shop/' . ($this->slug ?? 'product-' . $this->id);\n\n// Bad: May return null\nreturn '/shop/' . $this->slug;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"2-use-optional-relationships",children:"2. Use Optional Relationships"}),"\n",(0,s.jsxs)(n.p,{children:["Use ",(0,s.jsx)(n.code,{children:"optional()"})," or null coalescing for relationships:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// Good: Safe relationship access\n$categorySlug = optional($this->category)->slug ?? 'uncategorized';\n\n// Bad: May throw exception\n$categorySlug = $this->category->slug;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"3-keep-it-simple",children:"3. Keep It Simple"}),"\n",(0,s.jsxs)(n.p,{children:["Avoid complex logic in ",(0,s.jsx)(n.code,{children:"getFullUrl()"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// Good: Simple and clear\npublic function getFullUrl(): string\n{\n    return '/shop/' . ($this->slug ?? 'product-' . $this->id);\n}\n\n// Bad: Too complex\npublic function getFullUrl(): string\n{\n    $base = config('app.url');\n    $locale = app()->getLocale();\n    $category = $this->category ? $this->category->slug : 'uncategorized';\n    $product = $this->slug ?? 'product-' . $this->id;\n    return \"{$base}/{$locale}/shop/{$category}/{$product}\";\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"common-mistakes",children:"Common Mistakes"}),"\n",(0,s.jsx)(n.h3,{id:"mistake-1-non-deterministic-urls",children:"Mistake 1: Non-Deterministic URLs"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// Bad: Changes every call\npublic function getFullUrl(): string\n{\n    return '/shop/' . $this->slug . '?ref=' . time();\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"mistake-2-missing-fallbacks",children:"Mistake 2: Missing Fallbacks"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// Bad: May return null\npublic function getFullUrl(): string\n{\n    return '/shop/' . $this->slug;\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"mistake-3-including-query-strings",children:"Mistake 3: Including Query Strings"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"// Bad: Query strings should not be in canonical URL\npublic function getFullUrl(): string\n{\n    return '/shop/' . $this->slug . '?utm_source=email';\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(r.A,{to:"/packages/laravel-url/deep-diving/has-url",children:"HasUrl Trait"})," - Core trait that uses this interface"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(r.A,{to:"/packages/laravel-url/deep-diving/models/url",children:"Url Model"})," - Model that stores full URLs"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},28453(e,n,l){l.d(n,{R:()=>r,x:()=>a});var i=l(96540);const s={},t=i.createContext(s);function r(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);